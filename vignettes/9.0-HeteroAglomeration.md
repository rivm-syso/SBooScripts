9 Heteroagglomeration
================
Jaap Slootweg, Joris Quik, Anne Hids
2024-07-18

``` r
substance <- "nAg_10nm"
source("baseScripts/initWorld_onlyParticulate.R")
```

## Heteroagglomeration

This is a particulate process which only applies to Solid species and
the transformation to the Aggregated or Attached Particulate Species.

There are three different approaches applied here depending on the
matrix where this process takes place and the species affected.

The three approaches are based on: - Smoluchowski’s colloid theory
(water, soil/sediment pore water) - Filtration theory for porous
matrices (soil and sediment) - Aerosol agglomeration approaches (air)

### Heteroagglomeration in water

This plays are role for the transformation from the primary particulate
species and their agglomeration with natural colloids \< 450 nm in
water, soil and sediment pore water. Also agglomeration with larger SPM
(\>450 nm) in water.

The data required for calculating for instance the collision frequency
is related to the particle number concentration of natural colloids
present in the compartment. For this we use the per subcompartment
defined characteristics of the natural particles: ‘RadCOL’, ‘RadCP’,
‘RhoCOL’ and ‘RhoCP’. For aerosols the Accumulation mode corresponds to
COL and Coarse Mode corresponds to CP characteristics.

The heteroaggregation rate constant is calculated using
(k_HeteroAgglomeration.wsd.R). This depends on the following variables:

1.  rad_species: this calculates the radius of the heteroagglomerate
    consisting of the solid particle and the Small or Large natural
    particle.

2.  rho_species: this calculates the density of the he heteroagglomerate
    consisting of the solid particle and the Small or Large natural
    particle.

Furthermore there are several helper functions used to avoid repeating
code and too complex variables:

- f_Inter (Interception or peri-kinetic collision frequency coefficient)
- f_Brown (Brownian motion or kinetic collision frequency coefficient)
- f_Grav (Gravitational impaction collision frequency coefficient)
- f_NumConc (Calculate number concentration from mass concentration)
- f_SetVelWater (Function for calculating the Settling Velocity of a
  particle through water)

``` r
# Below are all variables used to calculate heteroagglomeration in water
World$fetchData("alpha") # here to.alpha needs to be used
```

    ##            SubCompart Species alpha
    ## 1    agriculturalsoil   Large 0.050
    ## 2    agriculturalsoil   Small 0.050
    ## 12          deepocean   Large 1.000
    ## 13          deepocean   Small 1.000
    ## 16 freshwatersediment   Large 0.900
    ## 17 freshwatersediment   Small 0.380
    ## 20               lake   Large 0.900
    ## 21               lake   Small 0.177
    ## 24       lakesediment   Large 0.900
    ## 25       lakesediment   Small 0.177
    ## 28     marinesediment   Large 1.000
    ## 29     marinesediment   Small 1.000
    ## 32        naturalsoil   Large 0.080
    ## 33        naturalsoil   Small 0.080
    ## 36          othersoil   Large 0.045
    ## 37          othersoil   Small 0.045
    ## 40              river   Large 0.900
    ## 41              river   Small 0.380
    ## 44                sea   Large 1.000
    ## 45                sea   Small 1.000

``` r
World$fetchData("COL")
```

    ##            SubCompart   COL
    ## 1    agriculturalsoil 0.100
    ## 4           deepocean 0.001
    ## 5  freshwatersediment 0.002
    ## 6                lake 0.001
    ## 7        lakesediment 0.002
    ## 8      marinesediment 0.002
    ## 9         naturalsoil 0.100
    ## 10          othersoil 0.100
    ## 11              river 0.001
    ## 12                sea 0.001

``` r
World$fetchData("SUSP")
```

    ##    SubCompart   SUSP
    ## 4   deepocean 0.0050
    ## 6        lake 0.0005
    ## 11      river 0.0150
    ## 12        sea 0.0050

``` r
World$fetchData("Shear")
```

    ##          Scale         SubCompart Shear
    ## 4       Arctic          deepocean    10
    ## 8       Arctic     marinesediment     0
    ## 9       Arctic        naturalsoil     0
    ## 12      Arctic                sea    10
    ## 13 Continental   agriculturalsoil     0
    ## 17 Continental freshwatersediment     0
    ## 18 Continental               lake     1
    ## 19 Continental       lakesediment     0
    ## 20 Continental     marinesediment     0
    ## 21 Continental        naturalsoil     0
    ## 22 Continental          othersoil     0
    ## 23 Continental              river   100
    ## 24 Continental                sea    10
    ## 28    Moderate          deepocean    10
    ## 32    Moderate     marinesediment     0
    ## 33    Moderate        naturalsoil     0
    ## 36    Moderate                sea    10
    ## 37    Regional   agriculturalsoil     0
    ## 41    Regional freshwatersediment     0
    ## 42    Regional               lake     1
    ## 43    Regional       lakesediment     0
    ## 44    Regional     marinesediment     0
    ## 45    Regional        naturalsoil     0
    ## 46    Regional          othersoil     0
    ## 47    Regional              river   100
    ## 48    Regional                sea    10
    ## 52      Tropic          deepocean    10
    ## 56      Tropic     marinesediment     0
    ## 57      Tropic        naturalsoil     0
    ## 60      Tropic                sea    10

``` r
World$fetchData("RadS")
```

    ## [1] 5e-09

``` r
World$fetchData("RhoS")
```

    ## [1] 10500

``` r
World$fetchData("Temp")
```

    ##         Scale Temp
    ## 1      Arctic  263
    ## 2 Continental  285
    ## 3    Moderate  285
    ## 4    Regional  285
    ## 5      Tropic  298

``` r
World$fetchData("RhoCOL")
```

    ##            SubCompart RhoCOL
    ## 1    agriculturalsoil   2000
    ## 2                 air   2000
    ## 4           deepocean   2000
    ## 5  freshwatersediment   2000
    ## 6                lake   2000
    ## 7        lakesediment   2000
    ## 8      marinesediment   2000
    ## 9         naturalsoil   2000
    ## 10          othersoil   2000
    ## 11              river   2000
    ## 12                sea   2000

``` r
World$fetchData("RhoCP")
```

    ##            SubCompart RhoCP
    ## 1    agriculturalsoil  2500
    ## 2                 air  2000
    ## 4           deepocean  2500
    ## 5  freshwatersediment  2500
    ## 6                lake  2500
    ## 7        lakesediment  2500
    ## 8      marinesediment  2500
    ## 9         naturalsoil  2500
    ## 10          othersoil  2500
    ## 11              river  2500
    ## 12                sea  2500

``` r
World$fetchData("RadCOL")
```

    ##            SubCompart  RadCOL
    ## 1    agriculturalsoil 1.5e-07
    ## 2                 air 5.8e-08
    ## 4           deepocean 1.5e-07
    ## 5  freshwatersediment 1.5e-07
    ## 6                lake 1.5e-07
    ## 7        lakesediment 1.5e-07
    ## 8      marinesediment 1.5e-07
    ## 9         naturalsoil 1.5e-07
    ## 10          othersoil 1.5e-07
    ## 11              river 1.5e-07
    ## 12                sea 1.5e-07

``` r
World$fetchData("RadCP")
```

    ##            SubCompart    RadCP
    ## 1    agriculturalsoil 1.28e-04
    ## 2                 air 9.00e-07
    ## 4           deepocean 3.00e-06
    ## 5  freshwatersediment 1.28e-04
    ## 6                lake 3.00e-06
    ## 7        lakesediment 1.28e-04
    ## 8      marinesediment 1.28e-04
    ## 9         naturalsoil 1.28e-04
    ## 10          othersoil 1.28e-04
    ## 11              river 3.00e-06
    ## 12                sea 3.00e-06

``` r
World$fetchData("RadNuc")
```

    ## [1] 1e-08

``` r
World$fetchData("NumConcNuc")
```

    ##         Scale NumConcNuc
    ## 1      Arctic    3.2e+09
    ## 2 Continental    3.2e+09
    ## 3    Moderate    3.2e+09
    ## 4    Regional    3.2e+09
    ## 5      Tropic    3.2e+09

``` r
World$fetchData("NumConcAcc")
```

    ##         Scale NumConcAcc
    ## 1      Arctic    2.9e+09
    ## 2 Continental    2.9e+09
    ## 3    Moderate    2.9e+09
    ## 4    Regional    2.9e+09
    ## 5      Tropic    2.9e+09

``` r
World$fetchData("NumConcCP")
```

    ##         Scale NumConcCP
    ## 1      Arctic     3e+05
    ## 2 Continental     3e+05
    ## 3    Moderate     3e+05
    ## 4    Regional     3e+05
    ## 5      Tropic     3e+05

``` r
World$fetchData("DynViscWaterStandard")
```

    ## [1] 0.001002

``` r
World$fetchData("DynViscAirStandard")
```

    ## [1] 1.81e-05

``` r
World$fetchData("Df")
```

    ## [1] 0.3333333

``` r
World$fetchData("SubCompartName")
```

    ##            SubCompart     SubCompartName
    ## 1    agriculturalsoil   agriculturalsoil
    ## 2                 air                air
    ## 3          cloudwater         cloudwater
    ## 4           deepocean          deepocean
    ## 5  freshwatersediment freshwatersediment
    ## 6                lake               lake
    ## 7        lakesediment       lakesediment
    ## 8      marinesediment     marinesediment
    ## 9         naturalsoil        naturalsoil
    ## 10          othersoil          othersoil
    ## 11              river              river
    ## 12                sea                sea

``` r
World$fetchData("rhoMatrix")
```

    ##            SubCompart rhoMatrix
    ## 1    agriculturalsoil  2500.000
    ## 2                 air     1.225
    ## 3          cloudwater   998.000
    ## 4           deepocean   998.000
    ## 5  freshwatersediment  2500.000
    ## 6                lake   998.000
    ## 7        lakesediment  2500.000
    ## 8      marinesediment  2500.000
    ## 9         naturalsoil  2500.000
    ## 10          othersoil  2500.000
    ## 11              river   998.000
    ## 12                sea   998.000

``` r
World$fetchData("Matrix")
```

    ##            SubCompart   Matrix
    ## 1    agriculturalsoil     soil
    ## 2                 air      air
    ## 3          cloudwater    water
    ## 4           deepocean    water
    ## 5  freshwatersediment sediment
    ## 6                lake    water
    ## 7        lakesediment sediment
    ## 8      marinesediment sediment
    ## 9         naturalsoil     soil
    ## 10          othersoil     soil
    ## 11              river    water
    ## 12                sea    water

``` r
World$fetchData("SpeciesName")
```

    ##   Species  SpeciesName
    ## 3   Large     Attached
    ## 4   Small   Aggregated
    ## 5   Solid Nanoparticle
    ## 6 Unbound    Molecular

``` r
# Calculate the radius of the heteroagglomerate
CalcVariable <- World$NewCalcVariable("rad_species")
World$CalcVar("rad_species")
```

    ##           Scale         SubCompart Species old_rad_species  rad_species
    ## 1        Arctic   agriculturalsoil   Large    1.280000e-04 1.280000e-04
    ## 2        Arctic   agriculturalsoil   Small    1.500019e-07 1.500019e-07
    ## 3        Arctic   agriculturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 4        Arctic                air   Large    9.000001e-07 9.000001e-07
    ## 5        Arctic                air   Small    4.537267e-08 4.537267e-08
    ## 6        Arctic                air   Solid    5.000000e-09 5.000000e-09
    ## 7        Arctic         cloudwater   Solid    5.000000e-09 5.000000e-09
    ## 8        Arctic          deepocean   Large    3.000000e-06 3.000000e-06
    ## 9        Arctic          deepocean   Small    1.500019e-07 1.500019e-07
    ## 10       Arctic          deepocean   Solid    5.000000e-09 5.000000e-09
    ## 11       Arctic freshwatersediment   Large    1.280000e-04 1.280000e-04
    ## 12       Arctic freshwatersediment   Small    1.500019e-07 1.500019e-07
    ## 13       Arctic freshwatersediment   Solid    5.000000e-09 5.000000e-09
    ## 14       Arctic               lake   Large    3.000000e-06 3.000000e-06
    ## 15       Arctic               lake   Small    1.500019e-07 1.500019e-07
    ## 16       Arctic               lake   Solid    5.000000e-09 5.000000e-09
    ## 17       Arctic       lakesediment   Large    1.280000e-04 1.280000e-04
    ## 18       Arctic       lakesediment   Small    1.500019e-07 1.500019e-07
    ## 19       Arctic       lakesediment   Solid    5.000000e-09 5.000000e-09
    ## 20       Arctic     marinesediment   Large    1.280000e-04 1.280000e-04
    ## 21       Arctic     marinesediment   Small    1.500019e-07 1.500019e-07
    ## 22       Arctic     marinesediment   Solid    5.000000e-09 5.000000e-09
    ## 23       Arctic        naturalsoil   Large    1.280000e-04 1.280000e-04
    ## 24       Arctic        naturalsoil   Small    1.500019e-07 1.500019e-07
    ## 25       Arctic        naturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 26       Arctic          othersoil   Large    1.280000e-04 1.280000e-04
    ## 27       Arctic          othersoil   Small    1.500019e-07 1.500019e-07
    ## 28       Arctic          othersoil   Solid    5.000000e-09 5.000000e-09
    ## 29       Arctic              river   Large    3.000000e-06 3.000000e-06
    ## 30       Arctic              river   Small    1.500019e-07 1.500019e-07
    ## 31       Arctic              river   Solid    5.000000e-09 5.000000e-09
    ## 32       Arctic                sea   Large    3.000000e-06 3.000000e-06
    ## 33       Arctic                sea   Small    1.500019e-07 1.500019e-07
    ## 34       Arctic                sea   Solid    5.000000e-09 5.000000e-09
    ## 35  Continental   agriculturalsoil   Large    1.280000e-04 1.280000e-04
    ## 36  Continental   agriculturalsoil   Small    1.500019e-07 1.500019e-07
    ## 37  Continental   agriculturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 38  Continental                air   Large    9.000001e-07 9.000001e-07
    ## 39  Continental                air   Small    4.537267e-08 4.537267e-08
    ## 40  Continental                air   Solid    5.000000e-09 5.000000e-09
    ## 41  Continental         cloudwater   Solid    5.000000e-09 5.000000e-09
    ## 42  Continental          deepocean   Large    3.000000e-06 3.000000e-06
    ## 43  Continental          deepocean   Small    1.500019e-07 1.500019e-07
    ## 44  Continental          deepocean   Solid    5.000000e-09 5.000000e-09
    ## 45  Continental freshwatersediment   Large    1.280000e-04 1.280000e-04
    ## 46  Continental freshwatersediment   Small    1.500019e-07 1.500019e-07
    ## 47  Continental freshwatersediment   Solid    5.000000e-09 5.000000e-09
    ## 48  Continental               lake   Large    3.000000e-06 3.000000e-06
    ## 49  Continental               lake   Small    1.500019e-07 1.500019e-07
    ## 50  Continental               lake   Solid    5.000000e-09 5.000000e-09
    ## 51  Continental       lakesediment   Large    1.280000e-04 1.280000e-04
    ## 52  Continental       lakesediment   Small    1.500019e-07 1.500019e-07
    ## 53  Continental       lakesediment   Solid    5.000000e-09 5.000000e-09
    ## 54  Continental     marinesediment   Large    1.280000e-04 1.280000e-04
    ## 55  Continental     marinesediment   Small    1.500019e-07 1.500019e-07
    ## 56  Continental     marinesediment   Solid    5.000000e-09 5.000000e-09
    ## 57  Continental        naturalsoil   Large    1.280000e-04 1.280000e-04
    ## 58  Continental        naturalsoil   Small    1.500019e-07 1.500019e-07
    ## 59  Continental        naturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 60  Continental          othersoil   Large    1.280000e-04 1.280000e-04
    ## 61  Continental          othersoil   Small    1.500019e-07 1.500019e-07
    ## 62  Continental          othersoil   Solid    5.000000e-09 5.000000e-09
    ## 63  Continental              river   Large    3.000000e-06 3.000000e-06
    ## 64  Continental              river   Small    1.500019e-07 1.500019e-07
    ## 65  Continental              river   Solid    5.000000e-09 5.000000e-09
    ## 66  Continental                sea   Large    3.000000e-06 3.000000e-06
    ## 67  Continental                sea   Small    1.500019e-07 1.500019e-07
    ## 68  Continental                sea   Solid    5.000000e-09 5.000000e-09
    ## 69     Moderate   agriculturalsoil   Large    1.280000e-04 1.280000e-04
    ## 70     Moderate   agriculturalsoil   Small    1.500019e-07 1.500019e-07
    ## 71     Moderate   agriculturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 72     Moderate                air   Large    9.000001e-07 9.000001e-07
    ## 73     Moderate                air   Small    4.537267e-08 4.537267e-08
    ## 74     Moderate                air   Solid    5.000000e-09 5.000000e-09
    ## 75     Moderate         cloudwater   Solid    5.000000e-09 5.000000e-09
    ## 76     Moderate          deepocean   Large    3.000000e-06 3.000000e-06
    ## 77     Moderate          deepocean   Small    1.500019e-07 1.500019e-07
    ## 78     Moderate          deepocean   Solid    5.000000e-09 5.000000e-09
    ## 79     Moderate freshwatersediment   Large    1.280000e-04 1.280000e-04
    ## 80     Moderate freshwatersediment   Small    1.500019e-07 1.500019e-07
    ## 81     Moderate freshwatersediment   Solid    5.000000e-09 5.000000e-09
    ## 82     Moderate               lake   Large    3.000000e-06 3.000000e-06
    ## 83     Moderate               lake   Small    1.500019e-07 1.500019e-07
    ## 84     Moderate               lake   Solid    5.000000e-09 5.000000e-09
    ## 85     Moderate       lakesediment   Large    1.280000e-04 1.280000e-04
    ## 86     Moderate       lakesediment   Small    1.500019e-07 1.500019e-07
    ## 87     Moderate       lakesediment   Solid    5.000000e-09 5.000000e-09
    ## 88     Moderate     marinesediment   Large    1.280000e-04 1.280000e-04
    ## 89     Moderate     marinesediment   Small    1.500019e-07 1.500019e-07
    ## 90     Moderate     marinesediment   Solid    5.000000e-09 5.000000e-09
    ## 91     Moderate        naturalsoil   Large    1.280000e-04 1.280000e-04
    ## 92     Moderate        naturalsoil   Small    1.500019e-07 1.500019e-07
    ## 93     Moderate        naturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 94     Moderate          othersoil   Large    1.280000e-04 1.280000e-04
    ## 95     Moderate          othersoil   Small    1.500019e-07 1.500019e-07
    ## 96     Moderate          othersoil   Solid    5.000000e-09 5.000000e-09
    ## 97     Moderate              river   Large    3.000000e-06 3.000000e-06
    ## 98     Moderate              river   Small    1.500019e-07 1.500019e-07
    ## 99     Moderate              river   Solid    5.000000e-09 5.000000e-09
    ## 100    Moderate                sea   Large    3.000000e-06 3.000000e-06
    ## 101    Moderate                sea   Small    1.500019e-07 1.500019e-07
    ## 102    Moderate                sea   Solid    5.000000e-09 5.000000e-09
    ## 103    Regional   agriculturalsoil   Large    1.280000e-04 1.280000e-04
    ## 104    Regional   agriculturalsoil   Small    1.500019e-07 1.500019e-07
    ## 105    Regional   agriculturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 106    Regional                air   Large    9.000001e-07 9.000001e-07
    ## 107    Regional                air   Small    4.537267e-08 4.537267e-08
    ## 108    Regional                air   Solid    5.000000e-09 5.000000e-09
    ## 109    Regional         cloudwater   Solid    5.000000e-09 5.000000e-09
    ## 110    Regional          deepocean   Large    3.000000e-06 3.000000e-06
    ## 111    Regional          deepocean   Small    1.500019e-07 1.500019e-07
    ## 112    Regional          deepocean   Solid    5.000000e-09 5.000000e-09
    ## 113    Regional freshwatersediment   Large    1.280000e-04 1.280000e-04
    ## 114    Regional freshwatersediment   Small    1.500019e-07 1.500019e-07
    ## 115    Regional freshwatersediment   Solid    5.000000e-09 5.000000e-09
    ## 116    Regional               lake   Large    3.000000e-06 3.000000e-06
    ## 117    Regional               lake   Small    1.500019e-07 1.500019e-07
    ## 118    Regional               lake   Solid    5.000000e-09 5.000000e-09
    ## 119    Regional       lakesediment   Large    1.280000e-04 1.280000e-04
    ## 120    Regional       lakesediment   Small    1.500019e-07 1.500019e-07
    ## 121    Regional       lakesediment   Solid    5.000000e-09 5.000000e-09
    ## 122    Regional     marinesediment   Large    1.280000e-04 1.280000e-04
    ## 123    Regional     marinesediment   Small    1.500019e-07 1.500019e-07
    ## 124    Regional     marinesediment   Solid    5.000000e-09 5.000000e-09
    ## 125    Regional        naturalsoil   Large    1.280000e-04 1.280000e-04
    ## 126    Regional        naturalsoil   Small    1.500019e-07 1.500019e-07
    ## 127    Regional        naturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 128    Regional          othersoil   Large    1.280000e-04 1.280000e-04
    ## 129    Regional          othersoil   Small    1.500019e-07 1.500019e-07
    ## 130    Regional          othersoil   Solid    5.000000e-09 5.000000e-09
    ## 131    Regional              river   Large    3.000000e-06 3.000000e-06
    ## 132    Regional              river   Small    1.500019e-07 1.500019e-07
    ## 133    Regional              river   Solid    5.000000e-09 5.000000e-09
    ## 134    Regional                sea   Large    3.000000e-06 3.000000e-06
    ## 135    Regional                sea   Small    1.500019e-07 1.500019e-07
    ## 136    Regional                sea   Solid    5.000000e-09 5.000000e-09
    ## 137      Tropic   agriculturalsoil   Large    1.280000e-04 1.280000e-04
    ## 138      Tropic   agriculturalsoil   Small    1.500019e-07 1.500019e-07
    ## 139      Tropic   agriculturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 140      Tropic                air   Large    9.000001e-07 9.000001e-07
    ## 141      Tropic                air   Small    4.537267e-08 4.537267e-08
    ## 142      Tropic                air   Solid    5.000000e-09 5.000000e-09
    ## 143      Tropic         cloudwater   Solid    5.000000e-09 5.000000e-09
    ## 144      Tropic          deepocean   Large    3.000000e-06 3.000000e-06
    ## 145      Tropic          deepocean   Small    1.500019e-07 1.500019e-07
    ## 146      Tropic          deepocean   Solid    5.000000e-09 5.000000e-09
    ## 147      Tropic freshwatersediment   Large    1.280000e-04 1.280000e-04
    ## 148      Tropic freshwatersediment   Small    1.500019e-07 1.500019e-07
    ## 149      Tropic freshwatersediment   Solid    5.000000e-09 5.000000e-09
    ## 150      Tropic               lake   Large    3.000000e-06 3.000000e-06
    ## 151      Tropic               lake   Small    1.500019e-07 1.500019e-07
    ## 152      Tropic               lake   Solid    5.000000e-09 5.000000e-09
    ## 153      Tropic       lakesediment   Large    1.280000e-04 1.280000e-04
    ## 154      Tropic       lakesediment   Small    1.500019e-07 1.500019e-07
    ## 155      Tropic       lakesediment   Solid    5.000000e-09 5.000000e-09
    ## 156      Tropic     marinesediment   Large    1.280000e-04 1.280000e-04
    ## 157      Tropic     marinesediment   Small    1.500019e-07 1.500019e-07
    ## 158      Tropic     marinesediment   Solid    5.000000e-09 5.000000e-09
    ## 159      Tropic        naturalsoil   Large    1.280000e-04 1.280000e-04
    ## 160      Tropic        naturalsoil   Small    1.500019e-07 1.500019e-07
    ## 161      Tropic        naturalsoil   Solid    5.000000e-09 5.000000e-09
    ## 162      Tropic          othersoil   Large    1.280000e-04 1.280000e-04
    ## 163      Tropic          othersoil   Small    1.500019e-07 1.500019e-07
    ## 164      Tropic          othersoil   Solid    5.000000e-09 5.000000e-09
    ## 165      Tropic              river   Large    3.000000e-06 3.000000e-06
    ## 166      Tropic              river   Small    1.500019e-07 1.500019e-07
    ## 167      Tropic              river   Solid    5.000000e-09 5.000000e-09
    ## 168      Tropic                sea   Large    3.000000e-06 3.000000e-06
    ## 169      Tropic                sea   Small    1.500019e-07 1.500019e-07
    ## 170      Tropic                sea   Solid    5.000000e-09 5.000000e-09

``` r
# Calculate the density of the heteroagglomerate
World$NewCalcVariable("rho_species")
World$CalcVar("rho_species")
```

    ##           Scale         SubCompart Species old_rho_species rho_species
    ## 1        Arctic   agriculturalsoil   Large        2500.000    2500.000
    ## 2        Arctic   agriculturalsoil   Small        2000.315    2000.315
    ## 3        Arctic   agriculturalsoil   Solid       10500.000   10500.000
    ## 4        Arctic                air   Large        2000.001    2000.001
    ## 5        Arctic                air   Small        2007.444    2007.444
    ## 6        Arctic                air   Solid       10500.000   10500.000
    ## 7        Arctic         cloudwater   Solid       10500.000   10500.000
    ## 8        Arctic          deepocean   Large        2500.000    2500.000
    ## 9        Arctic          deepocean   Small        2000.315    2000.315
    ## 10       Arctic          deepocean   Solid       10500.000   10500.000
    ## 11       Arctic freshwatersediment   Large        2500.000    2500.000
    ## 12       Arctic freshwatersediment   Small        2000.315    2000.315
    ## 13       Arctic freshwatersediment   Solid       10500.000   10500.000
    ## 14       Arctic               lake   Large        2500.000    2500.000
    ## 15       Arctic               lake   Small        2000.315    2000.315
    ## 16       Arctic               lake   Solid       10500.000   10500.000
    ## 17       Arctic       lakesediment   Large        2500.000    2500.000
    ## 18       Arctic       lakesediment   Small        2000.315    2000.315
    ## 19       Arctic       lakesediment   Solid       10500.000   10500.000
    ## 20       Arctic     marinesediment   Large        2500.000    2500.000
    ## 21       Arctic     marinesediment   Small        2000.315    2000.315
    ## 22       Arctic     marinesediment   Solid       10500.000   10500.000
    ## 23       Arctic        naturalsoil   Large        2500.000    2500.000
    ## 24       Arctic        naturalsoil   Small        2000.315    2000.315
    ## 25       Arctic        naturalsoil   Solid       10500.000   10500.000
    ## 26       Arctic          othersoil   Large        2500.000    2500.000
    ## 27       Arctic          othersoil   Small        2000.315    2000.315
    ## 28       Arctic          othersoil   Solid       10500.000   10500.000
    ## 29       Arctic              river   Large        2500.000    2500.000
    ## 30       Arctic              river   Small        2000.315    2000.315
    ## 31       Arctic              river   Solid       10500.000   10500.000
    ## 32       Arctic                sea   Large        2500.000    2500.000
    ## 33       Arctic                sea   Small        2000.315    2000.315
    ## 34       Arctic                sea   Solid       10500.000   10500.000
    ## 35  Continental   agriculturalsoil   Large        2500.000    2500.000
    ## 36  Continental   agriculturalsoil   Small        2000.315    2000.315
    ## 37  Continental   agriculturalsoil   Solid       10500.000   10500.000
    ## 38  Continental                air   Large        2000.001    2000.001
    ## 39  Continental                air   Small        2007.444    2007.444
    ## 40  Continental                air   Solid       10500.000   10500.000
    ## 41  Continental         cloudwater   Solid       10500.000   10500.000
    ## 42  Continental          deepocean   Large        2500.000    2500.000
    ## 43  Continental          deepocean   Small        2000.315    2000.315
    ## 44  Continental          deepocean   Solid       10500.000   10500.000
    ## 45  Continental freshwatersediment   Large        2500.000    2500.000
    ## 46  Continental freshwatersediment   Small        2000.315    2000.315
    ## 47  Continental freshwatersediment   Solid       10500.000   10500.000
    ## 48  Continental               lake   Large        2500.000    2500.000
    ## 49  Continental               lake   Small        2000.315    2000.315
    ## 50  Continental               lake   Solid       10500.000   10500.000
    ## 51  Continental       lakesediment   Large        2500.000    2500.000
    ## 52  Continental       lakesediment   Small        2000.315    2000.315
    ## 53  Continental       lakesediment   Solid       10500.000   10500.000
    ## 54  Continental     marinesediment   Large        2500.000    2500.000
    ## 55  Continental     marinesediment   Small        2000.315    2000.315
    ## 56  Continental     marinesediment   Solid       10500.000   10500.000
    ## 57  Continental        naturalsoil   Large        2500.000    2500.000
    ## 58  Continental        naturalsoil   Small        2000.315    2000.315
    ## 59  Continental        naturalsoil   Solid       10500.000   10500.000
    ## 60  Continental          othersoil   Large        2500.000    2500.000
    ## 61  Continental          othersoil   Small        2000.315    2000.315
    ## 62  Continental          othersoil   Solid       10500.000   10500.000
    ## 63  Continental              river   Large        2500.000    2500.000
    ## 64  Continental              river   Small        2000.315    2000.315
    ## 65  Continental              river   Solid       10500.000   10500.000
    ## 66  Continental                sea   Large        2500.000    2500.000
    ## 67  Continental                sea   Small        2000.315    2000.315
    ## 68  Continental                sea   Solid       10500.000   10500.000
    ## 69     Moderate   agriculturalsoil   Large        2500.000    2500.000
    ## 70     Moderate   agriculturalsoil   Small        2000.315    2000.315
    ## 71     Moderate   agriculturalsoil   Solid       10500.000   10500.000
    ## 72     Moderate                air   Large        2000.001    2000.001
    ## 73     Moderate                air   Small        2007.444    2007.444
    ## 74     Moderate                air   Solid       10500.000   10500.000
    ## 75     Moderate         cloudwater   Solid       10500.000   10500.000
    ## 76     Moderate          deepocean   Large        2500.000    2500.000
    ## 77     Moderate          deepocean   Small        2000.315    2000.315
    ## 78     Moderate          deepocean   Solid       10500.000   10500.000
    ## 79     Moderate freshwatersediment   Large        2500.000    2500.000
    ## 80     Moderate freshwatersediment   Small        2000.315    2000.315
    ## 81     Moderate freshwatersediment   Solid       10500.000   10500.000
    ## 82     Moderate               lake   Large        2500.000    2500.000
    ## 83     Moderate               lake   Small        2000.315    2000.315
    ## 84     Moderate               lake   Solid       10500.000   10500.000
    ## 85     Moderate       lakesediment   Large        2500.000    2500.000
    ## 86     Moderate       lakesediment   Small        2000.315    2000.315
    ## 87     Moderate       lakesediment   Solid       10500.000   10500.000
    ## 88     Moderate     marinesediment   Large        2500.000    2500.000
    ## 89     Moderate     marinesediment   Small        2000.315    2000.315
    ## 90     Moderate     marinesediment   Solid       10500.000   10500.000
    ## 91     Moderate        naturalsoil   Large        2500.000    2500.000
    ## 92     Moderate        naturalsoil   Small        2000.315    2000.315
    ## 93     Moderate        naturalsoil   Solid       10500.000   10500.000
    ## 94     Moderate          othersoil   Large        2500.000    2500.000
    ## 95     Moderate          othersoil   Small        2000.315    2000.315
    ## 96     Moderate          othersoil   Solid       10500.000   10500.000
    ## 97     Moderate              river   Large        2500.000    2500.000
    ## 98     Moderate              river   Small        2000.315    2000.315
    ## 99     Moderate              river   Solid       10500.000   10500.000
    ## 100    Moderate                sea   Large        2500.000    2500.000
    ## 101    Moderate                sea   Small        2000.315    2000.315
    ## 102    Moderate                sea   Solid       10500.000   10500.000
    ## 103    Regional   agriculturalsoil   Large        2500.000    2500.000
    ## 104    Regional   agriculturalsoil   Small        2000.315    2000.315
    ## 105    Regional   agriculturalsoil   Solid       10500.000   10500.000
    ## 106    Regional                air   Large        2000.001    2000.001
    ## 107    Regional                air   Small        2007.444    2007.444
    ## 108    Regional                air   Solid       10500.000   10500.000
    ## 109    Regional         cloudwater   Solid       10500.000   10500.000
    ## 110    Regional          deepocean   Large        2500.000    2500.000
    ## 111    Regional          deepocean   Small        2000.315    2000.315
    ## 112    Regional          deepocean   Solid       10500.000   10500.000
    ## 113    Regional freshwatersediment   Large        2500.000    2500.000
    ## 114    Regional freshwatersediment   Small        2000.315    2000.315
    ## 115    Regional freshwatersediment   Solid       10500.000   10500.000
    ## 116    Regional               lake   Large        2500.000    2500.000
    ## 117    Regional               lake   Small        2000.315    2000.315
    ## 118    Regional               lake   Solid       10500.000   10500.000
    ## 119    Regional       lakesediment   Large        2500.000    2500.000
    ## 120    Regional       lakesediment   Small        2000.315    2000.315
    ## 121    Regional       lakesediment   Solid       10500.000   10500.000
    ## 122    Regional     marinesediment   Large        2500.000    2500.000
    ## 123    Regional     marinesediment   Small        2000.315    2000.315
    ## 124    Regional     marinesediment   Solid       10500.000   10500.000
    ## 125    Regional        naturalsoil   Large        2500.000    2500.000
    ## 126    Regional        naturalsoil   Small        2000.315    2000.315
    ## 127    Regional        naturalsoil   Solid       10500.000   10500.000
    ## 128    Regional          othersoil   Large        2500.000    2500.000
    ## 129    Regional          othersoil   Small        2000.315    2000.315
    ## 130    Regional          othersoil   Solid       10500.000   10500.000
    ## 131    Regional              river   Large        2500.000    2500.000
    ## 132    Regional              river   Small        2000.315    2000.315
    ## 133    Regional              river   Solid       10500.000   10500.000
    ## 134    Regional                sea   Large        2500.000    2500.000
    ## 135    Regional                sea   Small        2000.315    2000.315
    ## 136    Regional                sea   Solid       10500.000   10500.000
    ## 137      Tropic   agriculturalsoil   Large        2500.000    2500.000
    ## 138      Tropic   agriculturalsoil   Small        2000.315    2000.315
    ## 139      Tropic   agriculturalsoil   Solid       10500.000   10500.000
    ## 140      Tropic                air   Large        2000.001    2000.001
    ## 141      Tropic                air   Small        2007.444    2007.444
    ## 142      Tropic                air   Solid       10500.000   10500.000
    ## 143      Tropic         cloudwater   Solid       10500.000   10500.000
    ## 144      Tropic          deepocean   Large        2500.000    2500.000
    ## 145      Tropic          deepocean   Small        2000.315    2000.315
    ## 146      Tropic          deepocean   Solid       10500.000   10500.000
    ## 147      Tropic freshwatersediment   Large        2500.000    2500.000
    ## 148      Tropic freshwatersediment   Small        2000.315    2000.315
    ## 149      Tropic freshwatersediment   Solid       10500.000   10500.000
    ## 150      Tropic               lake   Large        2500.000    2500.000
    ## 151      Tropic               lake   Small        2000.315    2000.315
    ## 152      Tropic               lake   Solid       10500.000   10500.000
    ## 153      Tropic       lakesediment   Large        2500.000    2500.000
    ## 154      Tropic       lakesediment   Small        2000.315    2000.315
    ## 155      Tropic       lakesediment   Solid       10500.000   10500.000
    ## 156      Tropic     marinesediment   Large        2500.000    2500.000
    ## 157      Tropic     marinesediment   Small        2000.315    2000.315
    ## 158      Tropic     marinesediment   Solid       10500.000   10500.000
    ## 159      Tropic        naturalsoil   Large        2500.000    2500.000
    ## 160      Tropic        naturalsoil   Small        2000.315    2000.315
    ## 161      Tropic        naturalsoil   Solid       10500.000   10500.000
    ## 162      Tropic          othersoil   Large        2500.000    2500.000
    ## 163      Tropic          othersoil   Small        2000.315    2000.315
    ## 164      Tropic          othersoil   Solid       10500.000   10500.000
    ## 165      Tropic              river   Large        2500.000    2500.000
    ## 166      Tropic              river   Small        2000.315    2000.315
    ## 167      Tropic              river   Solid       10500.000   10500.000
    ## 168      Tropic                sea   Large        2500.000    2500.000
    ## 169      Tropic                sea   Small        2000.315    2000.315
    ## 170      Tropic                sea   Solid       10500.000   10500.000

``` r
# for sediment and soil and het to attached species:
CalcVariable <- World$NewCalcVariable("FRACs")
World$CalcVar("FRACs")
```

    ##          Scale         SubCompart old_FRACs FRACs
    ## 1       Arctic                air     2e-11 2e-11
    ## 2       Arctic     marinesediment     2e-01 2e-01
    ## 3       Arctic        naturalsoil     6e-01 6e-01
    ## 4  Continental   agriculturalsoil     6e-01 6e-01
    ## 5  Continental                air     2e-11 2e-11
    ## 6  Continental freshwatersediment     2e-01 2e-01
    ## 7  Continental       lakesediment     2e-01 2e-01
    ## 8  Continental     marinesediment     2e-01 2e-01
    ## 9  Continental        naturalsoil     6e-01 6e-01
    ## 10 Continental          othersoil     6e-01 6e-01
    ## 11    Moderate                air     2e-11 2e-11
    ## 12    Moderate     marinesediment     2e-01 2e-01
    ## 13    Moderate        naturalsoil     6e-01 6e-01
    ## 14    Regional   agriculturalsoil     6e-01 6e-01
    ## 15    Regional                air     2e-11 2e-11
    ## 16    Regional freshwatersediment     2e-01 2e-01
    ## 17    Regional       lakesediment     2e-01 2e-01
    ## 18    Regional     marinesediment     2e-01 2e-01
    ## 19    Regional        naturalsoil     6e-01 6e-01
    ## 20    Regional          othersoil     6e-01 6e-01
    ## 21      Tropic                air     2e-11 2e-11
    ## 22      Tropic     marinesediment     2e-01 2e-01
    ## 23      Tropic        naturalsoil     6e-01 6e-01

``` r
World$FromDataAndTo("k_HeteroAgglomeration.wsd")
```

    ##                       process fromSpecies toSpecies   fromScale     toScale
    ## 1   k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 2   k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 3   k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 4   k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 5   k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 6   k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 7   k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 8   k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 9   k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 10  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 11  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 12  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 13  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 14  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 15  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 16  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 17  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 18  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 19  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 20  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 21  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 22  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 23  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 24  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 25  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 26  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 27  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 28  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 29  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 30  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 31  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 32  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 33  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 34  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 35  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 36  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 37  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 38  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 39  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 40  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 41  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 42  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 43  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 44  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 45  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 46  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 47  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 48  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 49  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 50  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 51  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 52  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 53  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 54  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 55  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 56  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 57  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 58  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 59  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 60  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 61  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 62  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 63  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 64  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 65  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 66  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 67  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 68  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 69  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 70  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 71  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 72  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 73  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 74  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 75  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 76  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 77  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 78  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 79  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 80  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 81  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 82  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 83  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 84  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 85  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 86  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 87  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 88  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 89  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 90  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 91  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 92  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 93  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 94  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 95  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 96  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 97  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 98  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 99  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 100 k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ##         fromSubCompart       toSubCompart
    ## 1     agriculturalsoil   agriculturalsoil
    ## 2     agriculturalsoil   agriculturalsoil
    ## 3     agriculturalsoil   agriculturalsoil
    ## 4     agriculturalsoil   agriculturalsoil
    ## 5     agriculturalsoil   agriculturalsoil
    ## 6     agriculturalsoil   agriculturalsoil
    ## 7     agriculturalsoil   agriculturalsoil
    ## 8     agriculturalsoil   agriculturalsoil
    ## 9     agriculturalsoil   agriculturalsoil
    ## 10    agriculturalsoil   agriculturalsoil
    ## 11           deepocean          deepocean
    ## 12           deepocean          deepocean
    ## 13           deepocean          deepocean
    ## 14           deepocean          deepocean
    ## 15           deepocean          deepocean
    ## 16           deepocean          deepocean
    ## 17           deepocean          deepocean
    ## 18           deepocean          deepocean
    ## 19           deepocean          deepocean
    ## 20           deepocean          deepocean
    ## 21  freshwatersediment freshwatersediment
    ## 22  freshwatersediment freshwatersediment
    ## 23  freshwatersediment freshwatersediment
    ## 24  freshwatersediment freshwatersediment
    ## 25  freshwatersediment freshwatersediment
    ## 26  freshwatersediment freshwatersediment
    ## 27  freshwatersediment freshwatersediment
    ## 28  freshwatersediment freshwatersediment
    ## 29  freshwatersediment freshwatersediment
    ## 30  freshwatersediment freshwatersediment
    ## 31                lake               lake
    ## 32                lake               lake
    ## 33                lake               lake
    ## 34                lake               lake
    ## 35                lake               lake
    ## 36                lake               lake
    ## 37                lake               lake
    ## 38                lake               lake
    ## 39                lake               lake
    ## 40                lake               lake
    ## 41        lakesediment       lakesediment
    ## 42        lakesediment       lakesediment
    ## 43        lakesediment       lakesediment
    ## 44        lakesediment       lakesediment
    ## 45        lakesediment       lakesediment
    ## 46        lakesediment       lakesediment
    ## 47        lakesediment       lakesediment
    ## 48        lakesediment       lakesediment
    ## 49        lakesediment       lakesediment
    ## 50        lakesediment       lakesediment
    ## 51      marinesediment     marinesediment
    ## 52      marinesediment     marinesediment
    ## 53      marinesediment     marinesediment
    ## 54      marinesediment     marinesediment
    ## 55      marinesediment     marinesediment
    ## 56      marinesediment     marinesediment
    ## 57      marinesediment     marinesediment
    ## 58      marinesediment     marinesediment
    ## 59      marinesediment     marinesediment
    ## 60      marinesediment     marinesediment
    ## 61         naturalsoil        naturalsoil
    ## 62         naturalsoil        naturalsoil
    ## 63         naturalsoil        naturalsoil
    ## 64         naturalsoil        naturalsoil
    ## 65         naturalsoil        naturalsoil
    ## 66         naturalsoil        naturalsoil
    ## 67         naturalsoil        naturalsoil
    ## 68         naturalsoil        naturalsoil
    ## 69         naturalsoil        naturalsoil
    ## 70         naturalsoil        naturalsoil
    ## 71           othersoil          othersoil
    ## 72           othersoil          othersoil
    ## 73           othersoil          othersoil
    ## 74           othersoil          othersoil
    ## 75           othersoil          othersoil
    ## 76           othersoil          othersoil
    ## 77           othersoil          othersoil
    ## 78           othersoil          othersoil
    ## 79           othersoil          othersoil
    ## 80           othersoil          othersoil
    ## 81               river              river
    ## 82               river              river
    ## 83               river              river
    ## 84               river              river
    ## 85               river              river
    ## 86               river              river
    ## 87               river              river
    ## 88               river              river
    ## 89               river              river
    ## 90               river              river
    ## 91                 sea                sea
    ## 92                 sea                sea
    ## 93                 sea                sea
    ## 94                 sea                sea
    ## 95                 sea                sea
    ## 96                 sea                sea
    ## 97                 sea                sea
    ## 98                 sea                sea
    ## 99                 sea                sea
    ## 100                sea                sea

``` r
testProc <- World$NewProcess("k_HeteroAgglomeration.wsd")
testProc$execute()
```

    ##                       process fromSpecies toSpecies   fromScale     toScale
    ## 3   k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 4   k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 7   k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 8   k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 11  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 12  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 15  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 16  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 19  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 20  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 23  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 24  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 27  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 28  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 33  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 34  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 37  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 38  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 43  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 44  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 47  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 48  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 51  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 52  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 53  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 54  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 55  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 56  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 57  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 58  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 59  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 60  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 61  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 62  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 63  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 64  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 65  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 66  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 67  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 68  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 69  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 70  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 73  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 74  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 77  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 78  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 83  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 84  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 87  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 88  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 91  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 92  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 93  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 94  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 95  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 96  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 97  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 98  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 99  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 100 k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ##         fromSubCompart       toSubCompart            k
    ## 3     agriculturalsoil   agriculturalsoil 4.493616e-03
    ## 4     agriculturalsoil   agriculturalsoil 1.483091e-02
    ## 7     agriculturalsoil   agriculturalsoil 4.493616e-03
    ## 8     agriculturalsoil   agriculturalsoil 1.483091e-02
    ## 11           deepocean          deepocean 4.686613e-05
    ## 12           deepocean          deepocean 2.738980e-03
    ## 15           deepocean          deepocean 4.901753e-05
    ## 16           deepocean          deepocean 2.967939e-03
    ## 19           deepocean          deepocean 5.028882e-05
    ## 20           deepocean          deepocean 3.103232e-03
    ## 23  freshwatersediment freshwatersediment 6.869643e-03
    ## 24  freshwatersediment freshwatersediment 2.254299e-03
    ## 27  freshwatersediment freshwatersediment 6.869643e-03
    ## 28  freshwatersediment freshwatersediment 2.254299e-03
    ## 33                lake               lake 3.893333e-06
    ## 34                lake               lake 5.250454e-04
    ## 37                lake               lake 3.893333e-06
    ## 38                lake               lake 5.250454e-04
    ## 43        lakesediment       lakesediment 6.869643e-03
    ## 44        lakesediment       lakesediment 1.050029e-03
    ## 47        lakesediment       lakesediment 6.869643e-03
    ## 48        lakesediment       lakesediment 1.050029e-03
    ## 51      marinesediment     marinesediment 7.237648e-03
    ## 52      marinesediment     marinesediment 5.474448e-03
    ## 53      marinesediment     marinesediment 7.632937e-03
    ## 54      marinesediment     marinesediment 5.932365e-03
    ## 55      marinesediment     marinesediment 7.632937e-03
    ## 56      marinesediment     marinesediment 5.932365e-03
    ## 57      marinesediment     marinesediment 7.632937e-03
    ## 58      marinesediment     marinesediment 5.932365e-03
    ## 59      marinesediment     marinesediment 7.861661e-03
    ## 60      marinesediment     marinesediment 6.202952e-03
    ## 61         naturalsoil        naturalsoil 6.817429e-03
    ## 62         naturalsoil        naturalsoil 2.189779e-02
    ## 63         naturalsoil        naturalsoil 7.189786e-03
    ## 64         naturalsoil        naturalsoil 2.372946e-02
    ## 65         naturalsoil        naturalsoil 7.189786e-03
    ## 66         naturalsoil        naturalsoil 2.372946e-02
    ## 67         naturalsoil        naturalsoil 7.189786e-03
    ## 68         naturalsoil        naturalsoil 2.372946e-02
    ## 69         naturalsoil        naturalsoil 7.405241e-03
    ## 70         naturalsoil        naturalsoil 2.481181e-02
    ## 73           othersoil          othersoil 4.044255e-03
    ## 74           othersoil          othersoil 1.334782e-02
    ## 77           othersoil          othersoil 4.044255e-03
    ## 78           othersoil          othersoil 1.334782e-02
    ## 83               river              river 2.878207e-04
    ## 84               river              river 1.133822e-03
    ## 87               river              river 2.878207e-04
    ## 88               river              river 1.133822e-03
    ## 91                 sea                sea 4.686613e-05
    ## 92                 sea                sea 2.738980e-03
    ## 93                 sea                sea 4.901753e-05
    ## 94                 sea                sea 2.967939e-03
    ## 95                 sea                sea 4.901753e-05
    ## 96                 sea                sea 2.967939e-03
    ## 97                 sea                sea 4.901753e-05
    ## 98                 sea                sea 2.967939e-03
    ## 99                 sea                sea 5.028882e-05
    ## 100                sea                sea 3.103232e-03

### Heteroagglomeration in air

Heteroagglomeration for attached species in soil and sediment is also
included in k_HeteroAgglomeration.wsd. However, heteroagglomeration in
air is calculated seperately using k_HeteroAgglomeration.a. In
k_HeteroAgglomeration.a, two helper functions are defined:

- ThermVel (calculates the thermal velocity)
- f_Fuchs (calculates Fuch’s correction factor).

In addition, the helper function f_Diffusivity is used to calculate the
diffusivitiy of the heteroagglomerate.

``` r
# Below are all variables used to calculate heteroagglomeration in air
World$fetchData("RadNuc") 
```

    ## [1] 1e-08

``` r
World$fetchData("RadCOL") 
```

    ##            SubCompart  RadCOL
    ## 1    agriculturalsoil 1.5e-07
    ## 2                 air 5.8e-08
    ## 4           deepocean 1.5e-07
    ## 5  freshwatersediment 1.5e-07
    ## 6                lake 1.5e-07
    ## 7        lakesediment 1.5e-07
    ## 8      marinesediment 1.5e-07
    ## 9         naturalsoil 1.5e-07
    ## 10          othersoil 1.5e-07
    ## 11              river 1.5e-07
    ## 12                sea 1.5e-07

``` r
World$fetchData("RadCP") 
```

    ##            SubCompart    RadCP
    ## 1    agriculturalsoil 1.28e-04
    ## 2                 air 9.00e-07
    ## 4           deepocean 3.00e-06
    ## 5  freshwatersediment 1.28e-04
    ## 6                lake 3.00e-06
    ## 7        lakesediment 1.28e-04
    ## 8      marinesediment 1.28e-04
    ## 9         naturalsoil 1.28e-04
    ## 10          othersoil 1.28e-04
    ## 11              river 3.00e-06
    ## 12                sea 3.00e-06

``` r
World$fetchData("NumConcNuc")
```

    ##         Scale NumConcNuc
    ## 1      Arctic    3.2e+09
    ## 2 Continental    3.2e+09
    ## 3    Moderate    3.2e+09
    ## 4    Regional    3.2e+09
    ## 5      Tropic    3.2e+09

``` r
World$fetchData("NumConcAcc")
```

    ##         Scale NumConcAcc
    ## 1      Arctic    2.9e+09
    ## 2 Continental    2.9e+09
    ## 3    Moderate    2.9e+09
    ## 4    Regional    2.9e+09
    ## 5      Tropic    2.9e+09

``` r
World$fetchData("NumConcCP")
```

    ##         Scale NumConcCP
    ## 1      Arctic     3e+05
    ## 2 Continental     3e+05
    ## 3    Moderate     3e+05
    ## 4    Regional     3e+05
    ## 5      Tropic     3e+05

``` r
World$fetchData("RhoNuc")
```

    ## [1] 1300

``` r
World$fetchData("RhoCOL")
```

    ##            SubCompart RhoCOL
    ## 1    agriculturalsoil   2000
    ## 2                 air   2000
    ## 4           deepocean   2000
    ## 5  freshwatersediment   2000
    ## 6                lake   2000
    ## 7        lakesediment   2000
    ## 8      marinesediment   2000
    ## 9         naturalsoil   2000
    ## 10          othersoil   2000
    ## 11              river   2000
    ## 12                sea   2000

``` r
World$fetchData("RhoCP")
```

    ##            SubCompart RhoCP
    ## 1    agriculturalsoil  2500
    ## 2                 air  2000
    ## 4           deepocean  2500
    ## 5  freshwatersediment  2500
    ## 6                lake  2500
    ## 7        lakesediment  2500
    ## 8      marinesediment  2500
    ## 9         naturalsoil  2500
    ## 10          othersoil  2500
    ## 11              river  2500
    ## 12                sea  2500

``` r
World$fetchData("Temp")
```

    ##         Scale Temp
    ## 1      Arctic  263
    ## 2 Continental  285
    ## 3    Moderate  285
    ## 4    Regional  285
    ## 5      Tropic  298

``` r
World$fetchData("DynViscAirStandard")
```

    ## [1] 1.81e-05

``` r
World$fetchData("Matrix")
```

    ##            SubCompart   Matrix
    ## 1    agriculturalsoil     soil
    ## 2                 air      air
    ## 3          cloudwater    water
    ## 4           deepocean    water
    ## 5  freshwatersediment sediment
    ## 6                lake    water
    ## 7        lakesediment sediment
    ## 8      marinesediment sediment
    ## 9         naturalsoil     soil
    ## 10          othersoil     soil
    ## 11              river    water
    ## 12                sea    water

``` r
World$fetchData("Substance") 
```

    ## [1] "nAg_10nm"

``` r
# Calculate heteroagglomeration in air: 
World$FromDataAndTo("k_HeteroAgglomeration.a")
```

    ##                    process fromSpecies toSpecies   fromScale     toScale
    ## 1  k_HeteroAgglomeration.a       Solid     Large      Arctic      Arctic
    ## 2  k_HeteroAgglomeration.a       Solid     Small      Arctic      Arctic
    ## 3  k_HeteroAgglomeration.a       Solid     Large Continental Continental
    ## 4  k_HeteroAgglomeration.a       Solid     Small Continental Continental
    ## 5  k_HeteroAgglomeration.a       Solid     Large    Moderate    Moderate
    ## 6  k_HeteroAgglomeration.a       Solid     Small    Moderate    Moderate
    ## 7  k_HeteroAgglomeration.a       Solid     Large    Regional    Regional
    ## 8  k_HeteroAgglomeration.a       Solid     Small    Regional    Regional
    ## 9  k_HeteroAgglomeration.a       Solid     Large      Tropic      Tropic
    ## 10 k_HeteroAgglomeration.a       Solid     Small      Tropic      Tropic
    ##    fromSubCompart toSubCompart
    ## 1             air          air
    ## 2             air          air
    ## 3             air          air
    ## 4             air          air
    ## 5             air          air
    ## 6             air          air
    ## 7             air          air
    ## 8             air          air
    ## 9             air          air
    ## 10            air          air

``` r
testProc <- World$NewProcess("k_HeteroAgglomeration.a")
testProc$execute()
```

    ##                    process fromSpecies toSpecies   fromScale     toScale
    ## 1  k_HeteroAgglomeration.a       Solid     Large      Arctic      Arctic
    ## 2  k_HeteroAgglomeration.a       Solid     Small      Arctic      Arctic
    ## 3  k_HeteroAgglomeration.a       Solid     Large Continental Continental
    ## 4  k_HeteroAgglomeration.a       Solid     Small Continental Continental
    ## 5  k_HeteroAgglomeration.a       Solid     Large    Moderate    Moderate
    ## 6  k_HeteroAgglomeration.a       Solid     Small    Moderate    Moderate
    ## 7  k_HeteroAgglomeration.a       Solid     Large    Regional    Regional
    ## 8  k_HeteroAgglomeration.a       Solid     Small    Regional    Regional
    ## 9  k_HeteroAgglomeration.a       Solid     Large      Tropic      Tropic
    ## 10 k_HeteroAgglomeration.a       Solid     Small      Tropic      Tropic
    ##    fromSubCompart toSubCompart            k
    ## 1             air          air 1.434667e-07
    ## 2             air          air 3.793379e-05
    ## 3             air          air 1.536977e-07
    ## 4             air          air 3.885128e-05
    ## 5             air          air 1.536977e-07
    ## 6             air          air 3.885128e-05
    ## 7             air          air 1.536977e-07
    ## 8             air          air 3.885128e-05
    ## 9             air          air 1.596345e-07
    ## 10            air          air 3.935090e-05

\[TO DO\* rework input of Aerosol concentrations into mass
concentrations instead of number concentrations as they are now for COL
and SUSP, and consider Nucc concentrations in CONSTANTS just like their
Rad and Rho properties\]

Potentially we can integrate air also in one algorithm, alhough it will
be a big one…

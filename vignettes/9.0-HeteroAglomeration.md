9 Heteroaglomeration
================
Jaap Slootweg, Joris Quik
2023-12-04

``` r
substance <- "nAg_10nm"
source("baseScripts/initTestWorld.R")
```

## Heteroaglomeration

This is a particulate process which only applies to Solid species and
the transformation to the Aggregated or Attached Particulate Species.

There are three different aproaches applied here depending on the matrix
where this process takes place and the species affected.

The three approaches are based on: - Smoluchowski’s colloid theory
(water, soil/sediment pore water) - Filtration theory for porous
matrices (soil and sediment) - Aerosol agglomeration approaches (air)

### Heteroagglomeration in water

This plays are role for the transformation from the primary particulate
species and their agglomeration with natural colloids \< 450 nm in
water, soil and sediment pore water. Also agglomeration with larger SPM
(\>450 nm) in water.

The data required for calculating for instance the collision frequency
is related to the particle number concentration of natural colloids
present in the compartment. For this we use the per subcompartment
defined characteristics of the natural particles: ‘RadCOL’, ‘RadCP’,
‘RhoCOL’ and ‘RhoCP’. For aerosols the Accumulation mode corresponds to
COL and Coarse Mode corresponds to CP characteristics.

The heteroaggregation rate constant is calculated using
(k_HeteroAgglomeration.wsd.R). This depends on the following variables:

1.  rad_species: this calculates the radius of the heteroagglomerate
    consisting of the solid particle and the Small or Large natural
    particle.

2.  rho_species: this calculates the density of the he heteroagglomerate
    consisting of the solid particle and the Small or Large natural
    particle.

Furthermore there are several helper functions used to avoid repeating
code and too complex variables:

- f_Inter

- f_Brown

- f_Grav

- f_NumConc

- f_SetVelWater

``` r
# for after editting data
# source("baseScripts/ReorderCSV.R")

World$fetchData("alpha") # here to.alpha needs to be used
```

    ##            SubCompart Species alpha
    ## 5    agriculturalsoil   Large 0.050
    ## 6    agriculturalsoil   Small 0.050
    ## 7           deepocean   Large 1.000
    ## 8           deepocean   Small 1.000
    ## 9  freshwatersediment   Large 0.900
    ## 10 freshwatersediment   Small 0.380
    ## 11               lake   Large 0.900
    ## 12               lake   Small 0.177
    ## 13       lakesediment   Large 0.900
    ## 14       lakesediment   Small 0.177
    ## 15     marinesediment   Large 1.000
    ## 16     marinesediment   Small 1.000
    ## 17        naturalsoil   Large 0.080
    ## 18        naturalsoil   Small 0.080
    ## 19          othersoil   Large 0.045
    ## 20          othersoil   Small 0.045
    ## 21              river   Large 0.900
    ## 22              river   Small 0.380
    ## 23                sea   Large 1.000
    ## 24                sea   Small 1.000

``` r
World$fetchData("COL")
```

    ##            SubCompart COL
    ## 3  freshwatersediment 100
    ## 4        lakesediment 100
    ## 5      marinesediment 100
    ## 6    agriculturalsoil 100
    ## 7         naturalsoil 100
    ## 8           othersoil 100
    ## 9           deepocean   1
    ## 10               lake   1
    ## 11              river   1
    ## 12                sea   1

``` r
World$fetchData("SUSP")
```

    ##    SubCompart   SUSP
    ## 9   deepocean 0.0050
    ## 10       lake 0.0005
    ## 11      river 0.0150
    ## 12        sea 0.0050

``` r
World$fetchData("Shear")
```

    ##          Scale         SubCompart Shear
    ## 3       Arctic          deepocean    10
    ## 4       Arctic     marinesediment     0
    ## 5       Arctic        naturalsoil     0
    ## 6       Arctic                sea    10
    ## 7  Continental   agriculturalsoil     0
    ## 10 Continental freshwatersediment     0
    ## 11 Continental               lake     1
    ## 12 Continental       lakesediment     0
    ## 13 Continental     marinesediment     0
    ## 14 Continental        naturalsoil     0
    ## 15 Continental          othersoil     0
    ## 16 Continental              river   100
    ## 17 Continental                sea    10
    ## 20    Moderate          deepocean    10
    ## 21    Moderate     marinesediment     0
    ## 22    Moderate        naturalsoil     0
    ## 23    Moderate                sea    10
    ## 24    Regional   agriculturalsoil     0
    ## 27    Regional freshwatersediment     0
    ## 28    Regional               lake     1
    ## 29    Regional       lakesediment     0
    ## 30    Regional     marinesediment     0
    ## 31    Regional        naturalsoil     0
    ## 32    Regional          othersoil     0
    ## 33    Regional              river   100
    ## 34    Regional                sea    10
    ## 37      Tropic          deepocean    10
    ## 38      Tropic     marinesediment     0
    ## 39      Tropic        naturalsoil     0
    ## 40      Tropic                sea    10

``` r
World$fetchData("RadS")
```

    ## [1] 5e-09

``` r
World$fetchData("RhoS")
```

    ## [1] 10500

``` r
World$fetchData("Temp")
```

    ##         Scale Temp
    ## 1      Arctic  263
    ## 2 Continental  285
    ## 3    Moderate  285
    ## 4    Regional  285
    ## 5      Tropic  298

``` r
World$fetchData("RhoCOL")
```

    ##            SubCompart RhoCOL
    ## 1                 air   2000
    ## 3  freshwatersediment   2000
    ## 4        lakesediment   2000
    ## 5      marinesediment   2000
    ## 6    agriculturalsoil   2000
    ## 7         naturalsoil   2000
    ## 8           othersoil   2000
    ## 9           deepocean   2000
    ## 10               lake   2000
    ## 11              river   2000
    ## 12                sea   2000

``` r
World$fetchData("RhoCP")
```

    ##            SubCompart RhoCP
    ## 1                 air  2000
    ## 3  freshwatersediment  2500
    ## 4        lakesediment  2500
    ## 5      marinesediment  2500
    ## 6    agriculturalsoil  2500
    ## 7         naturalsoil  2500
    ## 8           othersoil  2500
    ## 9           deepocean  2500
    ## 10               lake  2500
    ## 11              river  2500
    ## 12                sea  2500

``` r
World$fetchData("RadCOL")
```

    ##            SubCompart  RadCOL
    ## 1                 air 5.8e-08
    ## 3  freshwatersediment 1.5e-07
    ## 4        lakesediment 1.5e-07
    ## 5      marinesediment 1.5e-07
    ## 6    agriculturalsoil 1.5e-07
    ## 7         naturalsoil 1.5e-07
    ## 8           othersoil 1.5e-07
    ## 9           deepocean 1.5e-07
    ## 10               lake 1.5e-07
    ## 11              river 1.5e-07
    ## 12                sea 1.5e-07

``` r
World$fetchData("RadCP")
```

    ##            SubCompart    RadCP
    ## 1                 air 9.00e-07
    ## 3  freshwatersediment 1.28e-04
    ## 4        lakesediment 1.28e-04
    ## 5      marinesediment 1.28e-04
    ## 6    agriculturalsoil 1.28e-04
    ## 7         naturalsoil 1.28e-04
    ## 8           othersoil 1.28e-04
    ## 9           deepocean 3.00e-06
    ## 10               lake 3.00e-06
    ## 11              river 3.00e-06
    ## 12                sea 3.00e-06

``` r
World$fetchData("RadNuc")
```

    ## [1] 1e-08

``` r
World$fetchData("NumConcNuc")
```

    ##         Scale NumConcNuc
    ## 1      Arctic    3.2e+09
    ## 2 Continental    3.2e+09
    ## 3    Moderate    3.2e+09
    ## 4    Regional    3.2e+09
    ## 5      Tropic    3.2e+09

``` r
World$fetchData("NumConcAcc")
```

    ##         Scale NumConcAcc
    ## 1      Arctic    2.9e+09
    ## 2 Continental    2.9e+09
    ## 3    Moderate    2.9e+09
    ## 4    Regional    2.9e+09
    ## 5      Tropic    2.9e+09

``` r
World$fetchData("NumConcCP")
```

    ##         Scale NumConcCP
    ## 1      Arctic     3e+05
    ## 2 Continental     3e+05
    ## 3    Moderate     3e+05
    ## 4    Regional     3e+05
    ## 5      Tropic     3e+05

``` r
World$fetchData("DynViscWaterStandard")
```

    ## [1] 0.001002

``` r
World$fetchData("DynViscAirStandard")
```

    ## [1] 1.81e-05

``` r
World$fetchData("Df")
```

    ## [1] 0.3333333

``` r
World$fetchData("SubCompartName")
```

    ##            SubCompart     SubCompartName
    ## 1                 air                air
    ## 2          cloudwater         cloudwater
    ## 3  freshwatersediment freshwatersediment
    ## 4        lakesediment       lakesediment
    ## 5      marinesediment     marinesediment
    ## 6    agriculturalsoil   agriculturalsoil
    ## 7         naturalsoil        naturalsoil
    ## 8           othersoil          othersoil
    ## 9           deepocean          deepocean
    ## 10               lake               lake
    ## 11              river              river
    ## 12                sea                sea

``` r
CalcVariable <- World$NewCalcVariable("rad_species")
#CalcVariable$execute(debugAt = list(assembly = T))

World$CalcVar("rad_species")
```

    ##           Scale         SubCompart Species  rad_species
    ## 2        Arctic                air   Small 4.539290e-08
    ## 3        Arctic       lakesediment   Solid 5.000000e-09
    ## 4        Arctic         cloudwater   Solid 5.000000e-09
    ## 5        Arctic               lake   Small 1.500019e-07
    ## 7        Arctic          deepocean   Large 3.000000e-06
    ## 8        Arctic          othersoil   Large 1.280000e-04
    ## 9        Arctic   agriculturalsoil   Large 1.280000e-04
    ## 11       Arctic                air   Large 9.000001e-07
    ## 12       Arctic          deepocean   Solid 5.000000e-09
    ## 16       Arctic freshwatersediment   Solid 5.000000e-09
    ## 17       Arctic freshwatersediment   Large 1.280000e-04
    ## 18       Arctic              river   Large 3.000000e-06
    ## 20       Arctic        naturalsoil   Large 1.280000e-04
    ## 21       Arctic freshwatersediment   Small 1.500019e-07
    ## 22       Arctic              river   Small 1.500019e-07
    ## 23       Arctic              river   Solid 5.000000e-09
    ## 24       Arctic       lakesediment   Large 1.280000e-04
    ## 25       Arctic          deepocean   Small 1.500019e-07
    ## 26       Arctic     marinesediment   Large 1.280000e-04
    ## 27       Arctic       lakesediment   Small 1.500019e-07
    ## 29       Arctic          othersoil   Small 1.500019e-07
    ## 30       Arctic        naturalsoil   Solid 5.000000e-09
    ## 31       Arctic               lake   Large 3.000000e-06
    ## 33       Arctic     marinesediment   Small 1.500019e-07
    ## 35       Arctic   agriculturalsoil   Solid 5.000000e-09
    ## 37       Arctic   agriculturalsoil   Small 1.500019e-07
    ## 38       Arctic                air   Solid 5.000000e-09
    ## 39       Arctic        naturalsoil   Small 1.500019e-07
    ## 40       Arctic                sea   Large 3.000000e-06
    ## 41       Arctic                sea   Solid 5.000000e-09
    ## 42       Arctic     marinesediment   Solid 5.000000e-09
    ## 44       Arctic          othersoil   Solid 5.000000e-09
    ## 45       Arctic               lake   Solid 5.000000e-09
    ## 47       Arctic                sea   Small 1.500019e-07
    ## 50  Continental freshwatersediment   Solid 5.000000e-09
    ## 51  Continental       lakesediment   Large 1.280000e-04
    ## 52  Continental        naturalsoil   Solid 5.000000e-09
    ## 53  Continental                air   Solid 5.000000e-09
    ## 54  Continental               lake   Large 3.000000e-06
    ## 55  Continental          deepocean   Large 3.000000e-06
    ## 56  Continental        naturalsoil   Large 1.280000e-04
    ## 57  Continental                air   Small 4.539290e-08
    ## 58  Continental freshwatersediment   Large 1.280000e-04
    ## 59  Continental     marinesediment   Large 1.280000e-04
    ## 60  Continental     marinesediment   Solid 5.000000e-09
    ## 61  Continental                sea   Solid 5.000000e-09
    ## 63  Continental       lakesediment   Small 1.500019e-07
    ## 64  Continental          othersoil   Small 1.500019e-07
    ## 65  Continental     marinesediment   Small 1.500019e-07
    ## 66  Continental          deepocean   Solid 5.000000e-09
    ## 67  Continental       lakesediment   Solid 5.000000e-09
    ## 69  Continental                sea   Large 3.000000e-06
    ## 70  Continental               lake   Solid 5.000000e-09
    ## 71  Continental          deepocean   Small 1.500019e-07
    ## 72  Continental        naturalsoil   Small 1.500019e-07
    ## 74  Continental freshwatersediment   Small 1.500019e-07
    ## 76  Continental   agriculturalsoil   Large 1.280000e-04
    ## 77  Continental              river   Large 3.000000e-06
    ## 78  Continental          othersoil   Solid 5.000000e-09
    ## 79  Continental              river   Solid 5.000000e-09
    ## 80  Continental                air   Large 9.000001e-07
    ## 82  Continental   agriculturalsoil   Small 1.500019e-07
    ## 86  Continental          othersoil   Large 1.280000e-04
    ## 87  Continental                sea   Small 1.500019e-07
    ## 89  Continental   agriculturalsoil   Solid 5.000000e-09
    ## 91  Continental               lake   Small 1.500019e-07
    ## 92  Continental              river   Small 1.500019e-07
    ## 93  Continental         cloudwater   Solid 5.000000e-09
    ## 95     Moderate   agriculturalsoil   Large 1.280000e-04
    ## 96     Moderate   agriculturalsoil   Solid 5.000000e-09
    ## 97     Moderate        naturalsoil   Small 1.500019e-07
    ## 101    Moderate                air   Solid 5.000000e-09
    ## 102    Moderate   agriculturalsoil   Small 1.500019e-07
    ## 103    Moderate          othersoil   Small 1.500019e-07
    ## 104    Moderate          deepocean   Large 3.000000e-06
    ## 105    Moderate        naturalsoil   Solid 5.000000e-09
    ## 108    Moderate         cloudwater   Solid 5.000000e-09
    ## 109    Moderate               lake   Small 1.500019e-07
    ## 110    Moderate          othersoil   Large 1.280000e-04
    ## 111    Moderate          deepocean   Small 1.500019e-07
    ## 114    Moderate                sea   Solid 5.000000e-09
    ## 115    Moderate                air   Large 9.000001e-07
    ## 117    Moderate        naturalsoil   Large 1.280000e-04
    ## 118    Moderate                sea   Small 1.500019e-07
    ## 119    Moderate       lakesediment   Large 1.280000e-04
    ## 120    Moderate     marinesediment   Large 1.280000e-04
    ## 121    Moderate               lake   Solid 5.000000e-09
    ## 122    Moderate freshwatersediment   Small 1.500019e-07
    ## 123    Moderate              river   Solid 5.000000e-09
    ## 124    Moderate              river   Small 1.500019e-07
    ## 125    Moderate freshwatersediment   Solid 5.000000e-09
    ## 126    Moderate       lakesediment   Small 1.500019e-07
    ## 127    Moderate     marinesediment   Small 1.500019e-07
    ## 128    Moderate     marinesediment   Solid 5.000000e-09
    ## 130    Moderate                sea   Large 3.000000e-06
    ## 133    Moderate                air   Small 4.539290e-08
    ## 134    Moderate freshwatersediment   Large 1.280000e-04
    ## 136    Moderate       lakesediment   Solid 5.000000e-09
    ## 137    Moderate          deepocean   Solid 5.000000e-09
    ## 139    Moderate          othersoil   Solid 5.000000e-09
    ## 140    Moderate              river   Large 3.000000e-06
    ## 141    Moderate               lake   Large 3.000000e-06
    ## 142    Regional       lakesediment   Large 1.280000e-04
    ## 145    Regional   agriculturalsoil   Solid 5.000000e-09
    ## 146    Regional                sea   Small 1.500019e-07
    ## 147    Regional       lakesediment   Small 1.500019e-07
    ## 148    Regional              river   Solid 5.000000e-09
    ## 149    Regional                air   Large 9.000001e-07
    ## 151    Regional        naturalsoil   Small 1.500019e-07
    ## 154    Regional freshwatersediment   Small 1.500019e-07
    ## 155    Regional               lake   Solid 5.000000e-09
    ## 156    Regional freshwatersediment   Solid 5.000000e-09
    ## 158    Regional                sea   Solid 5.000000e-09
    ## 159    Regional          deepocean   Large 3.000000e-06
    ## 160    Regional          othersoil   Small 1.500019e-07
    ## 161    Regional   agriculturalsoil   Large 1.280000e-04
    ## 162    Regional               lake   Small 1.500019e-07
    ## 163    Regional   agriculturalsoil   Small 1.500019e-07
    ## 164    Regional       lakesediment   Solid 5.000000e-09
    ## 165    Regional                air   Solid 5.000000e-09
    ## 166    Regional          othersoil   Large 1.280000e-04
    ## 171    Regional freshwatersediment   Large 1.280000e-04
    ## 172    Regional              river   Large 3.000000e-06
    ## 173    Regional     marinesediment   Small 1.500019e-07
    ## 174    Regional                air   Small 4.539290e-08
    ## 175    Regional         cloudwater   Solid 5.000000e-09
    ## 176    Regional        naturalsoil   Solid 5.000000e-09
    ## 179    Regional     marinesediment   Solid 5.000000e-09
    ## 180    Regional                sea   Large 3.000000e-06
    ## 181    Regional          deepocean   Solid 5.000000e-09
    ## 182    Regional               lake   Large 3.000000e-06
    ## 183    Regional        naturalsoil   Large 1.280000e-04
    ## 184    Regional          deepocean   Small 1.500019e-07
    ## 186    Regional              river   Small 1.500019e-07
    ## 187    Regional          othersoil   Solid 5.000000e-09
    ## 188    Regional     marinesediment   Large 1.280000e-04
    ## 189      Tropic       lakesediment   Small 1.500019e-07
    ## 190      Tropic         cloudwater   Solid 5.000000e-09
    ## 191      Tropic          othersoil   Solid 5.000000e-09
    ## 192      Tropic   agriculturalsoil   Small 1.500019e-07
    ## 194      Tropic   agriculturalsoil   Solid 5.000000e-09
    ## 195      Tropic       lakesediment   Solid 5.000000e-09
    ## 196      Tropic          deepocean   Small 1.500019e-07
    ## 200      Tropic        naturalsoil   Large 1.280000e-04
    ## 201      Tropic freshwatersediment   Solid 5.000000e-09
    ## 203      Tropic                air   Large 9.000001e-07
    ## 204      Tropic freshwatersediment   Small 1.500019e-07
    ## 205      Tropic freshwatersediment   Large 1.280000e-04
    ## 206      Tropic     marinesediment   Large 1.280000e-04
    ## 207      Tropic                sea   Large 3.000000e-06
    ## 208      Tropic       lakesediment   Large 1.280000e-04
    ## 209      Tropic     marinesediment   Solid 5.000000e-09
    ## 211      Tropic          othersoil   Small 1.500019e-07
    ## 213      Tropic                air   Solid 5.000000e-09
    ## 214      Tropic                air   Small 4.539290e-08
    ## 216      Tropic          othersoil   Large 1.280000e-04
    ## 218      Tropic               lake   Small 1.500019e-07
    ## 219      Tropic              river   Large 3.000000e-06
    ## 220      Tropic               lake   Large 3.000000e-06
    ## 221      Tropic        naturalsoil   Solid 5.000000e-09
    ## 222      Tropic          deepocean   Large 3.000000e-06
    ## 225      Tropic              river   Solid 5.000000e-09
    ## 226      Tropic                sea   Solid 5.000000e-09
    ## 227      Tropic        naturalsoil   Small 1.500019e-07
    ## 228      Tropic          deepocean   Solid 5.000000e-09
    ## 229      Tropic     marinesediment   Small 1.500019e-07
    ## 230      Tropic                sea   Small 1.500019e-07
    ## 231      Tropic   agriculturalsoil   Large 1.280000e-04
    ## 234      Tropic               lake   Solid 5.000000e-09
    ## 235      Tropic              river   Small 1.500019e-07

``` r
# debugonce(rad_species)
# other debug met is using browser()
# CalcVariable$execute(debugAt = list(ScaleName = "Art")) # Not working currently

World$NewCalcVariable("rho_species")
(World$CalcVar("rho_species"))
```

    ##           Scale         SubCompart Species rho_species
    ## 2        Arctic freshwatersediment   Solid   10500.000
    ## 5        Arctic   agriculturalsoil   Large    2500.000
    ## 6        Arctic               lake   Solid   10500.000
    ## 9        Arctic freshwatersediment   Small    2000.315
    ## 10       Arctic                air   Solid   10500.000
    ## 11       Arctic          othersoil   Large    2500.000
    ## 12       Arctic          deepocean   Small    2000.315
    ## 13       Arctic          deepocean   Solid   10500.000
    ## 16       Arctic freshwatersediment   Large    2500.000
    ## 17       Arctic       lakesediment   Solid   10500.000
    ## 18       Arctic              river   Solid   10500.000
    ## 19       Arctic   agriculturalsoil   Small    2000.315
    ## 20       Arctic                air   Large    2000.001
    ## 23       Arctic         cloudwater   Solid   10500.000
    ## 24       Arctic        naturalsoil   Solid   10500.000
    ## 25       Arctic     marinesediment   Large    2500.000
    ## 26       Arctic              river   Large    2500.000
    ## 27       Arctic   agriculturalsoil   Solid   10500.000
    ## 28       Arctic                sea   Small    2000.315
    ## 29       Arctic               lake   Large    2500.000
    ## 31       Arctic                sea   Solid   10500.000
    ## 32       Arctic               lake   Small    2000.315
    ## 34       Arctic        naturalsoil   Small    2000.315
    ## 35       Arctic              river   Small    2000.315
    ## 36       Arctic          deepocean   Large    2500.000
    ## 37       Arctic       lakesediment   Large    2500.000
    ## 38       Arctic          othersoil   Solid   10500.000
    ## 39       Arctic          othersoil   Small    2000.315
    ## 40       Arctic       lakesediment   Small    2000.315
    ## 42       Arctic        naturalsoil   Large    2500.000
    ## 43       Arctic     marinesediment   Solid   10500.000
    ## 44       Arctic                air   Small    2007.444
    ## 45       Arctic     marinesediment   Small    2000.315
    ## 46       Arctic                sea   Large    2500.000
    ## 48  Continental freshwatersediment   Large    2500.000
    ## 49  Continental       lakesediment   Small    2000.315
    ## 51  Continental       lakesediment   Large    2500.000
    ## 52  Continental   agriculturalsoil   Small    2000.315
    ## 53  Continental       lakesediment   Solid   10500.000
    ## 55  Continental        naturalsoil   Large    2500.000
    ## 56  Continental   agriculturalsoil   Large    2500.000
    ## 58  Continental   agriculturalsoil   Solid   10500.000
    ## 59  Continental        naturalsoil   Solid   10500.000
    ## 61  Continental                air   Small    2007.444
    ## 62  Continental          deepocean   Solid   10500.000
    ## 63  Continental          deepocean   Large    2500.000
    ## 64  Continental          othersoil   Large    2500.000
    ## 65  Continental              river   Large    2500.000
    ## 66  Continental         cloudwater   Solid   10500.000
    ## 69  Continental          deepocean   Small    2000.315
    ## 73  Continental     marinesediment   Small    2000.315
    ## 74  Continental        naturalsoil   Small    2000.315
    ## 75  Continental                air   Large    2000.001
    ## 78  Continental                air   Solid   10500.000
    ## 79  Continental freshwatersediment   Solid   10500.000
    ## 80  Continental                sea   Small    2000.315
    ## 81  Continental               lake   Small    2000.315
    ## 83  Continental               lake   Large    2500.000
    ## 84  Continental     marinesediment   Solid   10500.000
    ## 85  Continental          othersoil   Small    2000.315
    ## 86  Continental                sea   Solid   10500.000
    ## 87  Continental              river   Small    2000.315
    ## 88  Continental               lake   Solid   10500.000
    ## 89  Continental freshwatersediment   Small    2000.315
    ## 90  Continental          othersoil   Solid   10500.000
    ## 91  Continental     marinesediment   Large    2500.000
    ## 92  Continental                sea   Large    2500.000
    ## 93  Continental              river   Solid   10500.000
    ## 96     Moderate               lake   Small    2000.315
    ## 97     Moderate        naturalsoil   Small    2000.315
    ## 98     Moderate   agriculturalsoil   Solid   10500.000
    ## 100    Moderate   agriculturalsoil   Small    2000.315
    ## 101    Moderate          deepocean   Solid   10500.000
    ## 103    Moderate                air   Large    2000.001
    ## 104    Moderate          deepocean   Large    2500.000
    ## 105    Moderate        naturalsoil   Solid   10500.000
    ## 106    Moderate   agriculturalsoil   Large    2500.000
    ## 108    Moderate         cloudwater   Solid   10500.000
    ## 109    Moderate freshwatersediment   Small    2000.315
    ## 110    Moderate          othersoil   Large    2500.000
    ## 111    Moderate          deepocean   Small    2000.315
    ## 114    Moderate                sea   Solid   10500.000
    ## 115    Moderate               lake   Large    2500.000
    ## 116    Moderate                air   Small    2007.444
    ## 117    Moderate        naturalsoil   Large    2500.000
    ## 118    Moderate                sea   Small    2000.315
    ## 119    Moderate                air   Solid   10500.000
    ## 120    Moderate     marinesediment   Large    2500.000
    ## 121    Moderate               lake   Solid   10500.000
    ## 123    Moderate              river   Solid   10500.000
    ## 124    Moderate              river   Small    2000.315
    ## 127    Moderate     marinesediment   Small    2000.315
    ## 128    Moderate     marinesediment   Solid   10500.000
    ## 129    Moderate                sea   Large    2500.000
    ## 130    Moderate          othersoil   Small    2000.315
    ## 131    Moderate              river   Large    2500.000
    ## 132    Moderate       lakesediment   Large    2500.000
    ## 133    Moderate freshwatersediment   Large    2500.000
    ## 134    Moderate       lakesediment   Solid   10500.000
    ## 135    Moderate       lakesediment   Small    2000.315
    ## 136    Moderate          othersoil   Solid   10500.000
    ## 137    Moderate freshwatersediment   Solid   10500.000
    ## 142    Regional                air   Small    2007.444
    ## 143    Regional          deepocean   Solid   10500.000
    ## 146    Regional                air   Solid   10500.000
    ## 147    Regional                air   Large    2000.001
    ## 148    Regional freshwatersediment   Solid   10500.000
    ## 150    Regional freshwatersediment   Small    2000.315
    ## 151    Regional   agriculturalsoil   Solid   10500.000
    ## 152    Regional     marinesediment   Large    2500.000
    ## 153    Regional              river   Large    2500.000
    ## 154    Regional          deepocean   Large    2500.000
    ## 156    Regional          deepocean   Small    2000.315
    ## 157    Regional        naturalsoil   Small    2000.315
    ## 158    Regional         cloudwater   Solid   10500.000
    ## 159    Regional   agriculturalsoil   Large    2500.000
    ## 160    Regional          othersoil   Solid   10500.000
    ## 161    Regional freshwatersediment   Large    2500.000
    ## 162    Regional       lakesediment   Small    2000.315
    ## 163    Regional              river   Solid   10500.000
    ## 164    Regional       lakesediment   Large    2500.000
    ## 165    Regional        naturalsoil   Large    2500.000
    ## 168    Regional       lakesediment   Solid   10500.000
    ## 170    Regional   agriculturalsoil   Small    2000.315
    ## 171    Regional                sea   Large    2500.000
    ## 173    Regional              river   Small    2000.315
    ## 175    Regional               lake   Large    2500.000
    ## 176    Regional                sea   Solid   10500.000
    ## 177    Regional     marinesediment   Small    2000.315
    ## 178    Regional                sea   Small    2000.315
    ## 179    Regional          othersoil   Small    2000.315
    ## 181    Regional        naturalsoil   Solid   10500.000
    ## 182    Regional               lake   Small    2000.315
    ## 183    Regional          othersoil   Large    2500.000
    ## 184    Regional               lake   Solid   10500.000
    ## 188    Regional     marinesediment   Solid   10500.000
    ## 189      Tropic   agriculturalsoil   Small    2000.315
    ## 190      Tropic                air   Large    2000.001
    ## 192      Tropic       lakesediment   Small    2000.315
    ## 194      Tropic                air   Solid   10500.000
    ## 195      Tropic          othersoil   Small    2000.315
    ## 196      Tropic   agriculturalsoil   Solid   10500.000
    ## 198      Tropic                sea   Solid   10500.000
    ## 199      Tropic        naturalsoil   Large    2500.000
    ## 201      Tropic   agriculturalsoil   Large    2500.000
    ## 202      Tropic                air   Small    2007.444
    ## 203      Tropic          deepocean   Large    2500.000
    ## 205      Tropic               lake   Solid   10500.000
    ## 207      Tropic          othersoil   Large    2500.000
    ## 209      Tropic freshwatersediment   Large    2500.000
    ## 210      Tropic          deepocean   Small    2000.315
    ## 211      Tropic               lake   Large    2500.000
    ## 212      Tropic freshwatersediment   Solid   10500.000
    ## 213      Tropic       lakesediment   Large    2500.000
    ## 216      Tropic     marinesediment   Large    2500.000
    ## 217      Tropic freshwatersediment   Small    2000.315
    ## 219      Tropic              river   Large    2500.000
    ## 221      Tropic       lakesediment   Solid   10500.000
    ## 223      Tropic          othersoil   Solid   10500.000
    ## 224      Tropic        naturalsoil   Solid   10500.000
    ## 225      Tropic          deepocean   Solid   10500.000
    ## 226      Tropic        naturalsoil   Small    2000.315
    ## 228      Tropic                sea   Large    2500.000
    ## 229      Tropic               lake   Small    2000.315
    ## 230      Tropic         cloudwater   Solid   10500.000
    ## 231      Tropic              river   Small    2000.315
    ## 232      Tropic     marinesediment   Solid   10500.000
    ## 233      Tropic     marinesediment   Small    2000.315
    ## 234      Tropic              river   Solid   10500.000
    ## 235      Tropic                sea   Small    2000.315

``` r
# World$NewCalcVariable("SettlingVelocity")
# World$CalcVar("SettlingVelocity")


World$fetchData("SettlingVelocity")
```

    ## Warning in private$FetchData(varname): Cannot find property SettlingVelocity ;
    ## but found

    ## [1] NA

``` r
f_SetVelWater
```

    ## function (radius, rhoParticle, rhoWater, DynViscWaterStandard) 
    ## {
    ##     GN <- constants::syms$gn
    ##     2 * (radius^2 * (rhoParticle - rhoWater) * GN)/(9 * DynViscWaterStandard)
    ## }

``` r
World$fetchData("rhoMatrix")
```

    ##            SubCompart rhoMatrix
    ## 1                 air     1.225
    ## 2          cloudwater   998.000
    ## 3  freshwatersediment  2500.000
    ## 4        lakesediment  2500.000
    ## 5      marinesediment  2500.000
    ## 6    agriculturalsoil  2500.000
    ## 7         naturalsoil  2500.000
    ## 8           othersoil  2500.000
    ## 9           deepocean   998.000
    ## 10               lake   998.000
    ## 11              river   998.000
    ## 12                sea   998.000

``` r
World$fetchData("Matrix")
```

    ##            SubCompart   Matrix
    ## 1                 air      air
    ## 2          cloudwater    water
    ## 3  freshwatersediment sediment
    ## 4        lakesediment sediment
    ## 5      marinesediment sediment
    ## 6    agriculturalsoil     soil
    ## 7         naturalsoil     soil
    ## 8           othersoil     soil
    ## 9           deepocean    water
    ## 10               lake    water
    ## 11              river    water
    ## 12                sea    water

``` r
World$fetchData("SpeciesName") # supposed to be in multiple tables?
```

    ##   Species  SpeciesName
    ## 3   Large     Attached
    ## 4   Small   Aggregated
    ## 5   Solid Nanoparticle
    ## 6 Unbound    Molecular

``` r
# for sediment and soil and het to attached species:
CalcVariable <- World$NewCalcVariable("FRACs")
World$CalcVar("FRACs")
```

    ##            SubCompart       Scale FRACs
    ## 3    agriculturalsoil    Regional 6e-01
    ## 5    agriculturalsoil Continental 6e-01
    ## 6                 air      Arctic 2e-11
    ## 7                 air      Tropic 2e-11
    ## 8                 air    Regional 2e-11
    ## 9                 air Continental 2e-11
    ## 10                air    Moderate 2e-11
    ## 22 freshwatersediment Continental 2e-01
    ## 24 freshwatersediment    Regional 2e-01
    ## 32       lakesediment Continental 2e-01
    ## 34       lakesediment    Regional 2e-01
    ## 36     marinesediment      Arctic 2e-01
    ## 37     marinesediment Continental 2e-01
    ## 38     marinesediment    Moderate 2e-01
    ## 39     marinesediment    Regional 2e-01
    ## 40     marinesediment      Tropic 2e-01
    ## 41        naturalsoil      Arctic 6e-01
    ## 42        naturalsoil Continental 6e-01
    ## 43        naturalsoil    Moderate 6e-01
    ## 44        naturalsoil    Regional 6e-01
    ## 45        naturalsoil      Tropic 6e-01
    ## 46          othersoil Continental 6e-01
    ## 49          othersoil    Regional 6e-01

``` r
World$FromDataAndTo("k_HeteroAgglomeration.wsd")
```

    ##                       process fromSpecies toSpecies   fromScale     toScale
    ## 1   k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 2   k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 3   k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 4   k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 5   k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 6   k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 7   k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 8   k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 9   k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 10  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 11  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 12  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 13  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 14  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 15  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 16  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 17  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 18  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 19  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 20  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 21  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 22  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 23  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 24  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 25  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 26  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 27  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 28  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 29  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 30  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 31  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 32  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 33  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 34  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 35  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 36  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 37  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 38  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 39  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 40  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 41  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 42  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 43  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 44  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 45  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 46  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 47  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 48  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 49  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 50  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 51  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 52  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 53  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 54  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 55  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 56  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 57  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 58  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 59  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 60  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 61  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 62  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 63  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 64  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 65  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 66  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 67  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 68  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 69  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 70  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 71  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 72  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 73  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 74  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 75  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 76  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 77  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 78  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 79  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 80  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 81  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 82  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 83  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 84  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 85  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 86  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 87  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 88  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 89  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 90  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 91  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 92  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 93  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 94  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 95  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 96  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 97  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 98  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 99  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 100 k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ##         fromSubCompart       toSubCompart
    ## 1   freshwatersediment freshwatersediment
    ## 2   freshwatersediment freshwatersediment
    ## 3   freshwatersediment freshwatersediment
    ## 4   freshwatersediment freshwatersediment
    ## 5   freshwatersediment freshwatersediment
    ## 6   freshwatersediment freshwatersediment
    ## 7   freshwatersediment freshwatersediment
    ## 8   freshwatersediment freshwatersediment
    ## 9   freshwatersediment freshwatersediment
    ## 10  freshwatersediment freshwatersediment
    ## 11        lakesediment       lakesediment
    ## 12        lakesediment       lakesediment
    ## 13        lakesediment       lakesediment
    ## 14        lakesediment       lakesediment
    ## 15        lakesediment       lakesediment
    ## 16        lakesediment       lakesediment
    ## 17        lakesediment       lakesediment
    ## 18        lakesediment       lakesediment
    ## 19        lakesediment       lakesediment
    ## 20        lakesediment       lakesediment
    ## 21      marinesediment     marinesediment
    ## 22      marinesediment     marinesediment
    ## 23      marinesediment     marinesediment
    ## 24      marinesediment     marinesediment
    ## 25      marinesediment     marinesediment
    ## 26      marinesediment     marinesediment
    ## 27      marinesediment     marinesediment
    ## 28      marinesediment     marinesediment
    ## 29      marinesediment     marinesediment
    ## 30      marinesediment     marinesediment
    ## 31    agriculturalsoil   agriculturalsoil
    ## 32    agriculturalsoil   agriculturalsoil
    ## 33    agriculturalsoil   agriculturalsoil
    ## 34    agriculturalsoil   agriculturalsoil
    ## 35    agriculturalsoil   agriculturalsoil
    ## 36    agriculturalsoil   agriculturalsoil
    ## 37    agriculturalsoil   agriculturalsoil
    ## 38    agriculturalsoil   agriculturalsoil
    ## 39    agriculturalsoil   agriculturalsoil
    ## 40    agriculturalsoil   agriculturalsoil
    ## 41         naturalsoil        naturalsoil
    ## 42         naturalsoil        naturalsoil
    ## 43         naturalsoil        naturalsoil
    ## 44         naturalsoil        naturalsoil
    ## 45         naturalsoil        naturalsoil
    ## 46         naturalsoil        naturalsoil
    ## 47         naturalsoil        naturalsoil
    ## 48         naturalsoil        naturalsoil
    ## 49         naturalsoil        naturalsoil
    ## 50         naturalsoil        naturalsoil
    ## 51           othersoil          othersoil
    ## 52           othersoil          othersoil
    ## 53           othersoil          othersoil
    ## 54           othersoil          othersoil
    ## 55           othersoil          othersoil
    ## 56           othersoil          othersoil
    ## 57           othersoil          othersoil
    ## 58           othersoil          othersoil
    ## 59           othersoil          othersoil
    ## 60           othersoil          othersoil
    ## 61           deepocean          deepocean
    ## 62           deepocean          deepocean
    ## 63           deepocean          deepocean
    ## 64           deepocean          deepocean
    ## 65           deepocean          deepocean
    ## 66           deepocean          deepocean
    ## 67           deepocean          deepocean
    ## 68           deepocean          deepocean
    ## 69           deepocean          deepocean
    ## 70           deepocean          deepocean
    ## 71                lake               lake
    ## 72                lake               lake
    ## 73                lake               lake
    ## 74                lake               lake
    ## 75                lake               lake
    ## 76                lake               lake
    ## 77                lake               lake
    ## 78                lake               lake
    ## 79                lake               lake
    ## 80                lake               lake
    ## 81               river              river
    ## 82               river              river
    ## 83               river              river
    ## 84               river              river
    ## 85               river              river
    ## 86               river              river
    ## 87               river              river
    ## 88               river              river
    ## 89               river              river
    ## 90               river              river
    ## 91                 sea                sea
    ## 92                 sea                sea
    ## 93                 sea                sea
    ## 94                 sea                sea
    ## 95                 sea                sea
    ## 96                 sea                sea
    ## 97                 sea                sea
    ## 98                 sea                sea
    ## 99                 sea                sea
    ## 100                sea                sea

``` r
testProc <- World$NewProcess("k_HeteroAgglomeration.wsd")

# debugonce(testProc$execute)
testProc$execute()
```

    ## Warning in private$Execute(debugAt): input data ignored; not all RadCOL in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all RadCP in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all RhoCOL in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all RhoCP in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all rhoMatrix in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all to.FRACs in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all Matrix in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all to.SpeciesName
    ## in FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all SubCompartName
    ## in FromDataAndTo

    ##                       process fromSpecies toSpecies   fromScale     toScale
    ## 2   k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 3   k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 4   k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 6   k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 7   k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 8   k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 10  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 12  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 13  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 14  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 16  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 17  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 18  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 20  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 21  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 22  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 23  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 24  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 25  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 26  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 27  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 28  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 29  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 30  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 32  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 33  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 34  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 36  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 37  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 38  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 40  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 41  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 42  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 43  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 44  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 45  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 46  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 47  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 48  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 49  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 50  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 52  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 53  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 54  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 56  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 57  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 58  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 60  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 61  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 62  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 65  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 66  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 69  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 70  k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ## 73  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 74  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 77  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 78  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 83  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 84  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 87  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 88  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 91  k_HeteroAgglomeration.wsd       Solid     Large      Arctic      Arctic
    ## 92  k_HeteroAgglomeration.wsd       Solid     Small      Arctic      Arctic
    ## 93  k_HeteroAgglomeration.wsd       Solid     Large Continental Continental
    ## 94  k_HeteroAgglomeration.wsd       Solid     Small Continental Continental
    ## 95  k_HeteroAgglomeration.wsd       Solid     Large    Moderate    Moderate
    ## 96  k_HeteroAgglomeration.wsd       Solid     Small    Moderate    Moderate
    ## 97  k_HeteroAgglomeration.wsd       Solid     Large    Regional    Regional
    ## 98  k_HeteroAgglomeration.wsd       Solid     Small    Regional    Regional
    ## 99  k_HeteroAgglomeration.wsd       Solid     Large      Tropic      Tropic
    ## 100 k_HeteroAgglomeration.wsd       Solid     Small      Tropic      Tropic
    ##         fromSubCompart       toSubCompart            k
    ## 2   freshwatersediment freshwatersediment 1.040145e+02
    ## 3   freshwatersediment freshwatersediment 6.869643e-03
    ## 4   freshwatersediment freshwatersediment 1.127149e+02
    ## 6   freshwatersediment freshwatersediment 1.127149e+02
    ## 7   freshwatersediment freshwatersediment 6.869643e-03
    ## 8   freshwatersediment freshwatersediment 1.127149e+02
    ## 10  freshwatersediment freshwatersediment 1.178561e+02
    ## 12        lakesediment       lakesediment 4.844887e+01
    ## 13        lakesediment       lakesediment 6.869643e-03
    ## 14        lakesediment       lakesediment 5.250143e+01
    ## 16        lakesediment       lakesediment 5.250143e+01
    ## 17        lakesediment       lakesediment 6.869643e-03
    ## 18        lakesediment       lakesediment 5.250143e+01
    ## 20        lakesediment       lakesediment 5.489613e+01
    ## 21      marinesediment     marinesediment 7.237648e-03
    ## 22      marinesediment     marinesediment 2.737224e+02
    ## 23      marinesediment     marinesediment 7.632937e-03
    ## 24      marinesediment     marinesediment 2.966183e+02
    ## 25      marinesediment     marinesediment 7.632937e-03
    ## 26      marinesediment     marinesediment 2.966183e+02
    ## 27      marinesediment     marinesediment 7.632937e-03
    ## 28      marinesediment     marinesediment 2.966183e+02
    ## 29      marinesediment     marinesediment 7.861661e-03
    ## 30      marinesediment     marinesediment 3.101476e+02
    ## 32    agriculturalsoil   agriculturalsoil 1.368612e+01
    ## 33    agriculturalsoil   agriculturalsoil 4.493616e-03
    ## 34    agriculturalsoil   agriculturalsoil 1.483091e+01
    ## 36    agriculturalsoil   agriculturalsoil 1.483091e+01
    ## 37    agriculturalsoil   agriculturalsoil 4.493616e-03
    ## 38    agriculturalsoil   agriculturalsoil 1.483091e+01
    ## 40    agriculturalsoil   agriculturalsoil 1.550738e+01
    ## 41         naturalsoil        naturalsoil 6.817429e-03
    ## 42         naturalsoil        naturalsoil 2.189779e+01
    ## 43         naturalsoil        naturalsoil 7.189786e-03
    ## 44         naturalsoil        naturalsoil 2.372946e+01
    ## 45         naturalsoil        naturalsoil 7.189786e-03
    ## 46         naturalsoil        naturalsoil 2.372946e+01
    ## 47         naturalsoil        naturalsoil 7.189786e-03
    ## 48         naturalsoil        naturalsoil 2.372946e+01
    ## 49         naturalsoil        naturalsoil 7.405241e-03
    ## 50         naturalsoil        naturalsoil 2.481181e+01
    ## 52           othersoil          othersoil 1.231751e+01
    ## 53           othersoil          othersoil 4.044255e-03
    ## 54           othersoil          othersoil 1.334782e+01
    ## 56           othersoil          othersoil 1.334782e+01
    ## 57           othersoil          othersoil 4.044255e-03
    ## 58           othersoil          othersoil 1.334782e+01
    ## 60           othersoil          othersoil 1.395664e+01
    ## 61           deepocean          deepocean 4.686613e-05
    ## 62           deepocean          deepocean 2.738980e+00
    ## 65           deepocean          deepocean 4.901753e-05
    ## 66           deepocean          deepocean 2.967939e+00
    ## 69           deepocean          deepocean 5.028882e-05
    ## 70           deepocean          deepocean 3.103232e+00
    ## 73                lake               lake 3.893333e-06
    ## 74                lake               lake 5.250454e-01
    ## 77                lake               lake 3.893333e-06
    ## 78                lake               lake 5.250454e-01
    ## 83               river              river 2.878207e-04
    ## 84               river              river 1.133822e+00
    ## 87               river              river 2.878207e-04
    ## 88               river              river 1.133822e+00
    ## 91                 sea                sea 4.686613e-05
    ## 92                 sea                sea 2.738980e+00
    ## 93                 sea                sea 4.901753e-05
    ## 94                 sea                sea 2.967939e+00
    ## 95                 sea                sea 4.901753e-05
    ## 96                 sea                sea 2.967939e+00
    ## 97                 sea                sea 4.901753e-05
    ## 98                 sea                sea 2.967939e+00
    ## 99                 sea                sea 5.028882e-05
    ## 100                sea                sea 3.103232e+00

``` r
# testProc$execute(debugAt = list(to.SpeciesName = "Aggregated", Matrix = "water"))
# testProc$execute(debugAt = list(assembly = ""))

# debugonce(k_HeteroAgglomeration.wsd)


# debug(testProc$execute())
```

### air

Heteroagglomeration for attached species in soil and sediment is also
included in k_HeteroAgglomeration.wsd. However, heteroagglomeration in
air is calculated seperately using k_HeteroAgglomeration.a.

Testing is done below:

``` r
World$fetchData("NumConcNuc")
```

    ##         Scale NumConcNuc
    ## 1      Arctic    3.2e+09
    ## 2 Continental    3.2e+09
    ## 3    Moderate    3.2e+09
    ## 4    Regional    3.2e+09
    ## 5      Tropic    3.2e+09

``` r
World$fetchData("NumConcAcc")
```

    ##         Scale NumConcAcc
    ## 1      Arctic    2.9e+09
    ## 2 Continental    2.9e+09
    ## 3    Moderate    2.9e+09
    ## 4    Regional    2.9e+09
    ## 5      Tropic    2.9e+09

``` r
World$fetchData("NumConcCP") 
```

    ##         Scale NumConcCP
    ## 1      Arctic     3e+05
    ## 2 Continental     3e+05
    ## 3    Moderate     3e+05
    ## 4    Regional     3e+05
    ## 5      Tropic     3e+05

``` r
World$fetchData("RadNuc") 
```

    ## [1] 1e-08

``` r
World$fetchData("RadCOL") 
```

    ##            SubCompart  RadCOL
    ## 1                 air 5.8e-08
    ## 3  freshwatersediment 1.5e-07
    ## 4        lakesediment 1.5e-07
    ## 5      marinesediment 1.5e-07
    ## 6    agriculturalsoil 1.5e-07
    ## 7         naturalsoil 1.5e-07
    ## 8           othersoil 1.5e-07
    ## 9           deepocean 1.5e-07
    ## 10               lake 1.5e-07
    ## 11              river 1.5e-07
    ## 12                sea 1.5e-07

``` r
World$fetchData("RadCP") 
```

    ##            SubCompart    RadCP
    ## 1                 air 9.00e-07
    ## 3  freshwatersediment 1.28e-04
    ## 4        lakesediment 1.28e-04
    ## 5      marinesediment 1.28e-04
    ## 6    agriculturalsoil 1.28e-04
    ## 7         naturalsoil 1.28e-04
    ## 8           othersoil 1.28e-04
    ## 9           deepocean 3.00e-06
    ## 10               lake 3.00e-06
    ## 11              river 3.00e-06
    ## 12                sea 3.00e-06

``` r
World$FromDataAndTo("k_HeteroAgglomeration.a")
```

    ##                    process fromSpecies toSpecies   fromScale     toScale
    ## 1  k_HeteroAgglomeration.a       Solid     Large      Arctic      Arctic
    ## 2  k_HeteroAgglomeration.a       Solid     Small      Arctic      Arctic
    ## 3  k_HeteroAgglomeration.a       Solid     Large Continental Continental
    ## 4  k_HeteroAgglomeration.a       Solid     Small Continental Continental
    ## 5  k_HeteroAgglomeration.a       Solid     Large    Moderate    Moderate
    ## 6  k_HeteroAgglomeration.a       Solid     Small    Moderate    Moderate
    ## 7  k_HeteroAgglomeration.a       Solid     Large    Regional    Regional
    ## 8  k_HeteroAgglomeration.a       Solid     Small    Regional    Regional
    ## 9  k_HeteroAgglomeration.a       Solid     Large      Tropic      Tropic
    ## 10 k_HeteroAgglomeration.a       Solid     Small      Tropic      Tropic
    ##    fromSubCompart toSubCompart
    ## 1             air          air
    ## 2             air          air
    ## 3             air          air
    ## 4             air          air
    ## 5             air          air
    ## 6             air          air
    ## 7             air          air
    ## 8             air          air
    ## 9             air          air
    ## 10            air          air

``` r
testProc <- World$NewProcess("k_HeteroAgglomeration.a")

# debugonce(testProc$execute)
testProc$execute()
```

    ## Warning in private$Execute(debugAt): input data ignored; not all rad_species in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all RadCOL in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all RadCP in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all rho_species in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all RhoCOL in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all RhoCP in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all Matrix in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all to.SpeciesName
    ## in FromDataAndTo

    ##                    process fromSpecies toSpecies   fromScale     toScale
    ## 1  k_HeteroAgglomeration.a       Solid     Large      Arctic      Arctic
    ## 2  k_HeteroAgglomeration.a       Solid     Small      Arctic      Arctic
    ## 3  k_HeteroAgglomeration.a       Solid     Large Continental Continental
    ## 4  k_HeteroAgglomeration.a       Solid     Small Continental Continental
    ## 5  k_HeteroAgglomeration.a       Solid     Large    Moderate    Moderate
    ## 6  k_HeteroAgglomeration.a       Solid     Small    Moderate    Moderate
    ## 7  k_HeteroAgglomeration.a       Solid     Large    Regional    Regional
    ## 8  k_HeteroAgglomeration.a       Solid     Small    Regional    Regional
    ## 9  k_HeteroAgglomeration.a       Solid     Large      Tropic      Tropic
    ## 10 k_HeteroAgglomeration.a       Solid     Small      Tropic      Tropic
    ##    fromSubCompart toSubCompart            k
    ## 1             air          air 2.971614e-19
    ## 2             air          air 2.880987e-16
    ## 3             air          air 3.220190e-19
    ## 4             air          air 3.121982e-16
    ## 5             air          air 3.220190e-19
    ## 6             air          air 3.121982e-16
    ## 7             air          air 3.220190e-19
    ## 8             air          air 3.121982e-16
    ## 9             air          air 3.367076e-19
    ## 10            air          air 3.264388e-16

\[TO DO\* rework input of Aerosol concentrations into mass
concentrations instead of number concentrations as they are now for COL
and SUSP, and consider Nucc concentrations in CONSTANTS just like their
Rad and Rho properties\]

Potentially we can integrate air also in one algorithm, alhough it will
be a big one…

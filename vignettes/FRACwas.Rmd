---
title: "Fractions of matrices in subcompartments"
author: "JS"
date: "`r Sys.Date()`"
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::knit_meta()
knitr::opts_chunk$set(echo = TRUE)
projectRoot <- paste(getwd(), "..", sep = "/")
knitr::opts_knit$set(root.dir = projectRoot) #assuming vignette is in a direct subfolder of the project
```

## Matrix parts of a sub-compartment
A Subcompartment has a main matrix(medium); for soils and sediment this is "solids". But both also contain water, and soil also contains a fraction of air, as wel as water. These matrices play a part in the exchange of substances. The fraction of the non-main matrices are in the data, named subFRACw, subFRACa, and subFRACs. The main fraction of the subcompartment is calculated as the remainder. All fractions are are determined by three variable defining functions. For example for soils and sediments:

```{r}
source("baseScripts/initTestWorld.R")
source("newAlgorithmScripts/v_FRACa.R")
source("newAlgorithmScripts/v_FRACw.R")
source("newAlgorithmScripts/v_FRACs.R")
FRACs
```

## Use FRAC's for 
This generalisation is extended to the solids and water fractions in air, formerly known as FRears and FRearw. Note that the fraction of air in air may appear as rounded to, but not equal to 1.0.
```{r}
Fs <- World$NewCalcVariable("FRACs")
World$CalcVar("FRACs")
source("newAlgorithmScripts/v_FRACa.R")
World$NewCalcVariable("FRACa")
World$fetchData("FRACa")
World$fetchData("FRACw")

```
An overview for the scale Regional
```{r}
allFrac <- full_join(as.tibble(World$fetchData("FRACa")),
                     as.tibble(World$fetchData("FRACw")), by = c("SubCompart","Scale")) |> 
  full_join(as.tibble(World$fetchData("FRACs"))) |> filter(Scale=="Regional") |> print()

```
## colloidal and suspended matter in waters
For solids in water SB distinguishes colloidal and suspended matter. Therefore subFRACs for waters is not in the data; use the data for "COL" and "SUSP" for these quantities. These quantities are not used to calculate a "FRACw" for waters.
```{r}
World$fetchData("COL")
World$fetchData("SUSP")
```


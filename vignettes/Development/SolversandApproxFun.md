Solvers and Approxfun
================
Valerie de Rijk
2024-08-21

# Different ways of solving

SimpleBox offers various solving techniques tailored to different
scenarios, currently categorized into two core types:

1)  Steady-State
2)  Dynamic

Each strategy provides unique possibilities for solving problems. In
this vignette, we will explore the use of these techniques and highlight
the differences between them.

## Steady State Solving

We will first demonstrate solving the system assuming steady state. This
means we will obtain one output: the assumed equilibrium mass in each
compartment. We first initialize the world, in this case for a molecular
substance, after which we will creaty dummy input emission data.

``` r
Potential_substances <- c("1-aminoanthraquinone", # no class
                          "1-HYDROXYANTHRAQUINONE", # acid
                          "1-Hexadecanamine, N,N-dimethyl-", # base
                          "1-Chloro-2-nitro-propane", # neutral
                          "Sb(III)" # metal
                          ) 
              
substance <- Potential_substances[3]

source("baseScripts/initWorld_onlyMolec.R")

World$substance <- substance
```

For Steady State solving the emissions need to be provided in a
dataframe consisting of two columns (**Abr** (for abbreviation of the
compartment) and **Emis** (the *constant* emission to the compartment)).
This dataframe cannot be time-dependent, as this goes against the
principles for solving steady state. We will now create our dummy data.

The emissions are assumed to be going into the model as kg/s. In theory,
you can choose any mass/s (like tonnes or mol) unit; what you put in is
what you get out, as long as you are careful with unit conversions.
However, since the rate constants within the model are within seconds,
you should always adhere to the time unit of seconds.

``` r
emissions <- data.frame(Abbr = c("aRU", "s2RU", "w1RU"), Emis = c(10, 10, 10) ) 
```

We provide two steady-state solvers: SB1Solve and SBsteady.

SB1Solve solves using base-R’s
[solve](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/solve)
which solves our matrix through solving the equation a %\*% x = b for x,
where b is our matrix and we assume x = 0.

SBsteady takes a different approach and runs the system of first-order
kinetics at the rates determined by the matrix of rate constants using
rootSolve’s
[runsteady](https://www.rdocumentation.org/packages/rootSolve/versions/1.8.2.4/topics/runsteady).
The function runs the simulation until the system reaches a steady
state, where the amounts in each compartment no longer change over time.

For non-extreme parameter values, we assume that these outputs are
relatively similar, as can be seen below.

We initialize and solve for the two solvers in the following way:

``` r
World$NewSolver("SB1Solve")
SB1Solve_output <- World$Solve(emissions)
```

    ## Warning in private$solver$PrepKaasM(): 12 k values equal to 0; removed for
    ## solver

``` r
World$NewSolver("SBsteady")
SBsteady_output <- World$Solve(emissions)
```

    ## Warning in private$solver$PrepKaasM(): 12 k values equal to 0; removed for
    ## solver

``` r
# Rename columns
SB1Solve_output <- SB1Solve_output |>
  rename(Eqmass_SB1Solve = EqMass)

SBsteady_output <- SBsteady_output |>
  rename(Eqmass_SBsteady = y)

SB1Solve_output <- SB1Solve_output |>
  mutate(Eqmass_SBsteady = SBsteady_output$Eqmass_SBsteady) 

knitr::kable(SB1Solve_output)
```

|     | Abbr  | Scale       | SubCompart         | Species | Eqmass_SB1Solve | Eqmass_SBsteady |
|:----|:------|:------------|:-------------------|:--------|----------------:|----------------:|
| 196 | aRU   | Regional    | air                | Unbound |    2.308353e+05 |    2.308353e+05 |
| 234 | w1RU  | Regional    | river              | Unbound |    5.145173e+06 |    5.145173e+06 |
| 226 | w0RU  | Regional    | lake               | Unbound |    7.295933e+04 |    7.295933e+04 |
| 210 | w2RU  | Regional    | sea                | Unbound |    1.733837e+05 |    1.733837e+05 |
| 213 | sd1RU | Regional    | freshwatersediment | Unbound |    4.958499e+08 |    4.958499e+08 |
| 223 | sd0RU | Regional    | lakesediment       | Unbound |    4.601130e+05 |    4.601130e+05 |
| 183 | sd2RU | Regional    | marinesediment     | Unbound |    8.375062e+06 |    8.375062e+06 |
| 217 | s1RU  | Regional    | naturalsoil        | Unbound |    7.371362e+06 |    7.371362e+06 |
| 182 | s2RU  | Regional    | agriculturalsoil   | Unbound |    1.210563e+08 |    1.210563e+08 |
| 207 | s3RU  | Regional    | othersoil          | Unbound |    1.054481e+06 |    1.054481e+06 |
| 204 | aCU   | Continental | air                | Unbound |    2.998461e+04 |    2.998461e+04 |
| 208 | w1CU  | Continental | river              | Unbound |    1.897770e+03 |    1.897770e+03 |
| 221 | w0CU  | Continental | lake               | Unbound |    2.303486e+03 |    2.303486e+03 |
| 220 | w2CU  | Continental | sea                | Unbound |    3.027279e+06 |    3.027279e+06 |
| 195 | sd1CU | Continental | freshwatersediment | Unbound |    1.828916e+05 |    1.828916e+05 |
| 192 | sd0CU | Continental | lakesediment       | Unbound |    1.454002e+04 |    1.454002e+04 |
| 197 | sd2CU | Continental | marinesediment     | Unbound |    7.311427e+06 |    7.311427e+06 |
| 235 | s1CU  | Continental | naturalsoil        | Unbound |    4.513088e+05 |    4.513088e+05 |
| 187 | s2CU  | Continental | agriculturalsoil   | Unbound |    6.255455e+05 |    6.255455e+05 |
| 233 | s3CU  | Continental | othersoil          | Unbound |    6.431937e+04 |    6.431937e+04 |
| 211 | aAU   | Arctic      | air                | Unbound |    1.441034e+01 |    1.441026e+01 |
| 215 | w2AU  | Arctic      | sea                | Unbound |    6.701284e+04 |    6.701233e+04 |
| 203 | w3AU  | Arctic      | deepocean          | Unbound |    8.450758e+05 |    8.450601e+05 |
| 219 | sd2AU | Arctic      | marinesediment     | Unbound |    1.843849e+05 |    1.843787e+05 |
| 214 | s1AU  | Arctic      | naturalsoil        | Unbound |    4.064755e+03 |    4.064640e+03 |
| 224 | aMU   | Moderate    | air                | Unbound |    6.487956e+02 |    6.487956e+02 |
| 225 | w2MU  | Moderate    | sea                | Unbound |    3.033558e+05 |    3.033558e+05 |
| 231 | w3MU  | Moderate    | deepocean          | Unbound |    1.357311e+06 |    1.357311e+06 |
| 206 | sd2MU | Moderate    | marinesediment     | Unbound |    2.185435e+05 |    2.185433e+05 |
| 188 | s1MU  | Moderate    | naturalsoil        | Unbound |    3.731115e+04 |    3.731115e+04 |
| 227 | aTU   | Tropic      | air                | Unbound |    5.465696e+00 |    5.465696e+00 |
| 193 | w2TU  | Tropic      | sea                | Unbound |    3.522227e+02 |    3.522225e+02 |
| 201 | w3TU  | Tropic      | deepocean          | Unbound |    1.490192e+04 |    1.490191e+04 |
| 228 | sd2TU | Tropic      | marinesediment     | Unbound |    1.610563e+03 |    1.610562e+03 |
| 202 | s1TU  | Tropic      | naturalsoil        | Unbound |    5.839513e+01 |    5.839513e+01 |

## Dynamic solving

Multiple ways exist to solve the system dynamically. This means that, in
addition to emission data per compartment, you have emission data per
compartment and time. There’s two main differences of solving this kind
of input data:

1)  Event-solving: With this type of solver you assume all the emission
    is emitted at once (per year or given timestep), effectively
    creating multiple point emissions

2)  Approximation functions: This type of solver assumes continuous
    emissions, based on interpolation between data-points. This is
    deemed more realistic and recommended for normal use. You can choose
    to provide the emissions as a dataframe with time or to create these
    functions yourself.

Examples of both solvers are given in the following chunks:

### Dynamic Event Solving

For this solver, it is important you do not divide the provided
emissions per second (as it is only injected at one point in time).
However, you should take care that the time-datapoints are expected in
seconds. So, if your emission is assumed to be at 1 year, this should be
timestep 1\* 365.25 \* 24 \* 60 \*60. The required format of the
dataframe is three columns:Abbr (for compartments), Emis (for emission
pulse) and Timed (for timepoints). In the example below we have three
emission points (100 tonnes in aRs at year 1, etc.)

We solve the system for 4 years. As you can see, we obtain a dataframe
with the mass per compartment for every timestep.There is only mass in
the compartments as soon as the first emission point is reached.
Unfortunately, a relational solution (such as for steady state), is hard
to obtain here. As such, we use abbrevations of the compartments.

``` r
# Voorbeeld met dataframe
emissions <- data.frame(Abbr = c("aRU", "s2RU", "w1RU"), Emis = c(100, 100, 100), Timed = c(1, 2, 3) ) # convert 1 t/y to si units: kg/s


emissions <- emissions |>
  mutate(Emis = Emis*1000) |>           # Don't divide the emissions by seconds when using this solver!!
  mutate(Timed = (Timed*(365*24*60*60)))

World$NewSolver("EventSolver")

EventSolved  <- World$Solve(emissions, needdebug = F, tmax = 4*365.25*24*3600, nTIMES = 20)
```

    ## Warning in private$solver$PrepKaasM(): 12 k values equal to 0; removed for
    ## solver

    ## Warning in checkevents(events, times, Ynames, dllname): Not all event times
    ## 'events$times' were in output 'times' so they are automatically included.

``` r
knitr::kable(EventSolved)
```

|      time |        aRU |       w1RU |      w0RU |       w2RU |      sd1RU |     sd0RU |     sd2RU |      s1RU |       s2RU |      s3RU |       aCU |      w1CU |      w0CU |      w2CU |     sd1CU |     sd0CU |     sd2CU |      s1CU |      s2CU |       s3CU |       aAU |      w2AU |      w3AU |     sd2AU |      s1AU |       aMU |      w2MU |      w3MU |      sd2MU |     s1MU |       aTU |      w2TU |      w3TU |     sd2TU |      s1TU |
|----------:|-----------:|-----------:|----------:|-----------:|-----------:|----------:|----------:|----------:|-----------:|----------:|----------:|----------:|----------:|----------:|----------:|----------:|----------:|----------:|----------:|-----------:|----------:|----------:|----------:|----------:|----------:|----------:|----------:|----------:|-----------:|---------:|----------:|----------:|----------:|----------:|----------:|
|         0 |  0.0000000 |   0.000000 |  0.000000 |  0.0000000 |     0.0000 |  0.000000 |   0.00000 |    0.0000 |     0.0000 |   0.00000 | 0.0000000 | 0.0000000 | 0.0000000 |   0.00000 |  0.000000 | 0.0000000 |   0.00000 |   0.00000 |   0.00000 |  0.0000000 | 0.0000000 | 0.0000000 |  0.000000 | 0.0000000 | 0.0000000 | 0.0000000 |  0.000000 |  0.000000 |  0.0000000 | 0.000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 |
|   6643705 |  0.0000000 |   0.000000 |  0.000000 |  0.0000000 |     0.0000 |  0.000000 |   0.00000 |    0.0000 |     0.0000 |   0.00000 | 0.0000000 | 0.0000000 | 0.0000000 |   0.00000 |  0.000000 | 0.0000000 |   0.00000 |   0.00000 |   0.00000 |  0.0000000 | 0.0000000 | 0.0000000 |  0.000000 | 0.0000000 | 0.0000000 | 0.0000000 |  0.000000 |  0.000000 |  0.0000000 | 0.000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 |
|  13287411 |  0.0000000 |   0.000000 |  0.000000 |  0.0000000 |     0.0000 |  0.000000 |   0.00000 |    0.0000 |     0.0000 |   0.00000 | 0.0000000 | 0.0000000 | 0.0000000 |   0.00000 |  0.000000 | 0.0000000 |   0.00000 |   0.00000 |   0.00000 |  0.0000000 | 0.0000000 | 0.0000000 |  0.000000 | 0.0000000 | 0.0000000 | 0.0000000 |  0.000000 |  0.000000 |  0.0000000 | 0.000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 |
|  19931116 |  0.0000000 |   0.000000 |  0.000000 |  0.0000000 |     0.0000 |  0.000000 |   0.00000 |    0.0000 |     0.0000 |   0.00000 | 0.0000000 | 0.0000000 | 0.0000000 |   0.00000 |  0.000000 | 0.0000000 |   0.00000 |   0.00000 |   0.00000 |  0.0000000 | 0.0000000 | 0.0000000 |  0.000000 | 0.0000000 | 0.0000000 | 0.0000000 |  0.000000 |  0.000000 |  0.0000000 | 0.000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 |
|  26574821 |  0.0000000 |   0.000000 |  0.000000 |  0.0000000 |     0.0000 |  0.000000 |   0.00000 |    0.0000 |     0.0000 |   0.00000 | 0.0000000 | 0.0000000 | 0.0000000 |   0.00000 |  0.000000 | 0.0000000 |   0.00000 |   0.00000 |   0.00000 |  0.0000000 | 0.0000000 | 0.0000000 |  0.000000 | 0.0000000 | 0.0000000 | 0.0000000 |  0.000000 |  0.000000 |  0.0000000 | 0.000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 |
|  31536000 |  0.0000000 |   0.000000 |  0.000000 |  0.0000000 |     0.0000 |  0.000000 |   0.00000 |    0.0000 |     0.0000 |   0.00000 | 0.0000000 | 0.0000000 | 0.0000000 |   0.00000 |  0.000000 | 0.0000000 |   0.00000 |   0.00000 |   0.00000 |  0.0000000 | 0.0000000 | 0.0000000 |  0.000000 | 0.0000000 | 0.0000000 | 0.0000000 |  0.000000 |  0.000000 |  0.0000000 | 0.000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 | 0.0000000 |
|  33218526 |  3.6232022 |   2.552264 | 16.353551 |  0.4798473 |   208.7390 |  4.299361 |  17.88478 | 2198.9476 |  4180.0604 | 634.59858 | 0.7524627 | 0.1566343 | 0.9722568 | 425.45862 | 12.369402 | 0.2527702 |  53.98312 | 130.62101 | 247.48569 | 37.6069434 | 0.0002904 | 0.9985768 |  0.220012 | 0.0005785 | 0.0533618 | 0.0229957 | 24.077494 |  7.070667 |  0.0233808 | 9.263770 | 0.0002273 | 0.0478887 | 0.0278307 | 0.0001060 | 0.0322861 |
|  39862232 |  1.9581140 |   2.066252 |  5.946836 |  0.1646065 |   211.4673 | 12.238509 |  16.40538 | 1474.4862 |  2347.4045 | 247.39649 | 0.3997560 | 0.1264763 | 0.3601219 | 167.94748 | 12.652224 | 0.7291296 | 158.48204 |  88.67296 | 140.94182 | 14.9329213 | 0.0005745 | 3.0870019 |  4.286599 | 0.0596064 | 0.0599551 | 0.0150531 | 21.387033 | 40.078914 |  0.7475676 | 6.469559 | 0.0001348 | 0.0078902 | 0.1912386 | 0.0029074 | 0.0115989 |
|  46505937 |  1.0879829 |   1.745345 |  2.832628 |  0.1381604 |   203.3655 | 14.058960 |  14.80910 |  985.1642 |  1317.5385 |  97.60607 | 0.2207838 | 0.1067021 | 0.1743598 |  77.30762 | 12.234519 | 0.8427688 | 178.71500 |  59.81180 |  80.12639 |  6.0320842 | 0.0004039 | 2.2493277 |  8.107635 | 0.2367419 | 0.0659066 | 0.0082961 | 10.965850 | 47.983548 |  1.9044988 | 4.471652 | 0.0000736 | 0.0072485 | 0.3600430 | 0.0098652 | 0.0044066 |
|  53149642 |  0.6187382 |   1.502961 |  1.718883 |  0.1186411 |   190.1666 | 14.016162 |  13.30122 |  656.5493 |   739.5316 |  39.18277 | 0.1259916 | 0.0918199 | 0.1066712 |  43.56693 | 11.481156 | 0.8438325 | 171.67753 |  40.17257 |  45.53366 |  2.4971655 | 0.0002564 | 1.4399177 |  9.840606 | 0.4685184 | 0.0677702 | 0.0048311 |  6.156689 | 43.578205 |  2.8700373 | 3.062776 | 0.0000435 | 0.0087483 | 0.4342193 | 0.0183413 | 0.0018046 |
|  59793347 |  0.3591222 |   1.309646 |  1.219114 |  0.1032821 |   174.9023 | 13.342034 |  11.91135 |  436.7299 |   415.3143 |  16.12088 | 0.0740067 | 0.0799794 | 0.0757647 |  29.64991 | 10.585739 | 0.8057090 | 156.66769 |  26.90285 |  25.89237 |  1.0694045 | 0.0001794 | 1.0172321 | 10.344415 | 0.6993204 | 0.0671974 | 0.0030352 |  4.062051 | 36.399714 |  3.4904916 | 2.087919 | 0.0000281 | 0.0090069 | 0.4307167 | 0.0255220 | 0.0008224 |
|  63072000 |  0.2764963 |   1.227209 |  1.065628 |  0.0967714 |   167.1422 | 12.913912 |  11.27178 |  356.9463 |   312.5070 |  10.52330 | 0.0574946 | 0.0749369 | 0.0661866 |  25.79999 | 10.125791 | 0.7807742 | 148.53939 |  22.05563 |  19.60741 |  0.7148717 | 0.0001571 | 0.8962874 | 10.365662 | 0.8046548 | 0.0664513 | 0.0024743 |  3.474912 | 32.941639 |  3.6786911 | 1.726890 | 0.0000232 | 0.0087497 | 0.4126289 | 0.0281638 | 0.0005853 |
|  66437053 | 41.9228228 |  10.878047 | 12.790947 |  0.7763002 |   304.2746 | 15.611451 |  13.63610 |  583.4978 | 74598.8989 |  91.57230 | 5.3233564 | 0.1804274 | 0.1881778 |  79.96598 | 11.226616 | 0.7869688 | 147.53532 |  35.34272 |  47.62036 |  5.4770473 | 0.0007372 | 0.9495583 | 10.344667 | 0.9051795 | 0.0725999 | 0.1007727 |  6.100074 | 30.735506 |  3.8089532 | 2.648353 | 0.0008350 | 0.0148271 | 0.3923125 | 0.0302212 | 0.0046872 |
|  73080758 | 23.5585317 |   8.155336 | 15.230868 |  0.5371318 |   468.3251 | 26.527649 |  16.67333 |  725.2661 | 41577.1537 | 121.03603 | 3.0337438 | 0.1529181 | 0.2227363 |  99.15525 | 12.527263 | 0.8674156 | 162.14860 |  43.82608 |  63.40036 |  7.2626207 | 0.0005754 | 1.4419375 | 10.833425 | 1.0886765 | 0.0807449 | 0.0596188 |  9.674279 | 32.731340 |  4.0249509 | 3.257541 | 0.0004979 | 0.0135180 | 0.3719218 | 0.0328851 | 0.0060126 |
|  79724463 | 13.2387224 |   6.394433 | 11.342776 |  0.3926067 |   529.5460 | 34.332979 |  17.61322 |  668.7814 | 23175.5626 |  94.33765 | 1.7275991 | 0.1303146 | 0.1829278 |  81.94595 | 12.809310 | 0.9244119 | 172.30394 |  40.54038 |  56.02908 |  5.7041743 | 0.0004585 | 1.5985610 | 11.843986 | 1.2714893 | 0.0855588 | 0.0352385 |  9.019334 | 35.531178 |  4.2881038 | 3.038473 | 0.0002960 | 0.0112173 | 0.3785054 | 0.0347604 | 0.0046113 |
|  86368168 |  7.4451357 |   5.203647 |  7.783138 |  0.3024740 |   535.8140 | 37.740559 |  17.42860 |  547.5794 | 12919.9593 |  62.98121 | 0.9845710 | 0.1119734 | 0.1399014 |  61.92787 | 12.475609 | 0.9362324 | 172.31149 |  33.33225 |  42.84905 |  3.8422138 | 0.0003542 | 1.4657996 | 12.695371 | 1.4580977 | 0.0876734 | 0.0208692 |  7.219321 | 35.474168 |  4.5441266 | 2.527910 | 0.0001765 | 0.0099017 | 0.3869194 | 0.0364277 | 0.0030752 |
|  93011874 |  4.1934193 |   4.356766 |  5.367761 |  0.2437985 |   513.9454 | 38.145435 |  16.66527 |  420.7131 |  7203.6795 |  39.18696 | 0.5623902 | 0.0970053 | 0.1065209 |  46.36224 | 11.796254 | 0.9136546 | 164.78152 |  25.72391 |  30.42108 |  2.4144941 | 0.0002731 | 1.2610842 | 13.135550 | 1.6386658 | 0.0876777 | 0.0124609 |  5.564969 | 33.050179 |  4.7167692 | 1.977072 | 0.0001063 | 0.0090055 | 0.3809197 | 0.0377207 | 0.0019429 |
|  94608000 |  3.6544050 |   4.188638 |  4.933075 |  0.2327985 |   506.3257 | 37.949243 |  16.43296 |  392.3613 |  6260.5554 |  34.74337 | 0.4918496 | 0.0938213 | 0.0999898 |  43.35367 | 11.602421 | 0.9046320 | 162.23709 |  24.01650 |  27.81056 |  2.1461862 | 0.0002573 | 1.2133916 | 13.181591 | 1.6798650 | 0.0874399 | 0.0110304 |  5.226731 | 32.254126 |  4.7411185 | 1.852146 | 0.0000944 | 0.0088052 | 0.3769664 | 0.0379356 | 0.0017336 |
|  99655579 |  6.7960508 | 525.916167 |  5.243553 | 16.4791096 | 79114.2691 | 38.043878 | 653.91919 |  560.7819 |  4457.9285 |  80.93743 | 0.9617114 | 0.1135617 | 0.1682796 | 448.36725 | 12.659874 | 0.9417294 | 308.01382 |  34.26505 |  47.34956 |  4.9578071 | 0.0007872 | 3.9032918 | 14.750963 | 1.8122605 | 0.0969399 | 0.0296623 | 39.668900 | 55.589263 |  4.9933141 | 2.671093 | 0.0002501 | 0.0117473 | 0.4179756 | 0.0386928 | 0.0043951 |
| 106299284 |  5.2239315 | 468.252679 |  3.722979 | 15.1790163 | 70467.7430 | 36.625081 | 672.99419 |  433.1791 |  2565.2218 |  47.17287 | 0.7283707 | 0.1019397 | 0.1186174 | 286.30476 | 12.020399 | 0.9332781 | 402.35575 |  26.79203 |  33.74785 |  2.9652969 | 0.0009340 | 5.0734750 | 20.639265 | 2.0823087 | 0.1089298 | 0.0229521 | 31.517401 | 87.432716 |  6.2094896 | 2.270826 | 0.0001944 | 0.0132887 | 0.6404315 | 0.0432391 | 0.0029856 |
| 112942989 |  4.1911052 | 416.943783 |  2.913651 | 13.9598119 | 62762.0859 | 34.455496 | 678.14144 |  335.5137 |  1500.9992 |  30.88893 | 0.5813354 | 0.0921105 | 0.0948840 | 223.77974 | 11.275261 | 0.8968521 | 437.31776 |  20.93703 |  24.57282 |  1.9728186 | 0.0007991 | 4.3943512 | 25.491301 | 2.4780586 | 0.1190365 | 0.0180542 | 24.161052 | 96.788731 |  7.7539800 | 1.889247 | 0.0001547 | 0.0170896 | 0.8466381 | 0.0527880 | 0.0021845 |
| 119586695 |  3.4749476 | 371.274899 |  2.410503 | 12.8184865 | 55896.6896 | 32.038033 | 672.45624 |  262.0097 |   899.7763 |  22.35390 | 0.4816645 | 0.0835428 | 0.0804491 | 194.89250 | 10.492962 | 0.8497191 | 448.38862 |  16.47181 |  18.41783 |  1.4407612 | 0.0006967 | 3.8515046 | 28.560661 | 2.9335499 | 0.1257672 | 0.0151078 | 20.549794 | 96.238259 |  9.1247855 | 1.564436 | 0.0001309 | 0.0197184 | 0.9577847 | 0.0641753 | 0.0017140 |
| 126230400 |  2.9505440 | 330.618232 |  2.062429 | 11.7528721 | 49780.9304 | 29.592701 | 658.47536 |  207.0588 |   557.6036 |  17.42787 | 0.4095210 | 0.0759374 | 0.0701887 | 177.62738 |  9.712671 | 0.7986537 | 448.29956 |  13.10434 |  14.25410 |  1.1293497 | 0.0006382 | 3.5520667 | 30.535887 | 3.3996897 | 0.1303571 | 0.0131393 | 18.534528 | 92.425640 | 10.1847702 | 1.304289 | 0.0001148 | 0.0207963 | 0.9931848 | 0.0745787 | 0.0014271 |

### Dynamic Approxfun solving

As mentioned before, this solving strategy creates an approximation
between known datapoints through interpolation. Two options exist here:
providing a dataframe with datapoints (as for event-solving) and
providing the approximation functions itself. We will first show the
latter option.

The chunk below shows how to create an emission function yourself before
using it to solve. A couple of noteworthy points:

- For each compartment, the emission data should contain at least two
  datapoints in order for the function to work.
- All data should be in mass/s (preferably kg/s) in order for it to
  produce wanted results.
- Approximation function rule
  [2](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/approxfun)
  allows extrapolation, in that it will take the most extreme
  (left/right) values and continue this trend in the respective way.
  Rule 1 only allows for interpolation. If you do not want any extending
  of data that does not exist, you should ensure that the datapoints
  exceed the tmax of the system, else the system will not work.
- Other functions are also able to be implemented to the core, but its
  structure should be the same as the ‘funlist’ below.

Once again, we run the model for 4 years. The output is in a quite
similar structure as the Event solving, but also provides columns in
which the emission data is specified. This allows for more convenient
checks on the output that thas been created. Below, we also plot our
approximation function for the hypothetical scenario of 25 years. As the
emission data for the compartment we plot (s2RU) only runs until the 5th
year, you can clearly see the assumed continuation of this last value
for the remaining years.

``` r
emissions <- data.frame(Abbr = c("aRU", "s2RU", "w1RU","aRU", "s2RU", "w1RU"), Emis = c(10, 10, 10,20, 20, 20), Timed = c(1, 2, 3, 4, 5, 6)) # convert 1 t/y to si units: kg/s

emissions <- emissions |>
  mutate(Timed = Timed*(365.25*24*60*60)) |> ungroup()

SBEmissions3 <- 
  emissions |> 
  group_by(Abbr) |> 
  summarise(n=n(),
            EmisFun = list(
              approxfun(
                data.frame(Timed = c(0,Timed), 
                           Emis=c(0,Emis)),
                rule = 2) # Change to rule 1:1 for no extrapolation
            )
  )

funlist <- SBEmissions3$EmisFun
names(funlist) <- SBEmissions3$Abbr

tmax <- 365.25*24*60*60*4
times <- seq(0, tmax, length.out = 10)

World$NewSolver("DynApproxSolve")
DynApproxSolved <- World$Solve(tmax = 4*365.25*24*3600, funlist, needdebug = F, nTIMES = 20 )
```

    ## Warning in private$solver$PrepKaasM(): 12 k values equal to 0; removed for
    ## solver

``` r
# Plot approxfun
times <- seq(0, 25*365.25*24*3600, by=10000)
PlotEmis <- funlist[["s2RU"]]
values <- sapply(times, PlotEmis)

plot(times, values, type = "l", lwd=2)
```

![](SolversandApproxFun_files/figure-gfm/ii%20Approximation%20function-1.png)<!-- -->

``` r
knitr::kable(DynApproxSolved)
```

|      time |       aRU |      w1RU |      w0RU |       w2RU |     sd1RU |       sd0RU |      sd2RU |       s1RU |      s2RU |       s3RU |       aCU |       w1CU |       w0CU |       w2CU |       sd1CU |       sd0CU |       sd2CU |       s1CU |      s2CU |       s3CU |        aAU |       w2AU |         w3AU |        sd2AU |        s1AU |        aMU |       w2MU |        w3MU |        sd2MU |      s1MU |       aTU |       w2TU |        w3TU |       sd2TU |      s1TU |  emis2aRU |  emis2w1RU | emis2w0RU | emis2w2RU | emis2sd1RU | emis2sd0RU | emis2sd2RU | emis2s1RU | emis2s2RU | emis2s3RU | emis2aCU | emis2w1CU | emis2w0CU | emis2w2CU | emis2sd1CU | emis2sd0CU | emis2sd2CU | emis2s1CU | emis2s2CU | emis2s3CU | emis2aAU | emis2w2AU | emis2w3AU | emis2sd2AU | emis2s1AU | emis2aMU | emis2w2MU | emis2w3MU | emis2sd2MU | emis2s1MU | emis2aTU | emis2w2TU | emis2w3TU | emis2sd2TU | emis2s1TU |
|----------:|----------:|----------:|----------:|-----------:|----------:|------------:|-----------:|-----------:|----------:|-----------:|----------:|-----------:|-----------:|-----------:|------------:|------------:|------------:|-----------:|----------:|-----------:|-----------:|-----------:|-------------:|-------------:|------------:|-----------:|-----------:|------------:|-------------:|----------:|----------:|-----------:|------------:|------------:|----------:|----------:|-----------:|----------:|----------:|-----------:|-----------:|-----------:|----------:|----------:|----------:|---------:|----------:|----------:|----------:|-----------:|-----------:|-----------:|----------:|----------:|----------:|---------:|----------:|----------:|-----------:|----------:|---------:|----------:|----------:|-----------:|----------:|---------:|----------:|----------:|-----------:|----------:|
|         0 |      0.00 |       0.0 |     0.000 |      0.000 |         0 |      0.0000 |       0.00 |        0.0 |         0 |       0.00 |     0.000 |    0.00000 |    0.00000 |       0.00 |      0.0000 |     0.00000 |       0.000 |      0.000 |      0.00 |      0.000 |  0.0000000 |     0.0000 |      0.00000 | 0.000000e+00 |    0.000000 |    0.00000 |      0.000 |      0.0000 | 0.000000e+00 |     0.000 | 0.0000000 |   0.000000 |    0.000000 |   0.0000000 |  0.000000 |  0.000000 |  0.0000000 |         0 |         0 |          0 |          0 |          0 |         0 |  0.000000 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|   6643705 |  28254.44 |  138564.8 |  1404.216 |   3486.341 |   1836321 |    426.8027 |   13657.21 |   161689.4 |   3195709 |   45594.96 |  3560.111 |   69.39754 |   69.51729 |   40002.16 |    882.7521 |    21.87133 |    6101.614 |   9569.317 |  17959.63 |   2689.602 |  0.4026165 |   115.3156 |     49.26352 | 2.934427e-01 |    4.039381 |   66.35498 |   2127.736 |    958.5395 | 6.585619e+00 |   677.566 | 0.5457419 |   3.407795 |    3.208655 |   0.0220627 |  2.281042 |  2.105263 |  0.7017544 |         0 |         0 |          0 |          0 |          0 |         0 |  1.052632 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  13287411 |  59370.89 |  305280.6 |  4982.766 |   8031.309 |   7285311 |   3015.2046 |   59878.06 |   595600.0 |  10810845 |  148233.18 |  7519.893 |  167.64954 |  223.33446 |  134251.43 |   3799.3812 |   141.77113 |   41036.606 |  35447.318 |  63609.82 |   8794.993 |  0.9469740 |   783.5685 |    707.55975 | 8.754763e+00 |   17.728557 |  141.97248 |   9412.434 |   8349.2101 | 1.178997e+02 |  2538.460 | 1.1713983 |   9.602259 |   33.967157 |   0.4293274 |  7.352762 |  4.210526 |  1.4035088 |         0 |         0 |          0 |          0 |          0 |         0 |  2.105263 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  19931116 |  92111.99 |  493800.9 |  9977.923 |  13309.736 |  15967381 |   8979.0467 |  139575.02 |  1231559.5 |  20894311 |  278301.62 | 11704.499 |  288.61014 |  421.02446 |  258826.99 |   8845.0420 |   397.95143 |  116694.207 |  73548.406 | 127180.97 |  16571.749 |  1.6168962 |  2048.2170 |   2887.46787 | 5.551093e+01 |   43.223347 |  222.99927 |  20324.014 |  26119.3324 | 5.634674e+02 |  5313.025 | 1.8429593 |  17.527414 |  131.306187 |   2.4158207 | 13.731437 |  6.315790 |  2.1052632 |         0 |         0 |          0 |          0 |          0 |         0 |  3.157895 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  26574821 | 125822.76 |  701683.7 | 15904.400 |  19256.135 |  27536185 |  18843.3311 |  252798.34 |  2013952.1 |  32357683 |  422198.18 | 16024.319 |  429.01980 |  646.42181 |  403678.15 |  15988.6857 |   801.49809 |  236280.715 | 120575.630 | 202203.96 |  25205.934 |  2.3787346 |  3770.9957 |   7223.16874 | 1.895008e+02 |   81.911747 |  307.38037 |  33657.021 |  54912.5586 | 1.590978e+03 |  8771.262 | 2.5431544 |  27.505121 |  323.446462 |   7.8131301 | 20.781947 |  8.421053 |  2.8070175 |         0 |         0 |          0 |          0 |          0 |         0 |  4.210526 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  33218526 | 155921.56 |  926635.6 | 22408.256 |  25775.329 |  41679629 |  32730.8030 |  399034.57 |  2894096.8 |  44580406 |  571277.56 | 19903.403 |  577.96852 |  888.13029 |  562642.21 |  25103.9986 |  1352.01242 |  399476.740 | 173621.284 | 283731.17 |  34177.819 |  3.1545100 |  5851.3910 |  14053.95217 | 4.668167e+02 |  134.336467 |  384.32240 |  48752.562 |  94010.3851 | 3.399814e+03 | 12704.335 | 3.1837759 |  39.555003 |  621.682524 |  18.5120602 | 28.105098 | 10.175439 |  3.5087719 |         0 |         0 |          0 |          0 |          0 |         0 |  5.263158 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  39862232 | 173468.85 | 1166258.5 | 28432.614 |  32690.602 |  58105235 |  50144.5669 |  576342.27 |  3711048.5 |  56983202 |  687798.29 | 22192.111 |  703.56156 | 1089.34685 |  710093.13 |  35278.9882 |  2020.00015 |  599382.106 | 223087.957 | 354875.06 |  41242.278 |  3.7890084 |  8125.2317 |  23486.99007 | 9.426755e+02 |  197.298651 |  431.73228 |  63700.157 | 141367.9558 | 6.119222e+03 | 16424.411 | 3.5803568 |  51.382776 | 1021.903125 |  36.0257994 | 33.832408 | 10.877193 |  4.2105263 |         0 |         0 |          0 |          0 |          0 |         0 |  6.315790 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  46505937 | 191083.96 | 1419311.6 | 34189.323 |  40098.351 |  76557182 |  70201.1404 |  783164.72 |  4440467.4 |  69404769 |  781821.79 | 24478.916 |  830.35049 | 1265.66156 |  851827.36 |  46000.2430 |  2756.60132 |  824836.082 | 267399.650 | 415450.03 |  46964.509 |  4.4223257 | 10402.1264 |  35268.14979 | 1.662771e+03 |  268.890268 |  478.81465 |  77918.342 | 193387.6352 | 9.768877e+03 | 19799.859 | 3.9737795 |  64.383412 | 1503.574868 |  61.1370942 | 38.530385 | 11.578947 |  4.9122807 |         0 |         0 |          0 |          0 |          0 |         0 |  7.368421 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  53149642 | 208775.97 | 1684328.5 | 39934.997 |  47956.689 |  96813104 |  92449.4261 | 1018318.93 |  5113151.6 |  81838127 |  867544.54 | 26770.629 |  958.72873 | 1434.53123 |  995909.34 |  57155.4581 |  3540.34239 | 1071042.171 | 308334.085 | 470244.51 |  52182.305 |  5.0613603 | 12712.5852 |  49076.90627 | 2.657456e+03 |  348.488308 |  525.94131 |  92173.525 | 248252.1292 | 1.428644e+04 | 22946.560 | 4.3676643 |  78.658808 | 2042.977627 |  93.8015893 | 42.892807 | 12.280702 |  5.6140351 |         0 |         0 |          0 |          0 |          0 |         0 |  8.421053 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  59793347 | 226543.72 | 1960001.2 | 45735.051 |  56226.580 | 118675196 | 116617.4657 | 1280487.46 |  5749378.1 |  94279496 |  950344.49 | 29069.835 | 1088.81988 | 1601.33330 | 1144792.35 |  68669.4636 |  4361.23085 | 1336008.586 | 347081.884 | 521926.96 |  57218.075 |  5.7158857 | 15112.5082 |  64736.60541 | 3.945950e+03 |  435.730084 |  573.28173 | 106823.573 | 305485.6638 | 1.959175e+04 | 25945.801 | 4.7634980 |  93.892832 | 2623.941303 | 133.4455731 | 47.158351 | 12.982456 |  6.3157895 |         0 |         0 |          0 |          0 |          0 |         0 |  9.473684 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  66437053 | 244235.47 | 2245135.9 | 51590.190 |  64870.093 | 141967296 | 142497.9271 | 1568263.90 |  6362122.4 | 106461786 | 1032147.73 | 31358.947 | 1220.31870 | 1767.81643 | 1298981.42 |  80487.6397 |  5213.40397 | 1618641.084 | 384414.804 | 571940.05 |  62189.926 |  6.3883974 | 17627.8806 |  82166.47066 | 5.541433e+03 |  530.420003 |  620.55838 | 121978.126 | 365044.2228 | 2.561286e+04 | 28851.752 | 5.1590232 | 109.863588 | 3238.007580 | 179.3181503 | 51.404584 | 13.684211 |  7.0175439 |         0 |         0 |          0 |          0 |          0 |         0 | 10.350877 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  73080758 | 261169.77 | 2538532.2 | 57287.346 |  73842.676 | 166529650 | 169827.6301 | 1880132.11 |  6954193.9 | 117180324 | 1112119.66 | 33552.295 | 1351.29212 | 1932.34586 | 1457350.14 |  92536.2806 |  6091.85791 | 1917901.402 | 420505.600 | 620454.24 |  67051.288 |  7.0700941 | 20261.6964 | 101322.35430 | 7.453676e+03 |  632.285020 |  666.17690 | 137587.265 | 426925.0544 | 3.229036e+04 | 31676.772 | 5.5410527 | 126.353507 | 3881.216932 | 230.6987096 | 55.580548 | 14.385965 |  7.7192982 |         0 |         0 |          0 |          0 |          0 |         0 | 11.052632 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  79724463 | 277599.40 | 2839287.2 | 62725.405 |  83115.722 | 192218637 | 198207.8337 | 2214529.15 |  7525449.1 | 126904838 | 1189562.39 | 35681.205 | 1481.68197 | 2093.84932 | 1618965.46 | 104733.9642 |  6990.66576 | 2232397.620 | 455347.110 | 667361.29 |  71761.240 |  7.7621540 | 23001.4127 | 122157.46250 | 9.689919e+03 |  740.986005 |  710.68352 | 153547.104 | 490986.5746 | 3.957323e+04 | 34419.835 | 5.9139968 | 143.287290 | 4551.166016 | 286.9662944 | 59.649764 | 15.087719 |  8.4210526 |         0 |         0 |          0 |          0 |          0 |         0 | 11.754386 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  86368168 | 293765.60 | 3146616.2 | 67976.104 |  92664.237 | 218908208 | 227302.4851 | 2569947.39 |  8079038.1 | 136076384 | 1265044.84 | 37776.239 | 1611.74490 | 2253.07534 | 1783779.01 | 117027.9693 |  7904.76400 | 2560816.777 | 489126.828 | 712951.37 |  76353.506 |  8.4663640 | 25837.7312 | 144613.36788 | 1.225491e+04 |  856.251748 |  754.63844 | 169830.167 | 557042.9177 | 4.741435e+04 | 37093.515 | 6.2824763 | 160.667297 | 5245.699382 | 347.5941262 | 63.640164 | 15.789474 |  9.1228070 |         0 |         0 |          0 |          0 |          0 |         0 | 12.456140 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  93011874 | 309801.62 | 3459811.6 | 73114.480 | 102464.282 | 246487281 | 256888.7374 | 2944935.81 |  8618982.7 | 144940658 | 1339275.22 | 39854.493 | 1741.65787 | 2410.90461 | 1951864.46 | 129385.7349 |  8830.52801 | 2902094.629 | 522085.245 | 757595.80 |  80870.369 |  9.1840520 | 28767.2744 | 168631.43311 | 1.515105e+04 |  977.863695 |  798.36244 | 186439.029 | 624953.8482 | 5.577021e+04 | 39714.388 | 6.6491484 | 178.486134 | 5962.887732 | 412.1311385 | 67.585214 | 16.491228 |  9.8245614 |         0 |         0 |          0 |          0 |          0 |         0 | 13.157895 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  99655579 | 325780.31 | 3778237.9 | 78191.187 | 112493.357 | 274857595 | 286827.6579 | 3338100.90 |  9148999.8 | 153634496 | 1412792.35 | 41925.414 | 1871.53918 | 2567.99503 | 2123222.54 | 141787.4932 |  9765.48657 | 3255369.848 | 554445.674 | 801616.42 |  85344.243 |  9.9160114 | 31788.4922 | 194158.77473 | 1.837883e+04 | 1105.641899 |  842.03463 | 203375.816 | 694625.1072 | 6.460164e+04 | 42298.059 | 7.0154983 | 196.729234 | 6701.186323 | 480.1917795 | 71.509524 | 17.192982 | 10.5263158 |         0 |         0 |          0 |          0 |          0 |         0 | 13.859649 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
| 106299284 | 341740.85 | 4101326.3 | 83236.686 | 122730.566 | 303932028 | 317033.1280 | 3748109.55 |  9672114.7 | 162234086 | 1485947.00 | 43994.134 | 2001.46613 | 2724.78143 | 2297769.58 | 154221.4490 | 10707.96512 | 3619912.640 | 586390.682 | 845254.54 |  89796.384 | 10.6625172 | 34899.5847 | 221148.10149 | 2.193723e+04 | 1239.430773 |  885.75159 | 220635.515 | 765986.8449 | 7.387409e+04 | 44857.370 | 7.3823265 | 215.380971 | 7459.417122 | 551.4501732 | 75.428595 | 17.894737 | 11.2280702 |         0 |         0 |          0 |          0 |          0 |         0 | 14.561404 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
| 112942989 | 357703.67 | 4428568.7 | 88268.458 | 133156.639 | 333633208 | 347450.6381 | 4173692.22 | 10190625.5 | 170781813 | 1558949.75 | 46063.355 | 2131.48811 | 2881.53506 | 2475363.93 | 166680.6907 | 11656.81228 | 3995071.654 | 618059.453 | 888677.31 |  94239.650 | 11.4234591 | 38098.0499 | 249555.75956 | 2.582407e+04 | 1379.087725 |  929.56255 | 238206.880 | 838976.6724 | 8.355718e+04 | 47402.125 | 7.7500399 | 234.426537 | 8236.649219 | 625.6335524 | 79.351384 | 18.596491 | 11.9298246 |         0 |         0 |          0 |          0 |          0 |         0 | 15.263158 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
| 119586695 | 373678.91 | 4759511.6 | 93296.250 | 143753.895 | 363892360 | 378044.3505 | 4613645.42 | 10706200.6 | 179301237 | 1631919.91 | 48134.428 | 2261.63577 | 3038.41775 | 2655831.84 | 179161.2409 | 12611.21365 | 4380241.735 | 649553.359 | 931994.32 |  98681.377 | 12.1984780 | 41380.7963 | 279339.94932 | 3.003623e+04 | 1524.475600 |  973.48990 | 256074.653 | 913530.7472 | 9.362409e+04 | 49939.431 | 8.1188221 | 253.851626 | 9032.074987 | 702.5138993 | 83.282678 | 19.298246 | 12.6315789 |         0 |         0 |          0 |          0 |          0 |         0 | 15.964912 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
| 126230400 | 389671.03 | 5093750.6 | 98325.345 | 154506.162 | 394648309 | 408789.5002 | 5066833.27 | 11220011.5 | 187805426 | 1704921.30 | 50207.954 | 2391.92712 | 3195.52087 | 2838985.67 | 191660.8422 | 13570.57059 | 4774846.571 | 680943.749 | 975274.21 | 103125.516 | 12.9870688 | 44744.3584 | 310459.54874 | 3.456980e+04 | 1675.458219 | 1017.54105 | 274221.443 | 989580.5529 | 1.040508e+05 | 52474.228 | 8.4887318 | 273.641666 | 9844.922926 | 781.8988166 | 87.224763 | 20.000000 | 13.3333333 |         0 |         0 |          0 |          0 |          0 |         0 | 16.666667 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |

If you, as a user, do not want to create the approximation functions
yourself, the opportunity exists to solely provide a dataframe with
timed emission data. The rest of the solver copies the same behavior as
the one above. This means that extrapolation (taking the most extreme
value and continuing this as a constant emission) is automatically done,
as else the solver will crash. As you can observe, the output is also
the same.

``` r
emissions <- data.frame(Abbr = c("aRU", "s2RU", "w1RU", "aRU", "s2RU", "w1RU"), Emis = c(10, 10, 10,20, 20, 20), Timed = c(1, 2, 3, 4, 5, 6)) # convert 1 t/y to si units: kg/s

emissions <- emissions |>
  mutate(Timed = Timed*(365.25*24*60*60)) |> ungroup()

tmax <- 365.25*24*60*60*10
times <- seq(0, tmax, length.out = 10)
rm(World)
source("baseScripts/initWorld_onlyMolec.R")
```

    ## Joining with `by = join_by(Matrix)`
    ## Joining with `by = join_by(Compartment)`

``` r
World$substance <- substance
World$NewSolver("DynApproxSolve")

DynApproxDFSolved<- World$Solve( emissions = emissions, tmax =4*365.25*24*3600, needdebug = F, nTIMES = 20 )

knitr::kable(DynApproxDFSolved)
```

|      time |       aRU |      w1RU |      w0RU |       w2RU |     sd1RU |       sd0RU |      sd2RU |       s1RU |      s2RU |       s3RU |       aCU |       w1CU |       w0CU |       w2CU |       sd1CU |       sd0CU |       sd2CU |       s1CU |      s2CU |       s3CU |        aAU |       w2AU |         w3AU |        sd2AU |        s1AU |        aMU |       w2MU |        w3MU |        sd2MU |      s1MU |       aTU |       w2TU |        w3TU |       sd2TU |      s1TU |  emis2aRU |  emis2w1RU | emis2w0RU | emis2w2RU | emis2sd1RU | emis2sd0RU | emis2sd2RU | emis2s1RU | emis2s2RU | emis2s3RU | emis2aCU | emis2w1CU | emis2w0CU | emis2w2CU | emis2sd1CU | emis2sd0CU | emis2sd2CU | emis2s1CU | emis2s2CU | emis2s3CU | emis2aAU | emis2w2AU | emis2w3AU | emis2sd2AU | emis2s1AU | emis2aMU | emis2w2MU | emis2w3MU | emis2sd2MU | emis2s1MU | emis2aTU | emis2w2TU | emis2w3TU | emis2sd2TU | emis2s1TU |
|----------:|----------:|----------:|----------:|-----------:|----------:|------------:|-----------:|-----------:|----------:|-----------:|----------:|-----------:|-----------:|-----------:|------------:|------------:|------------:|-----------:|----------:|-----------:|-----------:|-----------:|-------------:|-------------:|------------:|-----------:|-----------:|------------:|-------------:|----------:|----------:|-----------:|------------:|------------:|----------:|----------:|-----------:|----------:|----------:|-----------:|-----------:|-----------:|----------:|----------:|----------:|---------:|----------:|----------:|----------:|-----------:|-----------:|-----------:|----------:|----------:|----------:|---------:|----------:|----------:|-----------:|----------:|---------:|----------:|----------:|-----------:|----------:|---------:|----------:|----------:|-----------:|----------:|
|         0 |      0.00 |       0.0 |     0.000 |      0.000 |         0 |      0.0000 |       0.00 |        0.0 |         0 |       0.00 |     0.000 |    0.00000 |    0.00000 |       0.00 |      0.0000 |     0.00000 |       0.000 |      0.000 |      0.00 |      0.000 |  0.0000000 |     0.0000 |      0.00000 | 0.000000e+00 |    0.000000 |    0.00000 |      0.000 |      0.0000 | 0.000000e+00 |     0.000 | 0.0000000 |   0.000000 |    0.000000 |   0.0000000 |  0.000000 |  0.000000 |  0.0000000 |         0 |         0 |          0 |          0 |          0 |         0 |  0.000000 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|   6643705 |  28254.44 |  138564.8 |  1404.216 |   3486.341 |   1836321 |    426.8027 |   13657.21 |   161689.4 |   3195709 |   45594.96 |  3560.111 |   69.39754 |   69.51729 |   40002.16 |    882.7521 |    21.87133 |    6101.614 |   9569.317 |  17959.63 |   2689.602 |  0.4026165 |   115.3156 |     49.26352 | 2.934427e-01 |    4.039381 |   66.35498 |   2127.736 |    958.5395 | 6.585619e+00 |   677.566 | 0.5457419 |   3.407795 |    3.208655 |   0.0220627 |  2.281042 |  2.105263 |  0.7017544 |         0 |         0 |          0 |          0 |          0 |         0 |  1.052632 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  13287411 |  59370.89 |  305280.6 |  4982.766 |   8031.309 |   7285311 |   3015.2046 |   59878.06 |   595600.0 |  10810845 |  148233.18 |  7519.893 |  167.64954 |  223.33446 |  134251.43 |   3799.3812 |   141.77113 |   41036.606 |  35447.318 |  63609.82 |   8794.993 |  0.9469740 |   783.5685 |    707.55975 | 8.754763e+00 |   17.728557 |  141.97248 |   9412.434 |   8349.2101 | 1.178997e+02 |  2538.460 | 1.1713983 |   9.602259 |   33.967157 |   0.4293274 |  7.352762 |  4.210526 |  1.4035088 |         0 |         0 |          0 |          0 |          0 |         0 |  2.105263 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  19931116 |  92111.99 |  493800.9 |  9977.923 |  13309.736 |  15967381 |   8979.0467 |  139575.02 |  1231559.5 |  20894311 |  278301.62 | 11704.499 |  288.61014 |  421.02446 |  258826.99 |   8845.0420 |   397.95143 |  116694.207 |  73548.406 | 127180.97 |  16571.749 |  1.6168962 |  2048.2170 |   2887.46787 | 5.551093e+01 |   43.223347 |  222.99927 |  20324.014 |  26119.3324 | 5.634674e+02 |  5313.025 | 1.8429593 |  17.527414 |  131.306187 |   2.4158207 | 13.731437 |  6.315790 |  2.1052632 |         0 |         0 |          0 |          0 |          0 |         0 |  3.157895 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  26574821 | 125822.76 |  701683.7 | 15904.400 |  19256.135 |  27536185 |  18843.3311 |  252798.34 |  2013952.1 |  32357683 |  422198.18 | 16024.319 |  429.01980 |  646.42181 |  403678.15 |  15988.6857 |   801.49809 |  236280.715 | 120575.630 | 202203.96 |  25205.934 |  2.3787346 |  3770.9957 |   7223.16874 | 1.895008e+02 |   81.911747 |  307.38037 |  33657.021 |  54912.5586 | 1.590978e+03 |  8771.262 | 2.5431544 |  27.505121 |  323.446462 |   7.8131301 | 20.781947 |  8.421053 |  2.8070175 |         0 |         0 |          0 |          0 |          0 |         0 |  4.210526 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  33218526 | 155921.56 |  926635.6 | 22408.256 |  25775.329 |  41679629 |  32730.8030 |  399034.57 |  2894096.8 |  44580406 |  571277.56 | 19903.403 |  577.96852 |  888.13029 |  562642.21 |  25103.9986 |  1352.01242 |  399476.740 | 173621.284 | 283731.17 |  34177.819 |  3.1545100 |  5851.3910 |  14053.95217 | 4.668167e+02 |  134.336467 |  384.32240 |  48752.562 |  94010.3851 | 3.399814e+03 | 12704.335 | 3.1837759 |  39.555003 |  621.682524 |  18.5120602 | 28.105098 | 10.175439 |  3.5087719 |         0 |         0 |          0 |          0 |          0 |         0 |  5.263158 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  39862232 | 173468.85 | 1166258.5 | 28432.614 |  32690.602 |  58105235 |  50144.5669 |  576342.27 |  3711048.5 |  56983202 |  687798.29 | 22192.111 |  703.56156 | 1089.34685 |  710093.13 |  35278.9882 |  2020.00015 |  599382.106 | 223087.957 | 354875.06 |  41242.278 |  3.7890084 |  8125.2317 |  23486.99007 | 9.426755e+02 |  197.298651 |  431.73228 |  63700.157 | 141367.9558 | 6.119222e+03 | 16424.411 | 3.5803568 |  51.382776 | 1021.903125 |  36.0257994 | 33.832408 | 10.877193 |  4.2105263 |         0 |         0 |          0 |          0 |          0 |         0 |  6.315790 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  46505937 | 191083.96 | 1419311.6 | 34189.323 |  40098.351 |  76557182 |  70201.1404 |  783164.72 |  4440467.4 |  69404769 |  781821.79 | 24478.916 |  830.35049 | 1265.66156 |  851827.36 |  46000.2430 |  2756.60132 |  824836.082 | 267399.650 | 415450.03 |  46964.509 |  4.4223257 | 10402.1264 |  35268.14979 | 1.662771e+03 |  268.890268 |  478.81465 |  77918.342 | 193387.6352 | 9.768877e+03 | 19799.859 | 3.9737795 |  64.383412 | 1503.574868 |  61.1370942 | 38.530385 | 11.578947 |  4.9122807 |         0 |         0 |          0 |          0 |          0 |         0 |  7.368421 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  53149642 | 208775.97 | 1684328.5 | 39934.997 |  47956.689 |  96813104 |  92449.4261 | 1018318.93 |  5113151.6 |  81838127 |  867544.54 | 26770.629 |  958.72873 | 1434.53123 |  995909.34 |  57155.4581 |  3540.34239 | 1071042.171 | 308334.085 | 470244.51 |  52182.305 |  5.0613603 | 12712.5852 |  49076.90627 | 2.657456e+03 |  348.488308 |  525.94131 |  92173.525 | 248252.1292 | 1.428644e+04 | 22946.560 | 4.3676643 |  78.658808 | 2042.977627 |  93.8015893 | 42.892807 | 12.280702 |  5.6140351 |         0 |         0 |          0 |          0 |          0 |         0 |  8.421053 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  59793347 | 226543.72 | 1960001.2 | 45735.051 |  56226.580 | 118675196 | 116617.4657 | 1280487.46 |  5749378.1 |  94279496 |  950344.49 | 29069.835 | 1088.81988 | 1601.33330 | 1144792.35 |  68669.4636 |  4361.23085 | 1336008.586 | 347081.884 | 521926.96 |  57218.075 |  5.7158857 | 15112.5082 |  64736.60541 | 3.945950e+03 |  435.730084 |  573.28173 | 106823.573 | 305485.6638 | 1.959175e+04 | 25945.801 | 4.7634980 |  93.892832 | 2623.941303 | 133.4455731 | 47.158351 | 12.982456 |  6.3157895 |         0 |         0 |          0 |          0 |          0 |         0 |  9.473684 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  66437053 | 244235.47 | 2245135.9 | 51590.190 |  64870.093 | 141967296 | 142497.9271 | 1568263.90 |  6362122.4 | 106461786 | 1032147.73 | 31358.947 | 1220.31870 | 1767.81643 | 1298981.42 |  80487.6397 |  5213.40397 | 1618641.084 | 384414.804 | 571940.05 |  62189.926 |  6.3883974 | 17627.8806 |  82166.47066 | 5.541433e+03 |  530.420003 |  620.55838 | 121978.126 | 365044.2228 | 2.561286e+04 | 28851.752 | 5.1590232 | 109.863588 | 3238.007580 | 179.3181503 | 51.404584 | 13.684211 |  7.0175439 |         0 |         0 |          0 |          0 |          0 |         0 | 10.350877 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  73080758 | 261169.77 | 2538532.2 | 57287.346 |  73842.676 | 166529650 | 169827.6301 | 1880132.11 |  6954193.9 | 117180324 | 1112119.66 | 33552.295 | 1351.29212 | 1932.34586 | 1457350.14 |  92536.2806 |  6091.85791 | 1917901.402 | 420505.600 | 620454.24 |  67051.288 |  7.0700941 | 20261.6964 | 101322.35430 | 7.453676e+03 |  632.285020 |  666.17690 | 137587.265 | 426925.0544 | 3.229036e+04 | 31676.772 | 5.5410527 | 126.353507 | 3881.216932 | 230.6987096 | 55.580548 | 14.385965 |  7.7192982 |         0 |         0 |          0 |          0 |          0 |         0 | 11.052632 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  79724463 | 277599.40 | 2839287.2 | 62725.405 |  83115.722 | 192218637 | 198207.8337 | 2214529.15 |  7525449.1 | 126904838 | 1189562.39 | 35681.205 | 1481.68197 | 2093.84932 | 1618965.46 | 104733.9642 |  6990.66576 | 2232397.620 | 455347.110 | 667361.29 |  71761.240 |  7.7621540 | 23001.4127 | 122157.46250 | 9.689919e+03 |  740.986005 |  710.68352 | 153547.104 | 490986.5746 | 3.957323e+04 | 34419.835 | 5.9139968 | 143.287290 | 4551.166016 | 286.9662944 | 59.649764 | 15.087719 |  8.4210526 |         0 |         0 |          0 |          0 |          0 |         0 | 11.754386 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  86368168 | 293765.60 | 3146616.2 | 67976.104 |  92664.237 | 218908208 | 227302.4851 | 2569947.39 |  8079038.1 | 136076384 | 1265044.84 | 37776.239 | 1611.74490 | 2253.07534 | 1783779.01 | 117027.9693 |  7904.76400 | 2560816.777 | 489126.828 | 712951.37 |  76353.506 |  8.4663640 | 25837.7312 | 144613.36788 | 1.225491e+04 |  856.251748 |  754.63844 | 169830.167 | 557042.9177 | 4.741435e+04 | 37093.515 | 6.2824763 | 160.667297 | 5245.699382 | 347.5941262 | 63.640164 | 15.789474 |  9.1228070 |         0 |         0 |          0 |          0 |          0 |         0 | 12.456140 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  93011874 | 309801.62 | 3459811.6 | 73114.480 | 102464.282 | 246487281 | 256888.7374 | 2944935.81 |  8618982.7 | 144940658 | 1339275.22 | 39854.493 | 1741.65787 | 2410.90461 | 1951864.46 | 129385.7349 |  8830.52801 | 2902094.629 | 522085.245 | 757595.80 |  80870.369 |  9.1840520 | 28767.2744 | 168631.43311 | 1.515105e+04 |  977.863695 |  798.36244 | 186439.029 | 624953.8482 | 5.577021e+04 | 39714.388 | 6.6491484 | 178.486134 | 5962.887732 | 412.1311385 | 67.585214 | 16.491228 |  9.8245614 |         0 |         0 |          0 |          0 |          0 |         0 | 13.157895 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
|  99655579 | 325780.31 | 3778237.9 | 78191.187 | 112493.357 | 274857595 | 286827.6579 | 3338100.90 |  9148999.8 | 153634496 | 1412792.35 | 41925.414 | 1871.53918 | 2567.99503 | 2123222.54 | 141787.4932 |  9765.48657 | 3255369.848 | 554445.674 | 801616.42 |  85344.243 |  9.9160114 | 31788.4922 | 194158.77473 | 1.837883e+04 | 1105.641899 |  842.03463 | 203375.816 | 694625.1072 | 6.460164e+04 | 42298.059 | 7.0154983 | 196.729234 | 6701.186323 | 480.1917795 | 71.509524 | 17.192982 | 10.5263158 |         0 |         0 |          0 |          0 |          0 |         0 | 13.859649 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
| 106299284 | 341740.85 | 4101326.3 | 83236.686 | 122730.566 | 303932028 | 317033.1280 | 3748109.55 |  9672114.7 | 162234086 | 1485947.00 | 43994.134 | 2001.46613 | 2724.78143 | 2297769.58 | 154221.4490 | 10707.96512 | 3619912.640 | 586390.682 | 845254.54 |  89796.384 | 10.6625172 | 34899.5847 | 221148.10149 | 2.193723e+04 | 1239.430773 |  885.75159 | 220635.515 | 765986.8449 | 7.387409e+04 | 44857.370 | 7.3823265 | 215.380971 | 7459.417122 | 551.4501732 | 75.428595 | 17.894737 | 11.2280702 |         0 |         0 |          0 |          0 |          0 |         0 | 14.561404 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
| 112942989 | 357703.67 | 4428568.7 | 88268.458 | 133156.639 | 333633208 | 347450.6381 | 4173692.22 | 10190625.5 | 170781813 | 1558949.75 | 46063.355 | 2131.48811 | 2881.53506 | 2475363.93 | 166680.6907 | 11656.81228 | 3995071.654 | 618059.453 | 888677.31 |  94239.650 | 11.4234591 | 38098.0499 | 249555.75956 | 2.582407e+04 | 1379.087725 |  929.56255 | 238206.880 | 838976.6724 | 8.355718e+04 | 47402.125 | 7.7500399 | 234.426537 | 8236.649219 | 625.6335524 | 79.351384 | 18.596491 | 11.9298246 |         0 |         0 |          0 |          0 |          0 |         0 | 15.263158 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
| 119586695 | 373678.91 | 4759511.6 | 93296.250 | 143753.895 | 363892360 | 378044.3505 | 4613645.42 | 10706200.6 | 179301237 | 1631919.91 | 48134.428 | 2261.63577 | 3038.41775 | 2655831.84 | 179161.2409 | 12611.21365 | 4380241.735 | 649553.359 | 931994.32 |  98681.377 | 12.1984780 | 41380.7963 | 279339.94932 | 3.003623e+04 | 1524.475600 |  973.48990 | 256074.653 | 913530.7472 | 9.362409e+04 | 49939.431 | 8.1188221 | 253.851626 | 9032.074987 | 702.5138993 | 83.282678 | 19.298246 | 12.6315789 |         0 |         0 |          0 |          0 |          0 |         0 | 15.964912 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |
| 126230400 | 389671.03 | 5093750.6 | 98325.345 | 154506.162 | 394648309 | 408789.5002 | 5066833.27 | 11220011.5 | 187805426 | 1704921.30 | 50207.954 | 2391.92712 | 3195.52087 | 2838985.67 | 191660.8422 | 13570.57059 | 4774846.571 | 680943.749 | 975274.21 | 103125.516 | 12.9870688 | 44744.3584 | 310459.54874 | 3.456980e+04 | 1675.458219 | 1017.54105 | 274221.443 | 989580.5529 | 1.040508e+05 | 52474.228 | 8.4887318 | 273.641666 | 9844.922926 | 781.8988166 | 87.224763 | 20.000000 | 13.3333333 |         0 |         0 |          0 |          0 |          0 |         0 | 16.666667 |         0 |        0 |         0 |         0 |         0 |          0 |          0 |          0 |         0 |         0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |        0 |         0 |         0 |          0 |         0 |

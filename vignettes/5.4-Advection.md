Advection
================
Jaap Slootweg, Joris Quik, Valerie de Rijk
2024-07-18

### Advection

This vignette demonstrates the implementation of the advective flows of
air and water in SimpleBox (SB). An advective flow in the context of SB
is the massflow of a matrix (air, water ) from one box to another, where
either the subcompartment or scale is different.

``` r
source("baseScripts/initWorld_onlyMolec.R")
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.0     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
    ## 
    ## Attaching package: 'ggdag'
    ## 
    ## 
    ## The following object is masked from 'package:stats':
    ## 
    ##     filter
    ## 
    ## 
    ## 
    ## Attaching package: 'rlang'
    ## 
    ## 
    ## The following objects are masked from 'package:purrr':
    ## 
    ##     %@%, flatten, flatten_chr, flatten_dbl, flatten_int, flatten_lgl,
    ##     flatten_raw, invoke, splice
    ## 
    ## 
    ## Joining with `by = join_by(Matrix)`
    ## Joining with `by = join_by(Compartment)`

    ## Warning in eval(ei, envir): pKa is needed but missing, setting pKa=7

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SubCompartName
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.SubCompartName in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## from.SubCompartName in FromAndTo property

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 23 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 45 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ## Warning: `as.tibble()` was deprecated in tibble 2.0.0.
    ## ℹ Please use `as_tibble()` instead.
    ## ℹ The signature and semantics have changed, see `?as_tibble`.
    ## This warning is displayed once every 8 hours.
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

    ## Warning in private$UpdateDL(CanDo[i]): rad_species ; no rows calculated

    ## Warning in private$UpdateDL(CanDo[i]): rho_species ; no rows calculated

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.FracROWatComp in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.SubCompartName in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all Matrix in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all to.rhoMatrix
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all to.RadCP in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all to.RhoCP in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all from.RhoCP in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all FRACs in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SpeciesName in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.SubCompartName in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## from.SubCompartName in FromAndTo property

    ## Warning in private$UpdateDL(CanDo[i]): SettlingVelocity ; no rows calculated

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 5 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 4 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ## Warning in private$Execute(debugAt): input data ignored; not all FRinw in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all to.MTC_2w in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all from.MTC_2w in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all to.FRorig in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all to.Matrix in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all to.Area in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## from.SubCompartName in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.SubCompartName in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all Matrix in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SpeciesName in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SubCompartName
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all MTC_2w in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SpeciesName in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.SubCompartName in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SpeciesName in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all Kscompw in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.FracROWatComp in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all Volume in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.SubCompartName in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SpeciesName in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all Matrix in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all FRinw in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all from.RhoCP in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all from.RadCP in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SpeciesName in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SubCompartName
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.SubCompartName in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all to.MTC_2w in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all from.FRorig in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all FRinw in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SpeciesName in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all Matrix in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## from.SubCompartName in FromAndTo property

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 34 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 4 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 2 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 34 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ## Warning in private$Execute(debugAt): input data ignored; not all Volume in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all FRorig in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all SpeciesName in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all to.Area in
    ## FromAndTo property

    ## Warning in private$Execute(debugAt): input data ignored; not all from.Area in
    ## FromAndTo property

#### Data and variables

For calculating the rate constants for advection there is data needed
on: - Windspeed Together with the variables: -

``` r
SBvars <- c("AreaLand",
            "AreaSea",
            "Area",
            "Volume"
            )

for (x in SBvars) {
  World$NewCalcVariable(x)
  World$CalcVar(x)
}
```

#### Air flow

We calculate AirFlow in two steps. The first is the application of a
simple model of air circulation depending on windspeed; The mean
residence time in the region is according the f_TAU function. The
AirFlow function calculates the amount that would enter/leave the
region; namely the volume divided by the residence time. Notice that
f_TAU is a normal function, but AirFlow will be used as a variable
defining function. After the call to World\$CalcVar(“AirFlow”) this
property is stored in the data within World. This provides the overal
airflow within a compartment which affects the flow from this
compartment or scale to the next. Currently air only flows between
scales.

``` r
f_TAU
```

    ## function (Area, WINDspeed) 
    ## {
    ##     1.5 * (0.5 * sqrt(Area * pi/4)/WINDspeed)
    ## }
    ## <bytecode: 0x562fbd4eba88>

``` r
World$fetchData("Volume")
```

    ##          Scale         SubCompart       Volume
    ## 2       Arctic                air 4.249999e+16
    ## 4       Arctic          deepocean 7.650000e+16
    ## 8       Arctic     marinesediment 7.650000e+11
    ## 9       Arctic        naturalsoil 8.500000e+11
    ## 12      Arctic                sea 2.550000e+15
    ## 13 Continental   agriculturalsoil 4.183008e+11
    ## 14 Continental                air 7.199248e+15
    ## 17 Continental freshwatersediment 2.875818e+09
    ## 18 Continental               lake 8.714600e+11
    ## 19 Continental       lakesediment 2.614380e+08
    ## 20 Continental     marinesediment 1.114023e+11
    ## 21 Continental        naturalsoil 4.705884e+10
    ## 22 Continental          othersoil 1.742920e+10
    ## 23 Continental              river 2.875818e+11
    ## 24 Continental                sea 7.426820e+14
    ## 26    Moderate                air 7.757116e+16
    ## 28    Moderate          deepocean 1.163568e+17
    ## 32    Moderate     marinesediment 1.163568e+12
    ## 33    Moderate        naturalsoil 1.939280e+12
    ## 36    Moderate                sea 3.878559e+15
    ## 37    Regional   agriculturalsoil 2.742840e+10
    ## 38    Regional                air 2.295699e+14
    ## 41    Regional freshwatersediment 1.885702e+08
    ## 42    Regional               lake 5.714250e+10
    ## 43    Regional       lakesediment 1.714275e+07
    ## 44    Regional     marinesediment 3.000000e+07
    ## 45    Regional        naturalsoil 3.085695e+09
    ## 46    Regional          othersoil 1.142850e+09
    ## 47    Regional              river 1.885702e+10
    ## 48    Regional                sea 1.000000e+10
    ## 50      Tropic                air 1.275000e+17
    ## 52      Tropic          deepocean 2.677500e+17
    ## 56      Tropic     marinesediment 2.677500e+12
    ## 57      Tropic        naturalsoil 1.912500e+12
    ## 60      Tropic                sea 8.925000e+15

``` r
World$fetchData("Area")
```

    ##          Scale         SubCompart         Area
    ## 2       Arctic                air 4.250000e+13
    ## 4       Arctic          deepocean 2.550000e+13
    ## 8       Arctic     marinesediment 2.550000e+13
    ## 9       Arctic        naturalsoil 1.700000e+13
    ## 12      Arctic                sea 2.550000e+13
    ## 13 Continental   agriculturalsoil 2.091504e+12
    ## 14 Continental                air 7.199250e+12
    ## 17 Continental freshwatersediment 9.586060e+10
    ## 18 Continental               lake 8.714600e+09
    ## 19 Continental       lakesediment 8.714600e+09
    ## 20 Continental     marinesediment 3.713410e+12
    ## 21 Continental        naturalsoil 9.411768e+11
    ## 22 Continental          othersoil 3.485840e+11
    ## 23 Continental              river 9.586060e+10
    ## 24 Continental                sea 3.713410e+12
    ## 26    Moderate                air 7.757118e+13
    ## 28    Moderate          deepocean 3.878559e+13
    ## 32    Moderate     marinesediment 3.878559e+13
    ## 33    Moderate        naturalsoil 3.878559e+13
    ## 36    Moderate                sea 3.878559e+13
    ## 37    Regional   agriculturalsoil 1.371420e+11
    ## 38    Regional                air 2.295700e+11
    ## 41    Regional freshwatersediment 6.285675e+09
    ## 42    Regional               lake 5.714250e+08
    ## 43    Regional       lakesediment 5.714250e+08
    ## 44    Regional     marinesediment 1.000000e+09
    ## 45    Regional        naturalsoil 6.171390e+10
    ## 46    Regional          othersoil 2.285700e+10
    ## 47    Regional              river 6.285675e+09
    ## 48    Regional                sea 1.000000e+09
    ## 50      Tropic                air 1.275000e+14
    ## 52      Tropic          deepocean 8.925000e+13
    ## 56      Tropic     marinesediment 8.925000e+13
    ## 57      Tropic        naturalsoil 3.825000e+13
    ## 60      Tropic                sea 8.925000e+13

``` r
World$fetchData("WINDspeed")
```

    ##         Scale WINDspeed
    ## 1      Arctic         3
    ## 2 Continental         3
    ## 3    Moderate         3
    ## 4    Regional         3
    ## 5      Tropic         3

``` r
World$NewCalcVariable("AirFlow")
World$CalcVar("AirFlow")
```

    ##         Scale SubCompart old_AirFlow     AirFlow
    ## 1      Arctic        air 29424519893 29424519893
    ## 2 Continental        air 12110401673 12110401673
    ## 3    Moderate        air 39752561608 39752561608
    ## 4    Regional        air  2162581520  2162581520
    ## 5      Tropic        air 50964763443 50964763443

#### flow mass balance

To ensure mass balance in the model the amount from one scale to the
next would need to be equal to the amount flowing the opposite way! To
honor the mass balance we give priority to the amount calculated for the
smallest volume to calculate the actual flows. This means that for
nested scales we need to know their ‘place’ in the world. This brings a
new challenge; we need to know properties of the scale the flow is going
to, or possibly the scale where it is coming from. Because of the
nesting, we need to know even properties of scale not directly related
to the to- or from- the scale! To accommodate this use of the “to.”, the
“from.” and the “all.” preposition is made available. The to- and from
scaleName are atomic (a single string) but the “all.” prepositions
provides a full table of the variable and its dimensions (in this case
only across Scales). If you want to see what is really going on in the
function calls you can use the debug parameter.

``` r
x_Advection_Air
```

    ## function (all.AirFlow, from.ScaleName, to.ScaleName) 
    ## {
    ##     from.AirFlow <- all.AirFlow$AirFlow[all.AirFlow$Scale == 
    ##         from.ScaleName]
    ##     to.Airflow <- all.AirFlow$AirFlow[all.AirFlow$Scale == to.ScaleName]
    ##     Cont2Regional.Airflow <- function() {
    ##         all.AirFlow$AirFlow[all.AirFlow$Scale == "Regional"]
    ##     }
    ##     if (from.ScaleName %in% c("Arctic", "Regional", "Tropic")) {
    ##         return(all.AirFlow$AirFlow[all.AirFlow$Scale == from.ScaleName])
    ##     }
    ##     if (from.ScaleName == "Continental" & to.ScaleName == "Moderate") {
    ##         return(all.AirFlow$AirFlow[all.AirFlow$Scale == from.ScaleName] - 
    ##             Cont2Regional.Airflow())
    ##     }
    ##     if (from.ScaleName == "Moderate" & to.ScaleName == "Continental") {
    ##         return(all.AirFlow$AirFlow[all.AirFlow$Scale == to.ScaleName] - 
    ##             Cont2Regional.Airflow())
    ##     }
    ##     return(all.AirFlow$AirFlow[all.AirFlow$Scale == to.ScaleName])
    ## }
    ## <bytecode: 0x562fba900b60>

``` r
AdvAir <- World$NewFlow("x_Advection_Air")
#AdvAir$execute(debugAt = list(toScale = "Continental"))
World$CalcVar("x_Advection_Air")
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 34 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##          FlowName   fromScale     toScale fromSubCompart toSubCompart
    ## 1 x_Advection_Air      Arctic    Moderate            air          air
    ## 2 x_Advection_Air Continental    Moderate            air          air
    ## 3 x_Advection_Air Continental    Regional            air          air
    ## 4 x_Advection_Air    Moderate      Arctic            air          air
    ## 5 x_Advection_Air    Moderate Continental            air          air
    ## 6 x_Advection_Air    Moderate      Tropic            air          air
    ## 7 x_Advection_Air    Regional Continental            air          air
    ## 8 x_Advection_Air      Tropic    Moderate            air          air
    ##          flow
    ## 1 29424519893
    ## 2  9947820153
    ## 3  2162581520
    ## 4 29424519893
    ## 5  9947820153
    ## 6 50964763443
    ## 7  2162581520
    ## 8 50964763443

This provides the air flows. To test if they add up and give the same
amount flowing to and from each scale we do the following calculation:

``` r
AirFlows <- World$fetchData("x_Advection_Air")
ToFlow <- aggregate(flow~toScale, data = AirFlows, FUN = sum)
FromFlow <- aggregate(flow~fromScale, data = AirFlows, FUN = sum)
merge(FromFlow, ToFlow, by.x = "fromScale", by.y = "toScale", suffixes = c("_from", "_to"))
```

    ##     fromScale   flow_from     flow_to
    ## 1      Arctic 29424519893 29424519893
    ## 2 Continental 12110401673 12110401673
    ## 3    Moderate 90337103489 90337103489
    ## 4    Regional  2162581520  2162581520
    ## 5      Tropic 50964763443 50964763443

#### Water flow

All flows dealing with advective processes are denoted by x_files in
SBOO. Different dimensions are relevant for computing the water flows:
subcompartments and scale. This relates to water flowing from lake,
through the river compartment to the sea, after which the sea flows
between scales. This is defined in the following x_flow. The order of
calculation matters (for regional and continental scale function x 1-5)
!

*1. x_ContRiver2Reg*

x_ContRiver2Reg: based on Runoff calculates the flow from contintental
river to regional river subcompartment (not usually relevant, thus often
0).

``` r
x_ContRiver2Reg
```

    ## function (ScaleName, SubCompartName, all.Runoff, RainOnFreshwater, 
    ##     dischargeFRAC, LakeFracRiver) 
    ## {
    ##     switch(ScaleName, Continental = {
    ##         switch(SubCompartName, river = {
    ##             SumRainRunoff <- sum(all.Runoff$Runoff[all.Runoff$Scale == 
    ##                 "Continental"])
    ##             River2sea <- RainOnFreshwater + SumRainRunoff * (1 - 
    ##                 dischargeFRAC)
    ##             Lake2River <- LakeFracRiver * River2sea
    ##             return((RainOnFreshwater + SumRainRunoff + Lake2River) * 
    ##                 dischargeFRAC)
    ##         }, return(NA))
    ##     }, return(NA))
    ## }
    ## <bytecode: 0x562fb6788c38>

``` r
World$NewCalcVariable("Runoff")
World$CalcVar("Runoff")
```

    ##         Scale       SubCompart  old_Runoff      Runoff
    ## 1      Arctic      naturalsoil  33691.6540  33691.6540
    ## 2 Continental agriculturalsoil  11606.2024  11606.2024
    ## 3 Continental      naturalsoil   5222.7911   5222.7911
    ## 4 Continental        othersoil   1934.3671   1934.3671
    ## 5    Moderate      naturalsoil 215229.5234 215229.5234
    ## 6    Regional agriculturalsoil    761.0303    761.0303
    ## 7    Regional      naturalsoil    342.4636    342.4636
    ## 8    Regional        othersoil    126.8384    126.8384
    ## 9      Tropic      naturalsoil 394192.3516 394192.3516

``` r
World$NewCalcVariable("RainOnFreshwater")
World$CalcVar("RainOnFreshwater")
```

    ##         Scale SubCompart old_RainOnFreshwater RainOnFreshwater
    ## 1      Arctic       lake               0.0000           0.0000
    ## 2 Continental       lake               0.0000           0.0000
    ## 3 Continental      river            2127.8038        2127.8038
    ## 4    Moderate       lake               0.0000           0.0000
    ## 5    Regional       lake               0.0000           0.0000
    ## 6    Regional      river             139.5222         139.5222
    ## 7      Tropic       lake               0.0000           0.0000

``` r
World$fetchData("ScaleName")
```

    ##         Scale   ScaleName
    ## 1      Arctic      Arctic
    ## 2 Continental Continental
    ## 3    Moderate    Moderate
    ## 4    Regional    Regional
    ## 5      Tropic      Tropic

``` r
World$fetchData("SubCompartName")
```

    ##            SubCompart     SubCompartName
    ## 1    agriculturalsoil   agriculturalsoil
    ## 2                 air                air
    ## 3          cloudwater         cloudwater
    ## 4           deepocean          deepocean
    ## 5  freshwatersediment freshwatersediment
    ## 6                lake               lake
    ## 7        lakesediment       lakesediment
    ## 8      marinesediment     marinesediment
    ## 9         naturalsoil        naturalsoil
    ## 10          othersoil          othersoil
    ## 11              river              river
    ## 12                sea                sea

``` r
World$fetchData("dischargeFRAC")
```

    ##         Scale dischargeFRAC
    ## 2 Continental             0
    ## 4    Regional             0

``` r
World$fetchData("LakeFracRiver")
```

    ## [1] 0.1

``` r
World$fetchData("Runoff")
```

    ##          Scale       SubCompart      Runoff
    ## 9       Arctic      naturalsoil  33691.6540
    ## 13 Continental agriculturalsoil  11606.2024
    ## 21 Continental      naturalsoil   5222.7911
    ## 22 Continental        othersoil   1934.3671
    ## 33    Moderate      naturalsoil 215229.5234
    ## 37    Regional agriculturalsoil    761.0303
    ## 45    Regional      naturalsoil    342.4636
    ## 46    Regional        othersoil    126.8384
    ## 57      Tropic      naturalsoil 394192.3516

``` r
World$fetchData("Area")
```

    ##          Scale         SubCompart         Area
    ## 2       Arctic                air 4.250000e+13
    ## 4       Arctic          deepocean 2.550000e+13
    ## 8       Arctic     marinesediment 2.550000e+13
    ## 9       Arctic        naturalsoil 1.700000e+13
    ## 12      Arctic                sea 2.550000e+13
    ## 13 Continental   agriculturalsoil 2.091504e+12
    ## 14 Continental                air 7.199250e+12
    ## 17 Continental freshwatersediment 9.586060e+10
    ## 18 Continental               lake 8.714600e+09
    ## 19 Continental       lakesediment 8.714600e+09
    ## 20 Continental     marinesediment 3.713410e+12
    ## 21 Continental        naturalsoil 9.411768e+11
    ## 22 Continental          othersoil 3.485840e+11
    ## 23 Continental              river 9.586060e+10
    ## 24 Continental                sea 3.713410e+12
    ## 26    Moderate                air 7.757118e+13
    ## 28    Moderate          deepocean 3.878559e+13
    ## 32    Moderate     marinesediment 3.878559e+13
    ## 33    Moderate        naturalsoil 3.878559e+13
    ## 36    Moderate                sea 3.878559e+13
    ## 37    Regional   agriculturalsoil 1.371420e+11
    ## 38    Regional                air 2.295700e+11
    ## 41    Regional freshwatersediment 6.285675e+09
    ## 42    Regional               lake 5.714250e+08
    ## 43    Regional       lakesediment 5.714250e+08
    ## 44    Regional     marinesediment 1.000000e+09
    ## 45    Regional        naturalsoil 6.171390e+10
    ## 46    Regional          othersoil 2.285700e+10
    ## 47    Regional              river 6.285675e+09
    ## 48    Regional                sea 1.000000e+09
    ## 50      Tropic                air 1.275000e+14
    ## 52      Tropic          deepocean 8.925000e+13
    ## 56      Tropic     marinesediment 8.925000e+13
    ## 57      Tropic        naturalsoil 3.825000e+13
    ## 60      Tropic                sea 8.925000e+13

``` r
World$fetchData("LakeFracRiver")
```

    ## [1] 0.1

``` r
flow1 <- World$NewFlow("x_ContRiver2Reg")

flow1$FromAndTo
```

    ##     fromScale  toScale fromSubCompart
    ## 7 Continental Regional          river

``` r
flow1$execute()
```

    ##     fromScale  toScale fromSubCompart flow
    ## 1 Continental Regional          river    0

``` r
World$CalcVar("x_ContRiver2Reg")
```

    ##          FlowName   fromScale  toScale fromSubCompart toSubCompart flow
    ## 1 x_ContRiver2Reg Continental Regional          river        river    0

*2. x_RiverDischarge*

``` r
World$fetchData("Runoff")
```

    ##          Scale       SubCompart      Runoff
    ## 9       Arctic      naturalsoil  33691.6540
    ## 13 Continental agriculturalsoil  11606.2024
    ## 21 Continental      naturalsoil   5222.7911
    ## 22 Continental        othersoil   1934.3671
    ## 33    Moderate      naturalsoil 215229.5234
    ## 37    Regional agriculturalsoil    761.0303
    ## 45    Regional      naturalsoil    342.4636
    ## 46    Regional        othersoil    126.8384
    ## 57      Tropic      naturalsoil 394192.3516

``` r
World$fetchData("RainOnFreshwater")
```

    ##          Scale SubCompart RainOnFreshwater
    ## 6       Arctic       lake           0.0000
    ## 18 Continental       lake           0.0000
    ## 23 Continental      river        2127.8038
    ## 30    Moderate       lake           0.0000
    ## 42    Regional       lake           0.0000
    ## 47    Regional      river         139.5222
    ## 54      Tropic       lake           0.0000

``` r
World$fetchData("dischargeFRAC")
```

    ##         Scale dischargeFRAC
    ## 2 Continental             0
    ## 4    Regional             0

``` r
World$fetchData("x_ContRiver2Reg")
```

    ##           FlowName   fromScale  toScale fromSubCompart toSubCompart flow
    ## 13 x_ContRiver2Reg Continental Regional          river        river    0

``` r
World$fetchData("ScaleName")
```

    ##         Scale   ScaleName
    ## 1      Arctic      Arctic
    ## 2 Continental Continental
    ## 3    Moderate    Moderate
    ## 4    Regional    Regional
    ## 5      Tropic      Tropic

``` r
flow2 <- World$NewFlow("x_RiverDischarge")

flow2$FromAndTo
```

    ##    fromSubCompart toSubCompart   fromScale
    ## 24          river          sea    Regional
    ## 25          river          sea Continental

``` r
flow2$execute()
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 4 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##   fromSubCompart toSubCompart   fromScale      flow
    ## 1          river          sea    Regional  1369.854
    ## 2          river          sea Continental 20891.164

``` r
World$CalcVar("x_RiverDischarge")
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 4 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##           FlowName   fromScale     toScale fromSubCompart toSubCompart
    ## 1 x_RiverDischarge Continental Continental          river          sea
    ## 2 x_RiverDischarge    Regional    Regional          river          sea
    ##        flow
    ## 1 20891.164
    ## 2  1369.854

*3. x_LakeOutflow*

``` r
World$fetchData("x_RiverDischarge")
```

    ##            FlowName   fromScale     toScale fromSubCompart toSubCompart
    ## 14 x_RiverDischarge    Regional    Regional          river          sea
    ## 21 x_RiverDischarge Continental Continental          river          sea
    ##         flow
    ## 14  1369.854
    ## 21 20891.164

``` r
World$fetchData("x_ContRiver2Reg")
```

    ##           FlowName   fromScale  toScale fromSubCompart toSubCompart flow
    ## 13 x_ContRiver2Reg Continental Regional          river        river    0

``` r
World$fetchData("LakeFracRiver")
```

    ## [1] 0.1

``` r
World$fetchData("ScaleName")
```

    ##         Scale   ScaleName
    ## 1      Arctic      Arctic
    ## 2 Continental Continental
    ## 3    Moderate    Moderate
    ## 4    Regional    Regional
    ## 5      Tropic      Tropic

``` r
flow3 <- World$NewFlow("x_LakeOutflow")

flow3$FromAndTo
```

    ##    fromSubCompart toSubCompart   fromScale
    ## 12           lake        river    Regional
    ## 13           lake        river Continental

``` r
flow3$execute()
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 2 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##   fromSubCompart toSubCompart   fromScale      flow
    ## 1           lake        river    Regional  136.9854
    ## 2           lake        river Continental 2089.1164

``` r
World$CalcVar("x_LakeOutflow")
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 2 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##        FlowName   fromScale     toScale fromSubCompart toSubCompart      flow
    ## 1 x_LakeOutflow Continental Continental           lake        river 2089.1164
    ## 2 x_LakeOutflow    Regional    Regional           lake        river  136.9854

*4. x_ContSea2Reg*

``` r
World$fetchData("LakeFracRiver")
```

    ## [1] 0.1

``` r
World$fetchData("x_RiverDischarge")
```

    ##            FlowName   fromScale     toScale fromSubCompart toSubCompart
    ## 14 x_RiverDischarge    Regional    Regional          river          sea
    ## 21 x_RiverDischarge Continental Continental          river          sea
    ##         flow
    ## 14  1369.854
    ## 21 20891.164

``` r
flow4 <- World$NewFlow("x_ContSea2Reg")

flow4$FromAndTo
```

    ##     fromScale  toScale fromSubCompart
    ## 8 Continental Regional            sea

``` r
flow4$execute()
```

    ##     fromScale  toScale fromSubCompart     flow
    ## 1 Continental Regional            sea 12328.69

``` r
World$CalcVar("x_ContSea2Reg")
```

    ##        FlowName   fromScale  toScale fromSubCompart toSubCompart     flow
    ## 1 x_ContSea2Reg Continental Regional            sea          sea 12328.69

*5. x_RegSea2Cont*

``` r
World$fetchData("LakeFracRiver")
```

    ## [1] 0.1

``` r
World$fetchData("x_RiverDischarge")
```

    ##            FlowName   fromScale     toScale fromSubCompart toSubCompart
    ## 14 x_RiverDischarge    Regional    Regional          river          sea
    ## 21 x_RiverDischarge Continental Continental          river          sea
    ##         flow
    ## 14  1369.854
    ## 21 20891.164

``` r
flow5 <- World$NewFlow("x_RegSea2Cont")

flow5$FromAndTo
```

    ##    fromScale     toScale fromSubCompart
    ## 23  Regional Continental            sea

``` r
flow5$execute()
```

    ##   fromScale     toScale fromSubCompart     flow
    ## 1  Regional Continental            sea 13698.54

``` r
World$CalcVar("x_RegSea2Cont")
```

    ##        FlowName fromScale     toScale fromSubCompart toSubCompart     flow
    ## 1 x_RegSea2Cont  Regional Continental            sea          sea 13698.54

*6. x_ToModerateWater*

Advection of continental sea, Tropic and Arctic sea compartments to sea
and deepocean at Moderate scale.

``` r
World$fetchData("Volume")
```

    ##          Scale         SubCompart       Volume
    ## 2       Arctic                air 4.249999e+16
    ## 4       Arctic          deepocean 7.650000e+16
    ## 8       Arctic     marinesediment 7.650000e+11
    ## 9       Arctic        naturalsoil 8.500000e+11
    ## 12      Arctic                sea 2.550000e+15
    ## 13 Continental   agriculturalsoil 4.183008e+11
    ## 14 Continental                air 7.199248e+15
    ## 17 Continental freshwatersediment 2.875818e+09
    ## 18 Continental               lake 8.714600e+11
    ## 19 Continental       lakesediment 2.614380e+08
    ## 20 Continental     marinesediment 1.114023e+11
    ## 21 Continental        naturalsoil 4.705884e+10
    ## 22 Continental          othersoil 1.742920e+10
    ## 23 Continental              river 2.875818e+11
    ## 24 Continental                sea 7.426820e+14
    ## 26    Moderate                air 7.757116e+16
    ## 28    Moderate          deepocean 1.163568e+17
    ## 32    Moderate     marinesediment 1.163568e+12
    ## 33    Moderate        naturalsoil 1.939280e+12
    ## 36    Moderate                sea 3.878559e+15
    ## 37    Regional   agriculturalsoil 2.742840e+10
    ## 38    Regional                air 2.295699e+14
    ## 41    Regional freshwatersediment 1.885702e+08
    ## 42    Regional               lake 5.714250e+10
    ## 43    Regional       lakesediment 1.714275e+07
    ## 44    Regional     marinesediment 3.000000e+07
    ## 45    Regional        naturalsoil 3.085695e+09
    ## 46    Regional          othersoil 1.142850e+09
    ## 47    Regional              river 1.885702e+10
    ## 48    Regional                sea 1.000000e+10
    ## 50      Tropic                air 1.275000e+17
    ## 52      Tropic          deepocean 2.677500e+17
    ## 56      Tropic     marinesediment 2.677500e+12
    ## 57      Tropic        naturalsoil 1.912500e+12
    ## 60      Tropic                sea 8.925000e+15

``` r
World$fetchData("TAUsea")
```

    ##         Scale   TAUsea
    ## 1      Arctic  4752000
    ## 2 Continental 31536000
    ## 3    Moderate  4752000
    ## 5      Tropic  4752000

``` r
World$fetchData("x_RegSea2Cont")
```

    ##         FlowName fromScale     toScale fromSubCompart toSubCompart     flow
    ## 17 x_RegSea2Cont  Regional Continental            sea          sea 13698.54

``` r
flow6 <- World$NewFlow("x_ToModerateWater")

flow6$FromAndTo
```

    ##      fromScale  toScale fromSubCompart
    ## 2       Arctic Moderate            sea
    ## 3       Arctic Moderate      deepocean
    ## 5  Continental Moderate            sea
    ## 30      Tropic Moderate            sea
    ## 31      Tropic Moderate      deepocean

``` r
flow6$execute()
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 34 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##     fromScale  toScale fromSubCompart      flow
    ## 1      Arctic Moderate            sea         0
    ## 2      Arctic Moderate      deepocean 150000000
    ## 3 Continental Moderate            sea  23536593
    ## 4      Tropic Moderate            sea 150000000
    ## 5      Tropic Moderate      deepocean         0

``` r
World$CalcVar("x_ToModerateWater")
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 34 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##            FlowName   fromScale  toScale fromSubCompart toSubCompart      flow
    ## 1 x_ToModerateWater      Arctic Moderate      deepocean    deepocean 150000000
    ## 2 x_ToModerateWater      Arctic Moderate            sea          sea         0
    ## 3 x_ToModerateWater Continental Moderate            sea          sea  23536593
    ## 4 x_ToModerateWater      Tropic Moderate      deepocean    deepocean         0
    ## 5 x_ToModerateWater      Tropic Moderate            sea          sea 150000000

### Water flow from Moderate Scale

*7. x_FromModerate2TropWater*

Separated in different flows based on the to Scale

``` r
World$fetchData("Volume")
```

    ##          Scale         SubCompart       Volume
    ## 2       Arctic                air 4.249999e+16
    ## 4       Arctic          deepocean 7.650000e+16
    ## 8       Arctic     marinesediment 7.650000e+11
    ## 9       Arctic        naturalsoil 8.500000e+11
    ## 12      Arctic                sea 2.550000e+15
    ## 13 Continental   agriculturalsoil 4.183008e+11
    ## 14 Continental                air 7.199248e+15
    ## 17 Continental freshwatersediment 2.875818e+09
    ## 18 Continental               lake 8.714600e+11
    ## 19 Continental       lakesediment 2.614380e+08
    ## 20 Continental     marinesediment 1.114023e+11
    ## 21 Continental        naturalsoil 4.705884e+10
    ## 22 Continental          othersoil 1.742920e+10
    ## 23 Continental              river 2.875818e+11
    ## 24 Continental                sea 7.426820e+14
    ## 26    Moderate                air 7.757116e+16
    ## 28    Moderate          deepocean 1.163568e+17
    ## 32    Moderate     marinesediment 1.163568e+12
    ## 33    Moderate        naturalsoil 1.939280e+12
    ## 36    Moderate                sea 3.878559e+15
    ## 37    Regional   agriculturalsoil 2.742840e+10
    ## 38    Regional                air 2.295699e+14
    ## 41    Regional freshwatersediment 1.885702e+08
    ## 42    Regional               lake 5.714250e+10
    ## 43    Regional       lakesediment 1.714275e+07
    ## 44    Regional     marinesediment 3.000000e+07
    ## 45    Regional        naturalsoil 3.085695e+09
    ## 46    Regional          othersoil 1.142850e+09
    ## 47    Regional              river 1.885702e+10
    ## 48    Regional                sea 1.000000e+10
    ## 50      Tropic                air 1.275000e+17
    ## 52      Tropic          deepocean 2.677500e+17
    ## 56      Tropic     marinesediment 2.677500e+12
    ## 57      Tropic        naturalsoil 1.912500e+12
    ## 60      Tropic                sea 8.925000e+15

``` r
World$fetchData("TAUsea")
```

    ##         Scale   TAUsea
    ## 1      Arctic  4752000
    ## 2 Continental 31536000
    ## 3    Moderate  4752000
    ## 5      Tropic  4752000

``` r
World$fetchData("OceanCurrent")
```

    ## [1] 1.5e+08

``` r
World$fetchData("x_RegSea2Cont")
```

    ##         FlowName fromScale     toScale fromSubCompart toSubCompart     flow
    ## 17 x_RegSea2Cont  Regional Continental            sea          sea 13698.54

``` r
World$fetchData("ScaleName")
```

    ##         Scale   ScaleName
    ## 1      Arctic      Arctic
    ## 2 Continental Continental
    ## 3    Moderate    Moderate
    ## 4    Regional    Regional
    ## 5      Tropic      Tropic

``` r
flow <- World$NewFlow("x_FromModerate2TropWater")
# flow$execute(debugAt = list())
flow$FromAndTo
```

    ##    fromScale toScale fromSubCompart
    ## 20  Moderate  Tropic            sea
    ## 21  Moderate  Tropic      deepocean

``` r
flow$execute()
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 45 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##   fromScale toScale fromSubCompart    flow
    ## 1  Moderate  Tropic            sea 0.0e+00
    ## 2  Moderate  Tropic      deepocean 1.5e+08

``` r
World$CalcVar("x_FromModerate2TropWater")
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 45 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##                   FlowName fromScale toScale fromSubCompart toSubCompart
    ## 1 x_FromModerate2TropWater  Moderate  Tropic      deepocean    deepocean
    ## 2 x_FromModerate2TropWater  Moderate  Tropic            sea          sea
    ##      flow
    ## 1 1.5e+08
    ## 2 0.0e+00

*8. x_FromModerate2ArctWater*

``` r
World$fetchData("OceanCurrent")
```

    ## [1] 1.5e+08

``` r
World$fetchData("ScaleName")
```

    ##         Scale   ScaleName
    ## 1      Arctic      Arctic
    ## 2 Continental Continental
    ## 3    Moderate    Moderate
    ## 4    Regional    Regional
    ## 5      Tropic      Tropic

``` r
flow <- World$NewFlow("x_FromModerate2ArctWater")
# flow$execute(debugAt = list())
flow$FromAndTo
```

    ##    fromScale toScale fromSubCompart
    ## 15  Moderate  Arctic            sea
    ## 16  Moderate  Arctic      deepocean

``` r
flow$execute()
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 23 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##   fromScale toScale fromSubCompart    flow
    ## 1  Moderate  Arctic            sea 1.5e+08
    ## 2  Moderate  Arctic      deepocean 0.0e+00

``` r
World$CalcVar("x_FromModerate2ArctWater")
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toScale == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 23 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##                   FlowName fromScale toScale fromSubCompart toSubCompart
    ## 1 x_FromModerate2ArctWater  Moderate  Arctic      deepocean    deepocean
    ## 2 x_FromModerate2ArctWater  Moderate  Arctic            sea          sea
    ##      flow
    ## 1 0.0e+00
    ## 2 1.5e+08

*9. x_FromModerate2ContWater*

``` r
# required data:
World$fetchData("Volume")
```

    ##          Scale         SubCompart       Volume
    ## 2       Arctic                air 4.249999e+16
    ## 4       Arctic          deepocean 7.650000e+16
    ## 8       Arctic     marinesediment 7.650000e+11
    ## 9       Arctic        naturalsoil 8.500000e+11
    ## 12      Arctic                sea 2.550000e+15
    ## 13 Continental   agriculturalsoil 4.183008e+11
    ## 14 Continental                air 7.199248e+15
    ## 17 Continental freshwatersediment 2.875818e+09
    ## 18 Continental               lake 8.714600e+11
    ## 19 Continental       lakesediment 2.614380e+08
    ## 20 Continental     marinesediment 1.114023e+11
    ## 21 Continental        naturalsoil 4.705884e+10
    ## 22 Continental          othersoil 1.742920e+10
    ## 23 Continental              river 2.875818e+11
    ## 24 Continental                sea 7.426820e+14
    ## 26    Moderate                air 7.757116e+16
    ## 28    Moderate          deepocean 1.163568e+17
    ## 32    Moderate     marinesediment 1.163568e+12
    ## 33    Moderate        naturalsoil 1.939280e+12
    ## 36    Moderate                sea 3.878559e+15
    ## 37    Regional   agriculturalsoil 2.742840e+10
    ## 38    Regional                air 2.295699e+14
    ## 41    Regional freshwatersediment 1.885702e+08
    ## 42    Regional               lake 5.714250e+10
    ## 43    Regional       lakesediment 1.714275e+07
    ## 44    Regional     marinesediment 3.000000e+07
    ## 45    Regional        naturalsoil 3.085695e+09
    ## 46    Regional          othersoil 1.142850e+09
    ## 47    Regional              river 1.885702e+10
    ## 48    Regional                sea 1.000000e+10
    ## 50      Tropic                air 1.275000e+17
    ## 52      Tropic          deepocean 2.677500e+17
    ## 56      Tropic     marinesediment 2.677500e+12
    ## 57      Tropic        naturalsoil 1.912500e+12
    ## 60      Tropic                sea 8.925000e+15

``` r
World$fetchData("TAUsea")
```

    ##         Scale   TAUsea
    ## 1      Arctic  4752000
    ## 2 Continental 31536000
    ## 3    Moderate  4752000
    ## 5      Tropic  4752000

``` r
World$fetchData("OceanCurrent")
```

    ## [1] 1.5e+08

``` r
World$fetchData("x_RegSea2Cont")
```

    ##         FlowName fromScale     toScale fromSubCompart toSubCompart     flow
    ## 17 x_RegSea2Cont  Regional Continental            sea          sea 13698.54

``` r
World$fetchData("ScaleName")
```

    ##         Scale   ScaleName
    ## 1      Arctic      Arctic
    ## 2 Continental Continental
    ## 3    Moderate    Moderate
    ## 4    Regional    Regional
    ## 5      Tropic      Tropic

``` r
flow <- World$NewFlow("x_FromModerate2ContWater")
# flow$execute(debugAt = list())
flow$FromAndTo
```

    ##    fromScale     toScale fromSubCompart
    ## 18  Moderate Continental            sea

``` r
flow$execute()
```

    ##   fromScale     toScale fromSubCompart     flow
    ## 1  Moderate Continental            sea 23536593

``` r
World$CalcVar("x_FromModerate2ContWater")
```

    ##                   FlowName fromScale     toScale fromSubCompart toSubCompart
    ## 1 x_FromModerate2ContWater  Moderate Continental            sea          sea
    ##       flow
    ## 1 23536593

*10. x_OceanMixing2Deep*

``` r
x_OceanMixing2Deep
```

    ## function (Volume, TAUsea, OceanCurrent, ScaleName, SubCompartName) 
    ## {
    ##     switch(SubCompartName, sea = {
    ##         OceanMixingFlow <- Volume/TAUsea
    ##         if (ScaleName %in% c("Moderate", "Arctic", "Tropic")) {
    ##             return((OceanMixingFlow + OceanCurrent))
    ##         } else {
    ##             return(NA)
    ##         }
    ##     }, return(NA))
    ## }
    ## <bytecode: 0x562fbd1db750>

``` r
World$fetchData("Volume")
```

    ##          Scale         SubCompart       Volume
    ## 2       Arctic                air 4.249999e+16
    ## 4       Arctic          deepocean 7.650000e+16
    ## 8       Arctic     marinesediment 7.650000e+11
    ## 9       Arctic        naturalsoil 8.500000e+11
    ## 12      Arctic                sea 2.550000e+15
    ## 13 Continental   agriculturalsoil 4.183008e+11
    ## 14 Continental                air 7.199248e+15
    ## 17 Continental freshwatersediment 2.875818e+09
    ## 18 Continental               lake 8.714600e+11
    ## 19 Continental       lakesediment 2.614380e+08
    ## 20 Continental     marinesediment 1.114023e+11
    ## 21 Continental        naturalsoil 4.705884e+10
    ## 22 Continental          othersoil 1.742920e+10
    ## 23 Continental              river 2.875818e+11
    ## 24 Continental                sea 7.426820e+14
    ## 26    Moderate                air 7.757116e+16
    ## 28    Moderate          deepocean 1.163568e+17
    ## 32    Moderate     marinesediment 1.163568e+12
    ## 33    Moderate        naturalsoil 1.939280e+12
    ## 36    Moderate                sea 3.878559e+15
    ## 37    Regional   agriculturalsoil 2.742840e+10
    ## 38    Regional                air 2.295699e+14
    ## 41    Regional freshwatersediment 1.885702e+08
    ## 42    Regional               lake 5.714250e+10
    ## 43    Regional       lakesediment 1.714275e+07
    ## 44    Regional     marinesediment 3.000000e+07
    ## 45    Regional        naturalsoil 3.085695e+09
    ## 46    Regional          othersoil 1.142850e+09
    ## 47    Regional              river 1.885702e+10
    ## 48    Regional                sea 1.000000e+10
    ## 50      Tropic                air 1.275000e+17
    ## 52      Tropic          deepocean 2.677500e+17
    ## 56      Tropic     marinesediment 2.677500e+12
    ## 57      Tropic        naturalsoil 1.912500e+12
    ## 60      Tropic                sea 8.925000e+15

``` r
World$fetchData("TAUsea")
```

    ##         Scale   TAUsea
    ## 1      Arctic  4752000
    ## 2 Continental 31536000
    ## 3    Moderate  4752000
    ## 5      Tropic  4752000

``` r
World$fetchData("OceanCurrent")
```

    ## [1] 1.5e+08

``` r
World$fetchData("SubCompartName")
```

    ##            SubCompart     SubCompartName
    ## 1    agriculturalsoil   agriculturalsoil
    ## 2                 air                air
    ## 3          cloudwater         cloudwater
    ## 4           deepocean          deepocean
    ## 5  freshwatersediment freshwatersediment
    ## 6                lake               lake
    ## 7        lakesediment       lakesediment
    ## 8      marinesediment     marinesediment
    ## 9         naturalsoil        naturalsoil
    ## 10          othersoil          othersoil
    ## 11              river              river
    ## 12                sea                sea

``` r
flow <- World$NewFlow("x_OceanMixing2Deep")

flow$FromAndTo
```

    ##    fromSubCompart toSubCompart fromScale
    ## 26            sea    deepocean  Moderate
    ## 27            sea    deepocean    Tropic
    ## 28            sea    deepocean    Arctic

``` r
flow$execute()
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 5 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##   fromSubCompart toSubCompart fromScale       flow
    ## 1            sea    deepocean  Moderate  966195076
    ## 2            sea    deepocean    Tropic 2028156566
    ## 3            sea    deepocean    Arctic  686616162

``` r
World$CalcVar("x_OceanMixing2Deep")
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 5 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##             FlowName fromScale  toScale fromSubCompart toSubCompart       flow
    ## 1 x_OceanMixing2Deep    Arctic   Arctic            sea    deepocean  686616162
    ## 2 x_OceanMixing2Deep  Moderate Moderate            sea    deepocean  966195076
    ## 3 x_OceanMixing2Deep    Tropic   Tropic            sea    deepocean 2028156566

*11. x_OceanMixing2Sea*

``` r
x_OceanMixing2Sea
```

    ## function (all.Volume, TAUsea, OceanCurrent, SubCompartName, ScaleName) 
    ## {
    ##     switch(SubCompartName, deepocean = {
    ##         toVolume <- all.Volume$Volume[all.Volume$SubCompart == 
    ##             "sea" & all.Volume$Scale == ScaleName]
    ##         OceanMixingFlow <- toVolume/TAUsea
    ##         if (ScaleName %in% c("Moderate", "Tropic", "Arctic")) {
    ##             return((OceanMixingFlow + OceanCurrent))
    ##         } else return(NA)
    ##     }, return(NA))
    ## }
    ## <bytecode: 0x562fbd43d820>

``` r
World$fetchData("Volume")
```

    ##          Scale         SubCompart       Volume
    ## 2       Arctic                air 4.249999e+16
    ## 4       Arctic          deepocean 7.650000e+16
    ## 8       Arctic     marinesediment 7.650000e+11
    ## 9       Arctic        naturalsoil 8.500000e+11
    ## 12      Arctic                sea 2.550000e+15
    ## 13 Continental   agriculturalsoil 4.183008e+11
    ## 14 Continental                air 7.199248e+15
    ## 17 Continental freshwatersediment 2.875818e+09
    ## 18 Continental               lake 8.714600e+11
    ## 19 Continental       lakesediment 2.614380e+08
    ## 20 Continental     marinesediment 1.114023e+11
    ## 21 Continental        naturalsoil 4.705884e+10
    ## 22 Continental          othersoil 1.742920e+10
    ## 23 Continental              river 2.875818e+11
    ## 24 Continental                sea 7.426820e+14
    ## 26    Moderate                air 7.757116e+16
    ## 28    Moderate          deepocean 1.163568e+17
    ## 32    Moderate     marinesediment 1.163568e+12
    ## 33    Moderate        naturalsoil 1.939280e+12
    ## 36    Moderate                sea 3.878559e+15
    ## 37    Regional   agriculturalsoil 2.742840e+10
    ## 38    Regional                air 2.295699e+14
    ## 41    Regional freshwatersediment 1.885702e+08
    ## 42    Regional               lake 5.714250e+10
    ## 43    Regional       lakesediment 1.714275e+07
    ## 44    Regional     marinesediment 3.000000e+07
    ## 45    Regional        naturalsoil 3.085695e+09
    ## 46    Regional          othersoil 1.142850e+09
    ## 47    Regional              river 1.885702e+10
    ## 48    Regional                sea 1.000000e+10
    ## 50      Tropic                air 1.275000e+17
    ## 52      Tropic          deepocean 2.677500e+17
    ## 56      Tropic     marinesediment 2.677500e+12
    ## 57      Tropic        naturalsoil 1.912500e+12
    ## 60      Tropic                sea 8.925000e+15

``` r
World$fetchData("TAUsea")
```

    ##         Scale   TAUsea
    ## 1      Arctic  4752000
    ## 2 Continental 31536000
    ## 3    Moderate  4752000
    ## 5      Tropic  4752000

``` r
World$fetchData("OceanCurrent")
```

    ## [1] 1.5e+08

``` r
World$fetchData("SubCompartName")
```

    ##            SubCompart     SubCompartName
    ## 1    agriculturalsoil   agriculturalsoil
    ## 2                 air                air
    ## 3          cloudwater         cloudwater
    ## 4           deepocean          deepocean
    ## 5  freshwatersediment freshwatersediment
    ## 6                lake               lake
    ## 7        lakesediment       lakesediment
    ## 8      marinesediment     marinesediment
    ## 9         naturalsoil        naturalsoil
    ## 10          othersoil          othersoil
    ## 11              river              river
    ## 12                sea                sea

``` r
flow <- World$NewFlow("x_OceanMixing2Sea")

flow$FromAndTo
```

    ##    fromSubCompart toSubCompart fromScale
    ## 9       deepocean          sea  Moderate
    ## 10      deepocean          sea    Tropic
    ## 11      deepocean          sea    Arctic

``` r
flow$execute()
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 4 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##   fromSubCompart toSubCompart fromScale       flow
    ## 1      deepocean          sea  Moderate  966195076
    ## 2      deepocean          sea    Tropic 2028156566
    ## 3      deepocean          sea    Arctic  686616162

``` r
World$CalcVar("x_OceanMixing2Sea")
```

    ## Warning in dplyr::inner_join(AllIn, private$MyCore$states$asDataFrame, join_by(toSubCompart == : Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 4 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

    ##            FlowName fromScale  toScale fromSubCompart toSubCompart       flow
    ## 1 x_OceanMixing2Sea    Arctic   Arctic      deepocean          sea  686616162
    ## 2 x_OceanMixing2Sea  Moderate Moderate      deepocean          sea  966195076
    ## 3 x_OceanMixing2Sea    Tropic   Tropic      deepocean          sea 2028156566

#### Overview of water flows

Overview of flows included above (excludes surface - deep ocean mixing
and ocean currents at global scales)

``` r
flows = World$moduleList[["k_Advection"]]$WithFlow

flux2Test <- World$fetchData("Flows")
flux2Test <- flux2Test[flux2Test$FlowName %in% flows & flux2Test$fromSubCompart %in% c("river","sea","lake","deepocean"),]
flux2Test$fromScale <- factor(flux2Test$fromScale, levels = c("Regional", "Continental", "Moderate","Arctic","Tropic")) #force order
flux2Test$toScale <- factor(flux2Test$toScale, levels = c("Regional", "Continental", "Moderate","Arctic","Tropic")) #force order
flux2Test$fromSubCompart <- factor(flux2Test$fromSubCompart, levels = c("lake", "river", "sea","deepocean")) #force order
flux2Test$toSubCompart <- factor(flux2Test$toSubCompart, levels = c("lake", "river", "sea","deepocean")) #force order
f2Torder <- order(flux2Test$fromScale, flux2Test$fromSubCompart, flux2Test$toScale, flux2Test$toSubCompart)

flux2Test$fcolumns <- do.call(paste, c(flux2Test[c("fromScale", "fromSubCompart")], sep="."))
flux2Test$frows <- do.call(paste, c(flux2Test[c("toScale", "toSubCompart")], sep = "."))
#flux2Test$flux = 10e9 * flux2Test$flux # tune unit 

table1 <- pivot_wider(flux2Test[f2Torder,c("frows","fcolumns","flow")],
            id_cols = frows, names_from = fcolumns, values_from = flow)

print(table1, n=40)
```

    ## # A tibble: 10 × 13
    ##    frows              Regional.lake Regional.river Regional.sea Continental.lake
    ##    <chr>                      <dbl>          <dbl>        <dbl>            <dbl>
    ##  1 Regional.river              137.            NA           NA               NA 
    ##  2 Regional.sea                 NA           1370.          NA               NA 
    ##  3 Continental.sea              NA             NA        13699.              NA 
    ##  4 Continental.river            NA             NA           NA             2089.
    ##  5 Moderate.sea                 NA             NA           NA               NA 
    ##  6 Moderate.deepocean           NA             NA           NA               NA 
    ##  7 Arctic.sea                   NA             NA           NA               NA 
    ##  8 Tropic.sea                   NA             NA           NA               NA 
    ##  9 Arctic.deepocean             NA             NA           NA               NA 
    ## 10 Tropic.deepocean             NA             NA           NA               NA 
    ## # ℹ 8 more variables: Continental.river <dbl>, Continental.sea <dbl>,
    ## #   Moderate.sea <dbl>, Moderate.deepocean <dbl>, Arctic.sea <dbl>,
    ## #   Arctic.deepocean <dbl>, Tropic.sea <dbl>, Tropic.deepocean <dbl>

#### Advection rate constant

This process is only one step beyond the calculation of the relevant
flows, see the function f_Advection. All flows are by default associated
with this process. “flow” is used as special keyword, there is no SB
variable with the name flow. You can find the values by fetching
“Flows”. This also means the script to get the k_Advection is a little
different from other k’s. See below:

``` r
World$fetchData("Flows")
```

    ##                     FlowName   fromScale     toScale fromSubCompart
    ## 12           x_Advection_Air      Arctic    Moderate            air
    ## 210          x_Advection_Air Continental    Moderate            air
    ## 32           x_Advection_Air Continental    Regional            air
    ## 41           x_Advection_Air    Moderate      Arctic            air
    ## 51           x_Advection_Air    Moderate Continental            air
    ## 61           x_Advection_Air    Moderate      Tropic            air
    ## 71           x_Advection_Air    Regional Continental            air
    ## 81           x_Advection_Air      Tropic    Moderate            air
    ## 13           x_ContRiver2Reg Continental    Regional          river
    ## 14          x_RiverDischarge    Regional    Regional          river
    ## 21          x_RiverDischarge Continental Continental          river
    ## 15             x_LakeOutflow    Regional    Regional           lake
    ## 23             x_LakeOutflow Continental Continental           lake
    ## 16             x_ContSea2Reg Continental    Regional            sea
    ## 17             x_RegSea2Cont    Regional Continental            sea
    ## 18         x_ToModerateWater      Arctic    Moderate            sea
    ## 22         x_ToModerateWater      Arctic    Moderate      deepocean
    ## 31         x_ToModerateWater Continental    Moderate            sea
    ## 42         x_ToModerateWater      Tropic    Moderate            sea
    ## 5          x_ToModerateWater      Tropic    Moderate      deepocean
    ## 19  x_FromModerate2TropWater    Moderate      Tropic            sea
    ## 24  x_FromModerate2TropWater    Moderate      Tropic      deepocean
    ## 1   x_FromModerate2ArctWater    Moderate      Arctic            sea
    ## 2   x_FromModerate2ArctWater    Moderate      Arctic      deepocean
    ## 110 x_FromModerate2ContWater    Moderate Continental            sea
    ## 111       x_OceanMixing2Deep    Moderate    Moderate            sea
    ## 25        x_OceanMixing2Deep      Tropic      Tropic            sea
    ## 3         x_OceanMixing2Deep      Arctic      Arctic            sea
    ## 11         x_OceanMixing2Sea    Moderate    Moderate      deepocean
    ## 26         x_OceanMixing2Sea      Tropic      Tropic      deepocean
    ## 33         x_OceanMixing2Sea      Arctic      Arctic      deepocean
    ##     toSubCompart         flow
    ## 12           air 2.942452e+10
    ## 210          air 9.947820e+09
    ## 32           air 2.162582e+09
    ## 41           air 2.942452e+10
    ## 51           air 9.947820e+09
    ## 61           air 5.096476e+10
    ## 71           air 2.162582e+09
    ## 81           air 5.096476e+10
    ## 13         river 0.000000e+00
    ## 14           sea 1.369854e+03
    ## 21           sea 2.089116e+04
    ## 15         river 1.369854e+02
    ## 23         river 2.089116e+03
    ## 16           sea 1.232869e+04
    ## 17           sea 1.369854e+04
    ## 18           sea 0.000000e+00
    ## 22     deepocean 1.500000e+08
    ## 31           sea 2.353659e+07
    ## 42           sea 1.500000e+08
    ## 5      deepocean 0.000000e+00
    ## 19           sea 0.000000e+00
    ## 24     deepocean 1.500000e+08
    ## 1            sea 1.500000e+08
    ## 2      deepocean 0.000000e+00
    ## 110          sea 2.353659e+07
    ## 111    deepocean 9.661951e+08
    ## 25     deepocean 2.028157e+09
    ## 3      deepocean 6.866162e+08
    ## 11           sea 9.661951e+08
    ## 26           sea 2.028157e+09
    ## 33           sea 6.866162e+08

``` r
# Don't create a new process like: World$FromDataAndTo("k_Advection")
# find the existing one like this:
testProc <- World$moduleList[["k_Advection"]]
# FromDataAndTo is from and to from the data, ultimately the property is used
# which can derived from the flows for Advection
FAT <- testProc$FromAndTo
# the data frmae to be calculated:
left_join(rename(FAT, "Scale" = "fromScale", "SubCompart" = "fromSubCompart"), World$fetchData("Volume"))
```

    ## Joining with `by = join_by(Scale, SubCompart)`

    ##           Scale     toScale SubCompart toSubCompart     process fromSpecies
    ## 1        Arctic    Moderate        air          air k_Advection       Large
    ## 2   Continental    Moderate        air          air k_Advection       Large
    ## 3   Continental    Regional        air          air k_Advection       Large
    ## 4      Moderate      Arctic        air          air k_Advection       Large
    ## 5      Moderate Continental        air          air k_Advection       Large
    ## 6      Moderate      Tropic        air          air k_Advection       Large
    ## 7      Regional Continental        air          air k_Advection       Large
    ## 8        Tropic    Moderate        air          air k_Advection       Large
    ## 9   Continental    Regional      river        river k_Advection       Large
    ## 10  Continental    Regional        sea          sea k_Advection       Large
    ## 11     Moderate      Arctic        sea          sea k_Advection       Large
    ## 12     Moderate      Arctic  deepocean    deepocean k_Advection       Large
    ## 13     Moderate Continental        sea          sea k_Advection       Large
    ## 14     Moderate      Tropic        sea          sea k_Advection       Large
    ## 15     Moderate      Tropic  deepocean    deepocean k_Advection       Large
    ## 16     Regional    Regional       lake        river k_Advection       Large
    ## 17  Continental Continental       lake        river k_Advection       Large
    ## 18     Moderate    Moderate        sea    deepocean k_Advection       Large
    ## 19       Tropic      Tropic        sea    deepocean k_Advection       Large
    ## 20       Arctic      Arctic        sea    deepocean k_Advection       Large
    ## 21     Moderate    Moderate  deepocean          sea k_Advection       Large
    ## 22       Tropic      Tropic  deepocean          sea k_Advection       Large
    ## 23       Arctic      Arctic  deepocean          sea k_Advection       Large
    ## 24     Regional Continental        sea          sea k_Advection       Large
    ## 25     Regional    Regional      river          sea k_Advection       Large
    ## 26  Continental Continental      river          sea k_Advection       Large
    ## 27       Arctic    Moderate        sea          sea k_Advection       Large
    ## 28       Arctic    Moderate  deepocean    deepocean k_Advection       Large
    ## 29  Continental    Moderate        sea          sea k_Advection       Large
    ## 30       Tropic    Moderate        sea          sea k_Advection       Large
    ## 31       Tropic    Moderate  deepocean    deepocean k_Advection       Large
    ## 32       Arctic    Moderate        air          air k_Advection       Large
    ## 33  Continental    Moderate        air          air k_Advection       Large
    ## 34  Continental    Regional        air          air k_Advection       Large
    ## 35     Moderate      Arctic        air          air k_Advection       Large
    ## 36     Moderate Continental        air          air k_Advection       Large
    ## 37     Moderate      Tropic        air          air k_Advection       Large
    ## 38     Regional Continental        air          air k_Advection       Large
    ## 39       Tropic    Moderate        air          air k_Advection       Large
    ## 40  Continental    Regional      river        river k_Advection       Large
    ## 41     Regional    Regional      river          sea k_Advection       Large
    ## 42  Continental Continental      river          sea k_Advection       Large
    ## 43     Regional    Regional       lake        river k_Advection       Large
    ## 44  Continental Continental       lake        river k_Advection       Large
    ## 45  Continental    Regional        sea          sea k_Advection       Large
    ## 46     Regional Continental        sea          sea k_Advection       Large
    ## 47       Arctic    Moderate        sea          sea k_Advection       Large
    ## 48       Arctic    Moderate  deepocean    deepocean k_Advection       Large
    ## 49  Continental    Moderate        sea          sea k_Advection       Large
    ## 50       Tropic    Moderate        sea          sea k_Advection       Large
    ## 51       Tropic    Moderate  deepocean    deepocean k_Advection       Large
    ## 52     Moderate      Tropic        sea          sea k_Advection       Large
    ## 53     Moderate      Tropic  deepocean    deepocean k_Advection       Large
    ## 54     Moderate      Arctic        sea          sea k_Advection       Large
    ## 55     Moderate      Arctic  deepocean    deepocean k_Advection       Large
    ## 56     Moderate Continental        sea          sea k_Advection       Large
    ## 57     Moderate    Moderate        sea    deepocean k_Advection       Large
    ## 58       Tropic      Tropic        sea    deepocean k_Advection       Large
    ## 59       Arctic      Arctic        sea    deepocean k_Advection       Large
    ## 60     Moderate    Moderate  deepocean          sea k_Advection       Large
    ## 61       Tropic      Tropic  deepocean          sea k_Advection       Large
    ## 62       Arctic      Arctic  deepocean          sea k_Advection       Large
    ## 63       Arctic    Moderate        air          air k_Advection       Small
    ## 64  Continental    Moderate        air          air k_Advection       Small
    ## 65  Continental    Regional        air          air k_Advection       Small
    ## 66     Moderate      Arctic        air          air k_Advection       Small
    ## 67     Moderate Continental        air          air k_Advection       Small
    ## 68     Moderate      Tropic        air          air k_Advection       Small
    ## 69     Regional Continental        air          air k_Advection       Small
    ## 70       Tropic    Moderate        air          air k_Advection       Small
    ## 71  Continental    Regional      river        river k_Advection       Small
    ## 72  Continental    Regional        sea          sea k_Advection       Small
    ## 73     Moderate      Arctic        sea          sea k_Advection       Small
    ## 74     Moderate      Arctic  deepocean    deepocean k_Advection       Small
    ## 75     Moderate Continental        sea          sea k_Advection       Small
    ## 76     Moderate      Tropic        sea          sea k_Advection       Small
    ## 77     Moderate      Tropic  deepocean    deepocean k_Advection       Small
    ## 78     Regional    Regional       lake        river k_Advection       Small
    ## 79  Continental Continental       lake        river k_Advection       Small
    ## 80     Moderate    Moderate        sea    deepocean k_Advection       Small
    ## 81       Tropic      Tropic        sea    deepocean k_Advection       Small
    ## 82       Arctic      Arctic        sea    deepocean k_Advection       Small
    ## 83     Moderate    Moderate  deepocean          sea k_Advection       Small
    ## 84       Tropic      Tropic  deepocean          sea k_Advection       Small
    ## 85       Arctic      Arctic  deepocean          sea k_Advection       Small
    ## 86     Regional Continental        sea          sea k_Advection       Small
    ## 87     Regional    Regional      river          sea k_Advection       Small
    ## 88  Continental Continental      river          sea k_Advection       Small
    ## 89       Arctic    Moderate        sea          sea k_Advection       Small
    ## 90       Arctic    Moderate  deepocean    deepocean k_Advection       Small
    ## 91  Continental    Moderate        sea          sea k_Advection       Small
    ## 92       Tropic    Moderate        sea          sea k_Advection       Small
    ## 93       Tropic    Moderate  deepocean    deepocean k_Advection       Small
    ## 94       Arctic    Moderate        air          air k_Advection       Small
    ## 95  Continental    Moderate        air          air k_Advection       Small
    ## 96  Continental    Regional        air          air k_Advection       Small
    ## 97     Moderate      Arctic        air          air k_Advection       Small
    ## 98     Moderate Continental        air          air k_Advection       Small
    ## 99     Moderate      Tropic        air          air k_Advection       Small
    ## 100    Regional Continental        air          air k_Advection       Small
    ## 101      Tropic    Moderate        air          air k_Advection       Small
    ## 102 Continental    Regional      river        river k_Advection       Small
    ## 103    Regional    Regional      river          sea k_Advection       Small
    ## 104 Continental Continental      river          sea k_Advection       Small
    ## 105    Regional    Regional       lake        river k_Advection       Small
    ## 106 Continental Continental       lake        river k_Advection       Small
    ## 107 Continental    Regional        sea          sea k_Advection       Small
    ## 108    Regional Continental        sea          sea k_Advection       Small
    ## 109      Arctic    Moderate        sea          sea k_Advection       Small
    ## 110      Arctic    Moderate  deepocean    deepocean k_Advection       Small
    ## 111 Continental    Moderate        sea          sea k_Advection       Small
    ## 112      Tropic    Moderate        sea          sea k_Advection       Small
    ## 113      Tropic    Moderate  deepocean    deepocean k_Advection       Small
    ## 114    Moderate      Tropic        sea          sea k_Advection       Small
    ## 115    Moderate      Tropic  deepocean    deepocean k_Advection       Small
    ## 116    Moderate      Arctic        sea          sea k_Advection       Small
    ## 117    Moderate      Arctic  deepocean    deepocean k_Advection       Small
    ## 118    Moderate Continental        sea          sea k_Advection       Small
    ## 119    Moderate    Moderate        sea    deepocean k_Advection       Small
    ## 120      Tropic      Tropic        sea    deepocean k_Advection       Small
    ## 121      Arctic      Arctic        sea    deepocean k_Advection       Small
    ## 122    Moderate    Moderate  deepocean          sea k_Advection       Small
    ## 123      Tropic      Tropic  deepocean          sea k_Advection       Small
    ## 124      Arctic      Arctic  deepocean          sea k_Advection       Small
    ## 125      Arctic    Moderate        air          air k_Advection       Solid
    ## 126 Continental    Moderate        air          air k_Advection       Solid
    ## 127 Continental    Regional        air          air k_Advection       Solid
    ## 128    Moderate      Arctic        air          air k_Advection       Solid
    ## 129    Moderate Continental        air          air k_Advection       Solid
    ## 130    Moderate      Tropic        air          air k_Advection       Solid
    ## 131    Regional Continental        air          air k_Advection       Solid
    ## 132      Tropic    Moderate        air          air k_Advection       Solid
    ## 133 Continental    Regional      river        river k_Advection       Solid
    ## 134 Continental    Regional        sea          sea k_Advection       Solid
    ## 135    Moderate      Arctic        sea          sea k_Advection       Solid
    ## 136    Moderate      Arctic  deepocean    deepocean k_Advection       Solid
    ## 137    Moderate Continental        sea          sea k_Advection       Solid
    ## 138    Moderate      Tropic        sea          sea k_Advection       Solid
    ## 139    Moderate      Tropic  deepocean    deepocean k_Advection       Solid
    ## 140    Regional    Regional       lake        river k_Advection       Solid
    ## 141 Continental Continental       lake        river k_Advection       Solid
    ## 142    Moderate    Moderate        sea    deepocean k_Advection       Solid
    ## 143      Tropic      Tropic        sea    deepocean k_Advection       Solid
    ## 144      Arctic      Arctic        sea    deepocean k_Advection       Solid
    ## 145    Moderate    Moderate  deepocean          sea k_Advection       Solid
    ## 146      Tropic      Tropic  deepocean          sea k_Advection       Solid
    ## 147      Arctic      Arctic  deepocean          sea k_Advection       Solid
    ## 148    Regional Continental        sea          sea k_Advection       Solid
    ## 149    Regional    Regional      river          sea k_Advection       Solid
    ## 150 Continental Continental      river          sea k_Advection       Solid
    ## 151      Arctic    Moderate        sea          sea k_Advection       Solid
    ## 152      Arctic    Moderate  deepocean    deepocean k_Advection       Solid
    ## 153 Continental    Moderate        sea          sea k_Advection       Solid
    ## 154      Tropic    Moderate        sea          sea k_Advection       Solid
    ## 155      Tropic    Moderate  deepocean    deepocean k_Advection       Solid
    ## 156      Arctic    Moderate        air          air k_Advection       Solid
    ## 157 Continental    Moderate        air          air k_Advection       Solid
    ## 158 Continental    Regional        air          air k_Advection       Solid
    ## 159    Moderate      Arctic        air          air k_Advection       Solid
    ## 160    Moderate Continental        air          air k_Advection       Solid
    ## 161    Moderate      Tropic        air          air k_Advection       Solid
    ## 162    Regional Continental        air          air k_Advection       Solid
    ## 163      Tropic    Moderate        air          air k_Advection       Solid
    ## 164 Continental    Regional      river        river k_Advection       Solid
    ## 165    Regional    Regional      river          sea k_Advection       Solid
    ## 166 Continental Continental      river          sea k_Advection       Solid
    ## 167    Regional    Regional       lake        river k_Advection       Solid
    ## 168 Continental Continental       lake        river k_Advection       Solid
    ## 169 Continental    Regional        sea          sea k_Advection       Solid
    ## 170    Regional Continental        sea          sea k_Advection       Solid
    ## 171      Arctic    Moderate        sea          sea k_Advection       Solid
    ## 172      Arctic    Moderate  deepocean    deepocean k_Advection       Solid
    ## 173 Continental    Moderate        sea          sea k_Advection       Solid
    ## 174      Tropic    Moderate        sea          sea k_Advection       Solid
    ## 175      Tropic    Moderate  deepocean    deepocean k_Advection       Solid
    ## 176    Moderate      Tropic        sea          sea k_Advection       Solid
    ## 177    Moderate      Tropic  deepocean    deepocean k_Advection       Solid
    ## 178    Moderate      Arctic        sea          sea k_Advection       Solid
    ## 179    Moderate      Arctic  deepocean    deepocean k_Advection       Solid
    ## 180    Moderate Continental        sea          sea k_Advection       Solid
    ## 181    Moderate    Moderate        sea    deepocean k_Advection       Solid
    ## 182      Tropic      Tropic        sea    deepocean k_Advection       Solid
    ## 183      Arctic      Arctic        sea    deepocean k_Advection       Solid
    ## 184    Moderate    Moderate  deepocean          sea k_Advection       Solid
    ## 185      Tropic      Tropic  deepocean          sea k_Advection       Solid
    ## 186      Arctic      Arctic  deepocean          sea k_Advection       Solid
    ## 187      Arctic    Moderate        air          air k_Advection     Unbound
    ## 188 Continental    Moderate        air          air k_Advection     Unbound
    ## 189 Continental    Regional        air          air k_Advection     Unbound
    ## 190    Moderate      Arctic        air          air k_Advection     Unbound
    ## 191    Moderate Continental        air          air k_Advection     Unbound
    ## 192    Moderate      Tropic        air          air k_Advection     Unbound
    ## 193    Regional Continental        air          air k_Advection     Unbound
    ## 194      Tropic    Moderate        air          air k_Advection     Unbound
    ## 195 Continental    Regional      river        river k_Advection     Unbound
    ## 196 Continental    Regional        sea          sea k_Advection     Unbound
    ## 197    Moderate      Arctic        sea          sea k_Advection     Unbound
    ## 198    Moderate      Arctic  deepocean    deepocean k_Advection     Unbound
    ## 199    Moderate Continental        sea          sea k_Advection     Unbound
    ## 200    Moderate      Tropic        sea          sea k_Advection     Unbound
    ## 201    Moderate      Tropic  deepocean    deepocean k_Advection     Unbound
    ## 202    Regional    Regional       lake        river k_Advection     Unbound
    ## 203 Continental Continental       lake        river k_Advection     Unbound
    ## 204    Moderate    Moderate        sea    deepocean k_Advection     Unbound
    ## 205      Tropic      Tropic        sea    deepocean k_Advection     Unbound
    ## 206      Arctic      Arctic        sea    deepocean k_Advection     Unbound
    ## 207    Moderate    Moderate  deepocean          sea k_Advection     Unbound
    ## 208      Tropic      Tropic  deepocean          sea k_Advection     Unbound
    ## 209      Arctic      Arctic  deepocean          sea k_Advection     Unbound
    ## 210    Regional Continental        sea          sea k_Advection     Unbound
    ## 211    Regional    Regional      river          sea k_Advection     Unbound
    ## 212 Continental Continental      river          sea k_Advection     Unbound
    ## 213      Arctic    Moderate        sea          sea k_Advection     Unbound
    ## 214      Arctic    Moderate  deepocean    deepocean k_Advection     Unbound
    ## 215 Continental    Moderate        sea          sea k_Advection     Unbound
    ## 216      Tropic    Moderate        sea          sea k_Advection     Unbound
    ## 217      Tropic    Moderate  deepocean    deepocean k_Advection     Unbound
    ## 218      Arctic    Moderate        air          air k_Advection     Unbound
    ## 219 Continental    Moderate        air          air k_Advection     Unbound
    ## 220 Continental    Regional        air          air k_Advection     Unbound
    ## 221    Moderate      Arctic        air          air k_Advection     Unbound
    ## 222    Moderate Continental        air          air k_Advection     Unbound
    ## 223    Moderate      Tropic        air          air k_Advection     Unbound
    ## 224    Regional Continental        air          air k_Advection     Unbound
    ## 225      Tropic    Moderate        air          air k_Advection     Unbound
    ## 226 Continental    Regional      river        river k_Advection     Unbound
    ## 227    Regional    Regional      river          sea k_Advection     Unbound
    ## 228 Continental Continental      river          sea k_Advection     Unbound
    ## 229    Regional    Regional       lake        river k_Advection     Unbound
    ## 230 Continental Continental       lake        river k_Advection     Unbound
    ## 231 Continental    Regional        sea          sea k_Advection     Unbound
    ## 232    Regional Continental        sea          sea k_Advection     Unbound
    ## 233      Arctic    Moderate        sea          sea k_Advection     Unbound
    ## 234      Arctic    Moderate  deepocean    deepocean k_Advection     Unbound
    ## 235 Continental    Moderate        sea          sea k_Advection     Unbound
    ## 236      Tropic    Moderate        sea          sea k_Advection     Unbound
    ## 237      Tropic    Moderate  deepocean    deepocean k_Advection     Unbound
    ## 238    Moderate      Tropic        sea          sea k_Advection     Unbound
    ## 239    Moderate      Tropic  deepocean    deepocean k_Advection     Unbound
    ## 240    Moderate      Arctic        sea          sea k_Advection     Unbound
    ## 241    Moderate      Arctic  deepocean    deepocean k_Advection     Unbound
    ## 242    Moderate Continental        sea          sea k_Advection     Unbound
    ## 243    Moderate    Moderate        sea    deepocean k_Advection     Unbound
    ## 244      Tropic      Tropic        sea    deepocean k_Advection     Unbound
    ## 245      Arctic      Arctic        sea    deepocean k_Advection     Unbound
    ## 246    Moderate    Moderate  deepocean          sea k_Advection     Unbound
    ## 247      Tropic      Tropic  deepocean          sea k_Advection     Unbound
    ## 248      Arctic      Arctic  deepocean          sea k_Advection     Unbound
    ##     toSpecies       Volume
    ## 1       Large 4.249999e+16
    ## 2       Large 7.199248e+15
    ## 3       Large 7.199248e+15
    ## 4       Large 7.757116e+16
    ## 5       Large 7.757116e+16
    ## 6       Large 7.757116e+16
    ## 7       Large 2.295699e+14
    ## 8       Large 1.275000e+17
    ## 9       Large 2.875818e+11
    ## 10      Large 7.426820e+14
    ## 11      Large 3.878559e+15
    ## 12      Large 1.163568e+17
    ## 13      Large 3.878559e+15
    ## 14      Large 3.878559e+15
    ## 15      Large 1.163568e+17
    ## 16      Large 5.714250e+10
    ## 17      Large 8.714600e+11
    ## 18      Large 3.878559e+15
    ## 19      Large 8.925000e+15
    ## 20      Large 2.550000e+15
    ## 21      Large 1.163568e+17
    ## 22      Large 2.677500e+17
    ## 23      Large 7.650000e+16
    ## 24      Large 1.000000e+10
    ## 25      Large 1.885702e+10
    ## 26      Large 2.875818e+11
    ## 27      Large 2.550000e+15
    ## 28      Large 7.650000e+16
    ## 29      Large 7.426820e+14
    ## 30      Large 8.925000e+15
    ## 31      Large 2.677500e+17
    ## 32      Large 4.249999e+16
    ## 33      Large 7.199248e+15
    ## 34      Large 7.199248e+15
    ## 35      Large 7.757116e+16
    ## 36      Large 7.757116e+16
    ## 37      Large 7.757116e+16
    ## 38      Large 2.295699e+14
    ## 39      Large 1.275000e+17
    ## 40      Large 2.875818e+11
    ## 41      Large 1.885702e+10
    ## 42      Large 2.875818e+11
    ## 43      Large 5.714250e+10
    ## 44      Large 8.714600e+11
    ## 45      Large 7.426820e+14
    ## 46      Large 1.000000e+10
    ## 47      Large 2.550000e+15
    ## 48      Large 7.650000e+16
    ## 49      Large 7.426820e+14
    ## 50      Large 8.925000e+15
    ## 51      Large 2.677500e+17
    ## 52      Large 3.878559e+15
    ## 53      Large 1.163568e+17
    ## 54      Large 3.878559e+15
    ## 55      Large 1.163568e+17
    ## 56      Large 3.878559e+15
    ## 57      Large 3.878559e+15
    ## 58      Large 8.925000e+15
    ## 59      Large 2.550000e+15
    ## 60      Large 1.163568e+17
    ## 61      Large 2.677500e+17
    ## 62      Large 7.650000e+16
    ## 63      Small 4.249999e+16
    ## 64      Small 7.199248e+15
    ## 65      Small 7.199248e+15
    ## 66      Small 7.757116e+16
    ## 67      Small 7.757116e+16
    ## 68      Small 7.757116e+16
    ## 69      Small 2.295699e+14
    ## 70      Small 1.275000e+17
    ## 71      Small 2.875818e+11
    ## 72      Small 7.426820e+14
    ## 73      Small 3.878559e+15
    ## 74      Small 1.163568e+17
    ## 75      Small 3.878559e+15
    ## 76      Small 3.878559e+15
    ## 77      Small 1.163568e+17
    ## 78      Small 5.714250e+10
    ## 79      Small 8.714600e+11
    ## 80      Small 3.878559e+15
    ## 81      Small 8.925000e+15
    ## 82      Small 2.550000e+15
    ## 83      Small 1.163568e+17
    ## 84      Small 2.677500e+17
    ## 85      Small 7.650000e+16
    ## 86      Small 1.000000e+10
    ## 87      Small 1.885702e+10
    ## 88      Small 2.875818e+11
    ## 89      Small 2.550000e+15
    ## 90      Small 7.650000e+16
    ## 91      Small 7.426820e+14
    ## 92      Small 8.925000e+15
    ## 93      Small 2.677500e+17
    ## 94      Small 4.249999e+16
    ## 95      Small 7.199248e+15
    ## 96      Small 7.199248e+15
    ## 97      Small 7.757116e+16
    ## 98      Small 7.757116e+16
    ## 99      Small 7.757116e+16
    ## 100     Small 2.295699e+14
    ## 101     Small 1.275000e+17
    ## 102     Small 2.875818e+11
    ## 103     Small 1.885702e+10
    ## 104     Small 2.875818e+11
    ## 105     Small 5.714250e+10
    ## 106     Small 8.714600e+11
    ## 107     Small 7.426820e+14
    ## 108     Small 1.000000e+10
    ## 109     Small 2.550000e+15
    ## 110     Small 7.650000e+16
    ## 111     Small 7.426820e+14
    ## 112     Small 8.925000e+15
    ## 113     Small 2.677500e+17
    ## 114     Small 3.878559e+15
    ## 115     Small 1.163568e+17
    ## 116     Small 3.878559e+15
    ## 117     Small 1.163568e+17
    ## 118     Small 3.878559e+15
    ## 119     Small 3.878559e+15
    ## 120     Small 8.925000e+15
    ## 121     Small 2.550000e+15
    ## 122     Small 1.163568e+17
    ## 123     Small 2.677500e+17
    ## 124     Small 7.650000e+16
    ## 125     Solid 4.249999e+16
    ## 126     Solid 7.199248e+15
    ## 127     Solid 7.199248e+15
    ## 128     Solid 7.757116e+16
    ## 129     Solid 7.757116e+16
    ## 130     Solid 7.757116e+16
    ## 131     Solid 2.295699e+14
    ## 132     Solid 1.275000e+17
    ## 133     Solid 2.875818e+11
    ## 134     Solid 7.426820e+14
    ## 135     Solid 3.878559e+15
    ## 136     Solid 1.163568e+17
    ## 137     Solid 3.878559e+15
    ## 138     Solid 3.878559e+15
    ## 139     Solid 1.163568e+17
    ## 140     Solid 5.714250e+10
    ## 141     Solid 8.714600e+11
    ## 142     Solid 3.878559e+15
    ## 143     Solid 8.925000e+15
    ## 144     Solid 2.550000e+15
    ## 145     Solid 1.163568e+17
    ## 146     Solid 2.677500e+17
    ## 147     Solid 7.650000e+16
    ## 148     Solid 1.000000e+10
    ## 149     Solid 1.885702e+10
    ## 150     Solid 2.875818e+11
    ## 151     Solid 2.550000e+15
    ## 152     Solid 7.650000e+16
    ## 153     Solid 7.426820e+14
    ## 154     Solid 8.925000e+15
    ## 155     Solid 2.677500e+17
    ## 156     Solid 4.249999e+16
    ## 157     Solid 7.199248e+15
    ## 158     Solid 7.199248e+15
    ## 159     Solid 7.757116e+16
    ## 160     Solid 7.757116e+16
    ## 161     Solid 7.757116e+16
    ## 162     Solid 2.295699e+14
    ## 163     Solid 1.275000e+17
    ## 164     Solid 2.875818e+11
    ## 165     Solid 1.885702e+10
    ## 166     Solid 2.875818e+11
    ## 167     Solid 5.714250e+10
    ## 168     Solid 8.714600e+11
    ## 169     Solid 7.426820e+14
    ## 170     Solid 1.000000e+10
    ## 171     Solid 2.550000e+15
    ## 172     Solid 7.650000e+16
    ## 173     Solid 7.426820e+14
    ## 174     Solid 8.925000e+15
    ## 175     Solid 2.677500e+17
    ## 176     Solid 3.878559e+15
    ## 177     Solid 1.163568e+17
    ## 178     Solid 3.878559e+15
    ## 179     Solid 1.163568e+17
    ## 180     Solid 3.878559e+15
    ## 181     Solid 3.878559e+15
    ## 182     Solid 8.925000e+15
    ## 183     Solid 2.550000e+15
    ## 184     Solid 1.163568e+17
    ## 185     Solid 2.677500e+17
    ## 186     Solid 7.650000e+16
    ## 187   Unbound 4.249999e+16
    ## 188   Unbound 7.199248e+15
    ## 189   Unbound 7.199248e+15
    ## 190   Unbound 7.757116e+16
    ## 191   Unbound 7.757116e+16
    ## 192   Unbound 7.757116e+16
    ## 193   Unbound 2.295699e+14
    ## 194   Unbound 1.275000e+17
    ## 195   Unbound 2.875818e+11
    ## 196   Unbound 7.426820e+14
    ## 197   Unbound 3.878559e+15
    ## 198   Unbound 1.163568e+17
    ## 199   Unbound 3.878559e+15
    ## 200   Unbound 3.878559e+15
    ## 201   Unbound 1.163568e+17
    ## 202   Unbound 5.714250e+10
    ## 203   Unbound 8.714600e+11
    ## 204   Unbound 3.878559e+15
    ## 205   Unbound 8.925000e+15
    ## 206   Unbound 2.550000e+15
    ## 207   Unbound 1.163568e+17
    ## 208   Unbound 2.677500e+17
    ## 209   Unbound 7.650000e+16
    ## 210   Unbound 1.000000e+10
    ## 211   Unbound 1.885702e+10
    ## 212   Unbound 2.875818e+11
    ## 213   Unbound 2.550000e+15
    ## 214   Unbound 7.650000e+16
    ## 215   Unbound 7.426820e+14
    ## 216   Unbound 8.925000e+15
    ## 217   Unbound 2.677500e+17
    ## 218   Unbound 4.249999e+16
    ## 219   Unbound 7.199248e+15
    ## 220   Unbound 7.199248e+15
    ## 221   Unbound 7.757116e+16
    ## 222   Unbound 7.757116e+16
    ## 223   Unbound 7.757116e+16
    ## 224   Unbound 2.295699e+14
    ## 225   Unbound 1.275000e+17
    ## 226   Unbound 2.875818e+11
    ## 227   Unbound 1.885702e+10
    ## 228   Unbound 2.875818e+11
    ## 229   Unbound 5.714250e+10
    ## 230   Unbound 8.714600e+11
    ## 231   Unbound 7.426820e+14
    ## 232   Unbound 1.000000e+10
    ## 233   Unbound 2.550000e+15
    ## 234   Unbound 7.650000e+16
    ## 235   Unbound 7.426820e+14
    ## 236   Unbound 8.925000e+15
    ## 237   Unbound 2.677500e+17
    ## 238   Unbound 3.878559e+15
    ## 239   Unbound 1.163568e+17
    ## 240   Unbound 3.878559e+15
    ## 241   Unbound 1.163568e+17
    ## 242   Unbound 3.878559e+15
    ## 243   Unbound 3.878559e+15
    ## 244   Unbound 8.925000e+15
    ## 245   Unbound 2.550000e+15
    ## 246   Unbound 1.163568e+17
    ## 247   Unbound 2.677500e+17
    ## 248   Unbound 7.650000e+16

``` r
#for testing use:
testProc$execute()
```

    ## Warning in private$Execute(debugAt): input data ignored; not all Volume in
    ## FromAndTo property

    ##      fromScale     toScale fromSubCompart toSubCompart     process fromSpecies
    ## 1       Arctic      Arctic      deepocean          sea k_Advection     Unbound
    ## 2       Arctic      Arctic            sea    deepocean k_Advection     Unbound
    ## 3       Arctic    Moderate            air          air k_Advection     Unbound
    ## 4       Arctic    Moderate      deepocean    deepocean k_Advection     Unbound
    ## 5       Arctic    Moderate            sea          sea k_Advection     Unbound
    ## 6  Continental Continental           lake        river k_Advection     Unbound
    ## 7  Continental Continental          river          sea k_Advection     Unbound
    ## 8  Continental    Moderate            air          air k_Advection     Unbound
    ## 9  Continental    Moderate            sea          sea k_Advection     Unbound
    ## 10 Continental    Regional            air          air k_Advection     Unbound
    ## 11 Continental    Regional          river        river k_Advection     Unbound
    ## 12 Continental    Regional            sea          sea k_Advection     Unbound
    ## 13    Moderate      Arctic            air          air k_Advection     Unbound
    ## 14    Moderate      Arctic      deepocean    deepocean k_Advection     Unbound
    ## 15    Moderate      Arctic            sea          sea k_Advection     Unbound
    ## 16    Moderate Continental            air          air k_Advection     Unbound
    ## 17    Moderate Continental            sea          sea k_Advection     Unbound
    ## 18    Moderate    Moderate      deepocean          sea k_Advection     Unbound
    ## 19    Moderate    Moderate            sea    deepocean k_Advection     Unbound
    ## 20    Moderate      Tropic            air          air k_Advection     Unbound
    ## 21    Moderate      Tropic      deepocean    deepocean k_Advection     Unbound
    ## 22    Moderate      Tropic            sea          sea k_Advection     Unbound
    ## 23    Regional Continental            air          air k_Advection     Unbound
    ## 24    Regional Continental            sea          sea k_Advection     Unbound
    ## 25    Regional    Regional           lake        river k_Advection     Unbound
    ## 26    Regional    Regional          river          sea k_Advection     Unbound
    ## 27      Tropic    Moderate            air          air k_Advection     Unbound
    ## 28      Tropic    Moderate      deepocean    deepocean k_Advection     Unbound
    ## 29      Tropic    Moderate            sea          sea k_Advection     Unbound
    ## 30      Tropic      Tropic      deepocean          sea k_Advection     Unbound
    ## 31      Tropic      Tropic            sea    deepocean k_Advection     Unbound
    ##    toSpecies            k
    ## 1    Unbound 8.975375e-09
    ## 2    Unbound 2.692612e-07
    ## 3    Unbound 6.923419e-07
    ## 4    Unbound 1.960784e-09
    ## 5    Unbound 0.000000e+00
    ## 6    Unbound 2.397260e-09
    ## 7    Unbound 7.264425e-08
    ## 8    Unbound 1.381786e-06
    ## 9    Unbound 3.169135e-08
    ## 10   Unbound 3.003899e-07
    ## 11   Unbound 0.000000e+00
    ## 12   Unbound 1.660023e-11
    ## 13   Unbound 3.793229e-07
    ## 14   Unbound 0.000000e+00
    ## 15   Unbound 3.867416e-08
    ## 16   Unbound 1.282412e-07
    ## 17   Unbound 6.068386e-09
    ## 18   Unbound 8.303729e-09
    ## 19   Unbound 2.491119e-07
    ## 20   Unbound 6.570066e-07
    ## 21   Unbound 1.289139e-09
    ## 22   Unbound 0.000000e+00
    ## 23   Unbound 9.420143e-06
    ## 24   Unbound 1.369854e-06
    ## 25   Unbound 2.397260e-09
    ## 26   Unbound 7.264425e-08
    ## 27   Unbound 3.997238e-07
    ## 28   Unbound 0.000000e+00
    ## 29   Unbound 1.680672e-08
    ## 30   Unbound 7.574814e-09
    ## 31   Unbound 2.272444e-07

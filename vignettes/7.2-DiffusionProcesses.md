DiffusionProcesses
================
JS
2023-08-03

# INTERMEDIA TRANSFER

The intermedia transfer processes are related to transport from air to
soil/water and from water to sediment, and vice versa. Also transport
from soil to water.

## Intro

We initialise a “World” and calculate the needed parameters.

``` r
#we initialize the test environment with the default substance, therefor we remove possible earlier value
rm(substance)
```

    ## Warning in rm(substance): object 'substance' not found

``` r
# substance <- "organic acid"
#script to initialize test environment, including faking a future 'library(sboo)'
try(source("baseScripts/initTestWorld.R"))
source(paste(getwd(),"testScripts/initPartitioningVariables.R", sep="/"))
```

    ## Warning in eval(ei, envir): pKa not given in input data. Substance assumed to
    ## be neutral (pKa = 7).

    ## Warning in eval(ei, envir): Ksw calculated by f_Ksw

``` r
#calculation of the needed SB variables, first compiling their defining functions

# non variable input data which is calculated (see partioning.Rmd) needs to be available before you can proceed

# This needs to be calculated first:
World$NewCalcVariable("FRorig")
World$CalcVar("FRorig")
```

    ##            SubCompart old_FRorig FRorig
    ## 1    agriculturalsoil          1      1
    ## 2                 air          1      1
    ## 3          cloudwater          1      1
    ## 4           deepocean          1      1
    ## 5  freshwatersediment          1      1
    ## 6                lake          1      1
    ## 7        lakesediment          1      1
    ## 8      marinesediment          1      1
    ## 9         naturalsoil          1      1
    ## 10          othersoil          1      1
    ## 11              river          1      1
    ## 12                sea          1      1

``` r
World$NewCalcVariable("FRorig_spw")
World$CalcVar("FRorig_spw")
```

    ##         SubCompart old_FRorig_spw FRorig_spw
    ## 1 agriculturalsoil              1          1
    ## 2      naturalsoil              1          1
    ## 3        othersoil              1          1

``` r
# World$NewCalcVariable("FRACa")
World$fetchData("FRACa")
```

    ##          Scale       SubCompart FRACa
    ## 1       Arctic              air   1.0
    ## 6       Arctic      naturalsoil   0.2
    ## 9  Continental agriculturalsoil   0.2
    ## 10 Continental              air   1.0
    ## 17 Continental      naturalsoil   0.2
    ## 18 Continental        othersoil   0.2
    ## 21    Moderate              air   1.0
    ## 26    Moderate      naturalsoil   0.2
    ## 29    Regional agriculturalsoil   0.2
    ## 30    Regional              air   1.0
    ## 37    Regional      naturalsoil   0.2
    ## 38    Regional        othersoil   0.2
    ## 41      Tropic              air   1.0
    ## 46      Tropic      naturalsoil   0.2

``` r
# World$NewCalcVariable("FRACw")
World$fetchData("FRACw")
```

    ##          Scale         SubCompart FRACw
    ## 1       Arctic                air 2e-11
    ## 5       Arctic     marinesediment 8e-01
    ## 6       Arctic        naturalsoil 2e-01
    ## 9  Continental   agriculturalsoil 2e-01
    ## 10 Continental                air 2e-11
    ## 13 Continental freshwatersediment 8e-01
    ## 15 Continental       lakesediment 8e-01
    ## 16 Continental     marinesediment 8e-01
    ## 17 Continental        naturalsoil 2e-01
    ## 18 Continental          othersoil 2e-01
    ## 21    Moderate                air 2e-11
    ## 25    Moderate     marinesediment 8e-01
    ## 26    Moderate        naturalsoil 2e-01
    ## 29    Regional   agriculturalsoil 2e-01
    ## 30    Regional                air 2e-11
    ## 33    Regional freshwatersediment 8e-01
    ## 35    Regional       lakesediment 8e-01
    ## 36    Regional     marinesediment 8e-01
    ## 37    Regional        naturalsoil 2e-01
    ## 38    Regional          othersoil 2e-01
    ## 41      Tropic                air 2e-11
    ## 45      Tropic     marinesediment 8e-01
    ## 46      Tropic        naturalsoil 2e-01

``` r
World$NewCalcVariable("FRACs")
World$CalcVar("FRACs")
```

    ##          Scale         SubCompart old_FRACs FRACs
    ## 1       Arctic                air     2e-11 2e-11
    ## 2       Arctic     marinesediment     2e-01 2e-01
    ## 3       Arctic        naturalsoil     6e-01 6e-01
    ## 4  Continental   agriculturalsoil     6e-01 6e-01
    ## 5  Continental                air     2e-11 2e-11
    ## 6  Continental freshwatersediment     2e-01 2e-01
    ## 7  Continental       lakesediment     2e-01 2e-01
    ## 8  Continental     marinesediment     2e-01 2e-01
    ## 9  Continental        naturalsoil     6e-01 6e-01
    ## 10 Continental          othersoil     6e-01 6e-01
    ## 11    Moderate                air     2e-11 2e-11
    ## 12    Moderate     marinesediment     2e-01 2e-01
    ## 13    Moderate        naturalsoil     6e-01 6e-01
    ## 14    Regional   agriculturalsoil     6e-01 6e-01
    ## 15    Regional                air     2e-11 2e-11
    ## 16    Regional freshwatersediment     2e-01 2e-01
    ## 17    Regional       lakesediment     2e-01 2e-01
    ## 18    Regional     marinesediment     2e-01 2e-01
    ## 19    Regional        naturalsoil     6e-01 6e-01
    ## 20    Regional          othersoil     6e-01 6e-01
    ## 21      Tropic                air     2e-11 2e-11
    ## 22      Tropic     marinesediment     2e-01 2e-01
    ## 23      Tropic        naturalsoil     6e-01 6e-01

``` r
# World$fetchData("FRACs")
# World$fetchData()

# debugonce(f_Ksw)
# 
# KswModelled <- f_Ksw(Kow = World$fetchData("Kow"), 
#                     pKa = 7, 
#                     CorgStandard = World$fetchData("CorgStandard"), 
#                     a = with(World$fetchData("QSARtable"), 
#                              a[QSAR.ChemClass == World$fetchData("ChemClass")]), 
#                     b = with(World$fetchData("QSARtable"), 
#                              b[QSAR.ChemClass == World$fetchData("ChemClass")]), 
#                     ChemClass = World$fetchData("ChemClass"),
#                     RHOsolid = with(World$fetchData("rhoMatrix"),
#                                     rhoMatrix[SubCompart == "othersoil"]),
#                     alt_form = F)
# 
# Ksw.alt <- f_Ksw(Kow = World$fetchData("Kow"), 
#                     pKa = 7, 
#                     CorgStandard = World$fetchData("CorgStandard"), 
#                     a = with(World$fetchData("QSARtable"), 
#                              a[QSAR.ChemClass == World$fetchData("ChemClass")]), 
#                     b = with(World$fetchData("QSARtable"), 
#                              b[QSAR.ChemClass == World$fetchData("ChemClass")]), 
#                     ChemClass = World$fetchData("ChemClass"),
#                     RHOsolid = with(World$fetchData("rhoMatrix"),
#                                     rhoMatrix[SubCompart == "othersoil"]),
#                     alt_form = T, KswModelled)
# 
# FromData <- World$fetchData("Globals")
# FromData$Ksw <- KswModelled
# FromData$Ksw.alt <- Ksw.alt
# FromData$RHOsolid <- with(World$fetchData("rhoMatrix"),
#                                     rhoMatrix[SubCompart == "othersoil"])
# World$UpdateData(FromData, keys = T, TableName = "Globals")


World$NewCalcVariable("Kp")
World$CalcVar("Kp")
```

    ##            SubCompart   old_Kp       Kp
    ## 1    agriculturalsoil 15.39076 15.39076
    ## 2          cloudwater 76.95379 76.95379
    ## 3           deepocean 76.95379 76.95379
    ## 4  freshwatersediment 38.47690 38.47690
    ## 5                lake 76.95379 76.95379
    ## 6        lakesediment 38.47690 38.47690
    ## 7      marinesediment 38.47690 38.47690
    ## 8         naturalsoil 15.39076 15.39076
    ## 9           othersoil 15.39076 15.39076
    ## 10              river 76.95379 76.95379
    ## 11                sea 76.95379 76.95379

``` r
World$NewCalcVariable("D")
World$CalcVar("D")
```

    ##            SubCompart old_D    D
    ## 1    agriculturalsoil  2750 2750
    ## 2                 air  2750 2750
    ## 3          cloudwater  2750 2750
    ## 4           deepocean  2750 2750
    ## 5  freshwatersediment  2750 2750
    ## 6                lake  2750 2750
    ## 7        lakesediment  2750 2750
    ## 8      marinesediment  2750 2750
    ## 9         naturalsoil  2750 2750
    ## 10          othersoil  2750 2750
    ## 11              river  2750 2750
    ## 12                sea  2750 2750

``` r
World$NewCalcVariable("KpCOL")
World$CalcVar("KpCOL")
```

    ##   SubCompart old_KpCOL KpCOL
    ## 1 cloudwater       220   220
    ## 2  deepocean       220   220
    ## 3       lake       220   220
    ## 4      river       220   220
    ## 5        sea       220   220

``` r
World$NewCalcVariable("Kacompw")
World$CalcVar("Kacompw")
```

    ##         Scale old_Kacompw    Kacompw
    ## 1      Arctic  0.02652817 0.02652817
    ## 2 Continental  0.08985308 0.08985308
    ## 3    Moderate  0.08985308 0.08985308
    ## 4    Regional  0.08985308 0.08985308
    ## 5      Tropic  0.16930287 0.16930287

``` r
World$NewCalcVariable("FRinw")
World$CalcVar("FRinw")
```

    ##          Scale       SubCompart   old_FRinw       FRinw
    ## 1       Arctic        deepocean 0.999395597 0.999395597
    ## 2       Arctic             lake 0.999741590 0.999741590
    ## 3       Arctic      naturalsoil 0.008586844 0.008586844
    ## 4       Arctic            river 0.998627579 0.998627579
    ## 5       Arctic              sea 0.999395597 0.999395597
    ## 6  Continental agriculturalsoil 0.008582178 0.008582178
    ## 7  Continental        deepocean 0.999395597 0.999395597
    ## 8  Continental             lake 0.999741590 0.999741590
    ## 9  Continental      naturalsoil 0.008582178 0.008582178
    ## 10 Continental        othersoil 0.008582178 0.008582178
    ## 11 Continental            river 0.998627579 0.998627579
    ## 12 Continental              sea 0.999395597 0.999395597
    ## 13    Moderate        deepocean 0.999395597 0.999395597
    ## 14    Moderate             lake 0.999741590 0.999741590
    ## 15    Moderate      naturalsoil 0.008582178 0.008582178
    ## 16    Moderate            river 0.998627579 0.998627579
    ## 17    Moderate              sea 0.999395597 0.999395597
    ## 18    Regional agriculturalsoil 0.008582178 0.008582178
    ## 19    Regional        deepocean 0.999395597 0.999395597
    ## 20    Regional             lake 0.999741590 0.999741590
    ## 21    Regional      naturalsoil 0.008582178 0.008582178
    ## 22    Regional        othersoil 0.008582178 0.008582178
    ## 23    Regional            river 0.998627579 0.998627579
    ## 24    Regional              sea 0.999395597 0.999395597
    ## 25      Tropic        deepocean 0.999395597 0.999395597
    ## 26      Tropic             lake 0.999741590 0.999741590
    ## 27      Tropic      naturalsoil 0.008576330 0.008576330
    ## 28      Tropic            river 0.998627579 0.998627579
    ## 29      Tropic              sea 0.999395597 0.999395597

``` r
World$NewCalcVariable("Kaerw")
World$CalcVar("Kaerw")
```

    ##         Scale SubCompart old_Kaerw     Kaerw
    ## 1      Arctic        air 37.695785 37.695785
    ## 2 Continental        air 11.129279 11.129279
    ## 3    Moderate        air 11.129279 11.129279
    ## 4    Regional        air 11.129279 11.129279
    ## 5      Tropic        air  5.906574  5.906574

``` r
World$NewCalcVariable("Kaers")
World$CalcVar("Kaers")
```

    ##   SubCompart old_Kaers    Kaers
    ## 1        air  1754.253 1754.253

``` r
World$NewCalcVariable("FRingas")
World$CalcVar("FRingas")
```

    ##         Scale SubCompart old_FRingas FRingas
    ## 1      Arctic        air           1       1
    ## 2 Continental        air           1       1
    ## 3    Moderate        air           1       1
    ## 4    Regional        air           1       1
    ## 5      Tropic        air           1       1

``` r
World$NewCalcVariable("KdegDorC")
World$CalcVar("KdegDorC")
```

    ##    Species         SubCompart KdegDorC
    ## 1    Large   agriculturalsoil 1.07e-07
    ## 2    Large     marinesediment 2.38e-08
    ## 3    Large freshwatersediment 2.38e-08
    ## 4    Large          deepocean 2.14e-07
    ## 5    Large                air 2.40e-07
    ## 6    Large        naturalsoil 1.07e-07
    ## 7    Large               lake 2.14e-07
    ## 8    Large                sea 2.14e-07
    ## 9    Large         cloudwater 2.40e-07
    ## 10   Large          othersoil 1.07e-07
    ## 11   Large       lakesediment 2.38e-08
    ## 12   Large              river 2.14e-07
    ## 13   Small                air 2.40e-07
    ## 14   Small          deepocean 2.14e-07
    ## 15   Small              river 2.14e-07
    ## 16   Small     marinesediment 2.38e-08
    ## 17   Small               lake 2.14e-07
    ## 18   Small freshwatersediment 2.38e-08
    ## 19   Small                sea 2.14e-07
    ## 20   Small          othersoil 1.07e-07
    ## 21   Small       lakesediment 2.38e-08
    ## 22   Small        naturalsoil 1.07e-07
    ## 23   Small         cloudwater 2.40e-07
    ## 24   Small   agriculturalsoil 1.07e-07
    ## 25   Solid   agriculturalsoil 1.07e-07
    ## 26   Solid               lake 2.14e-07
    ## 27   Solid     marinesediment 2.38e-08
    ## 28   Solid              river 2.14e-07
    ## 29   Solid                air 2.40e-07
    ## 30   Solid       lakesediment 2.38e-08
    ## 31   Solid        naturalsoil 1.07e-07
    ## 32   Solid freshwatersediment 2.38e-08
    ## 33   Solid         cloudwater 2.40e-07
    ## 34   Solid          othersoil 1.07e-07
    ## 35   Solid                sea 2.14e-07
    ## 36   Solid          deepocean 2.14e-07
    ## 37 Unbound          deepocean 2.14e-07
    ## 38 Unbound freshwatersediment 2.38e-08
    ## 39 Unbound          othersoil 1.07e-07
    ## 40 Unbound               lake 2.14e-07
    ## 41 Unbound   agriculturalsoil 1.07e-07
    ## 42 Unbound              river 2.14e-07
    ## 43 Unbound     marinesediment 2.38e-08
    ## 44 Unbound       lakesediment 2.38e-08
    ## 45 Unbound                air 2.40e-07
    ## 46 Unbound        naturalsoil 1.07e-07
    ## 47 Unbound                sea 2.14e-07

``` r
World$NewCalcVariable("Tempfactor")
World$CalcVar("Tempfactor")
```

    ##     Species         SubCompart       Scale Tempfactor
    ## 1     Large       lakesediment    Moderate 1.00000000
    ## 2     Large   agriculturalsoil Continental 1.00000000
    ## 3     Large         cloudwater    Regional 1.00000000
    ## 4     Large   agriculturalsoil    Regional 1.00000000
    ## 5     Large          deepocean      Arctic 1.00000000
    ## 6     Large     marinesediment      Arctic 1.00000000
    ## 7     Large        naturalsoil      Arctic 1.00000000
    ## 8     Large     marinesediment      Tropic 1.00000000
    ## 9     Large       lakesediment      Arctic 1.00000000
    ## 10    Large               lake    Moderate 1.00000000
    ## 11    Large         cloudwater      Tropic 1.00000000
    ## 12    Large              river Continental 1.00000000
    ## 13    Large   agriculturalsoil      Arctic 1.00000000
    ## 14    Large                air      Arctic 1.00000000
    ## 15    Large   agriculturalsoil      Tropic 1.00000000
    ## 16    Large               lake    Regional 1.00000000
    ## 17    Large   agriculturalsoil    Moderate 1.00000000
    ## 18    Large          deepocean    Regional 1.00000000
    ## 19    Large               lake      Tropic 1.00000000
    ## 20    Large          othersoil    Regional 1.00000000
    ## 21    Large        naturalsoil Continental 1.00000000
    ## 22    Large freshwatersediment      Tropic 1.00000000
    ## 23    Large         cloudwater Continental 1.00000000
    ## 24    Large          deepocean    Moderate 1.00000000
    ## 25    Large     marinesediment    Regional 1.00000000
    ## 26    Large          othersoil      Arctic 1.00000000
    ## 27    Large       lakesediment Continental 1.00000000
    ## 28    Large         cloudwater    Moderate 1.00000000
    ## 29    Large          deepocean      Tropic 1.00000000
    ## 30    Large          othersoil      Tropic 1.00000000
    ## 31    Large       lakesediment    Regional 1.00000000
    ## 32    Large        naturalsoil      Tropic 1.00000000
    ## 33    Large              river      Tropic 1.00000000
    ## 34    Large          othersoil    Moderate 1.00000000
    ## 35    Large freshwatersediment      Arctic 1.00000000
    ## 36    Large          deepocean Continental 1.00000000
    ## 37    Large                air    Regional 1.00000000
    ## 38    Large        naturalsoil    Regional 1.00000000
    ## 39    Large              river      Arctic 1.00000000
    ## 40    Large          othersoil Continental 1.00000000
    ## 41    Large                air Continental 1.00000000
    ## 42    Large               lake      Arctic 1.00000000
    ## 43    Large                sea      Tropic 1.00000000
    ## 44    Large freshwatersediment Continental 1.00000000
    ## 45    Large     marinesediment Continental 1.00000000
    ## 46    Large                sea    Regional 1.00000000
    ## 47    Large               lake Continental 1.00000000
    ## 48    Large                sea Continental 1.00000000
    ## 49    Large freshwatersediment    Regional 1.00000000
    ## 50    Large       lakesediment      Tropic 1.00000000
    ## 51    Large        naturalsoil    Moderate 1.00000000
    ## 52    Large         cloudwater      Arctic 1.00000000
    ## 53    Large                sea      Arctic 1.00000000
    ## 54    Large                sea    Moderate 1.00000000
    ## 55    Large              river    Regional 1.00000000
    ## 56    Large freshwatersediment    Moderate 1.00000000
    ## 57    Large                air      Tropic 1.00000000
    ## 58    Large                air    Moderate 1.00000000
    ## 59    Large              river    Moderate 1.00000000
    ## 60    Large     marinesediment    Moderate 1.00000000
    ## 61    Small               lake Continental 1.00000000
    ## 62    Small          deepocean      Tropic 1.00000000
    ## 63    Small   agriculturalsoil    Regional 1.00000000
    ## 64    Small       lakesediment      Arctic 1.00000000
    ## 65    Small               lake      Tropic 1.00000000
    ## 66    Small         cloudwater    Moderate 1.00000000
    ## 67    Small   agriculturalsoil    Moderate 1.00000000
    ## 68    Small                air      Arctic 1.00000000
    ## 69    Small     marinesediment    Moderate 1.00000000
    ## 70    Small freshwatersediment    Regional 1.00000000
    ## 71    Small       lakesediment      Tropic 1.00000000
    ## 72    Small               lake    Moderate 1.00000000
    ## 73    Small               lake      Arctic 1.00000000
    ## 74    Small          deepocean    Regional 1.00000000
    ## 75    Small     marinesediment      Arctic 1.00000000
    ## 76    Small        naturalsoil Continental 1.00000000
    ## 77    Small        naturalsoil    Moderate 1.00000000
    ## 78    Small   agriculturalsoil Continental 1.00000000
    ## 79    Small     marinesediment      Tropic 1.00000000
    ## 80    Small         cloudwater      Tropic 1.00000000
    ## 81    Small freshwatersediment      Arctic 1.00000000
    ## 82    Small     marinesediment Continental 1.00000000
    ## 83    Small       lakesediment Continental 1.00000000
    ## 84    Small   agriculturalsoil      Arctic 1.00000000
    ## 85    Small                air    Regional 1.00000000
    ## 86    Small                air      Tropic 1.00000000
    ## 87    Small              river      Arctic 1.00000000
    ## 88    Small         cloudwater    Regional 1.00000000
    ## 89    Small   agriculturalsoil      Tropic 1.00000000
    ## 90    Small     marinesediment    Regional 1.00000000
    ## 91    Small          othersoil      Arctic 1.00000000
    ## 92    Small       lakesediment    Regional 1.00000000
    ## 93    Small              river    Regional 1.00000000
    ## 94    Small        naturalsoil      Arctic 1.00000000
    ## 95    Small       lakesediment    Moderate 1.00000000
    ## 96    Small freshwatersediment Continental 1.00000000
    ## 97    Small         cloudwater      Arctic 1.00000000
    ## 98    Small              river      Tropic 1.00000000
    ## 99    Small              river Continental 1.00000000
    ## 100   Small freshwatersediment    Moderate 1.00000000
    ## 101   Small                sea    Moderate 1.00000000
    ## 102   Small                sea      Tropic 1.00000000
    ## 103   Small        naturalsoil    Regional 1.00000000
    ## 104   Small        naturalsoil      Tropic 1.00000000
    ## 105   Small                sea      Arctic 1.00000000
    ## 106   Small                sea    Regional 1.00000000
    ## 107   Small              river    Moderate 1.00000000
    ## 108   Small          othersoil Continental 1.00000000
    ## 109   Small          othersoil      Tropic 1.00000000
    ## 110   Small         cloudwater Continental 1.00000000
    ## 111   Small          othersoil    Regional 1.00000000
    ## 112   Small freshwatersediment      Tropic 1.00000000
    ## 113   Small          deepocean    Moderate 1.00000000
    ## 114   Small          othersoil    Moderate 1.00000000
    ## 115   Small                air Continental 1.00000000
    ## 116   Small               lake    Regional 1.00000000
    ## 117   Small                sea Continental 1.00000000
    ## 118   Small          deepocean Continental 1.00000000
    ## 119   Small          deepocean      Arctic 1.00000000
    ## 120   Small                air    Moderate 1.00000000
    ## 121   Solid   agriculturalsoil    Regional 1.00000000
    ## 122   Solid freshwatersediment    Regional 1.00000000
    ## 123   Solid     marinesediment    Moderate 1.00000000
    ## 124   Solid   agriculturalsoil      Arctic 1.00000000
    ## 125   Solid       lakesediment Continental 1.00000000
    ## 126   Solid               lake    Regional 1.00000000
    ## 127   Solid     marinesediment      Tropic 1.00000000
    ## 128   Solid       lakesediment    Regional 1.00000000
    ## 129   Solid         cloudwater Continental 1.00000000
    ## 130   Solid        naturalsoil      Arctic 1.00000000
    ## 131   Solid                air      Arctic 1.00000000
    ## 132   Solid   agriculturalsoil    Moderate 1.00000000
    ## 133   Solid   agriculturalsoil      Tropic 1.00000000
    ## 134   Solid   agriculturalsoil Continental 1.00000000
    ## 135   Solid         cloudwater    Regional 1.00000000
    ## 136   Solid     marinesediment      Arctic 1.00000000
    ## 137   Solid          othersoil      Arctic 1.00000000
    ## 138   Solid          deepocean      Arctic 1.00000000
    ## 139   Solid          othersoil    Moderate 1.00000000
    ## 140   Solid                air Continental 1.00000000
    ## 141   Solid          othersoil    Regional 1.00000000
    ## 142   Solid          deepocean      Tropic 1.00000000
    ## 143   Solid                air    Moderate 1.00000000
    ## 144   Solid               lake      Tropic 1.00000000
    ## 145   Solid                sea      Arctic 1.00000000
    ## 146   Solid          deepocean    Moderate 1.00000000
    ## 147   Solid          othersoil      Tropic 1.00000000
    ## 148   Solid               lake Continental 1.00000000
    ## 149   Solid              river    Regional 1.00000000
    ## 150   Solid          deepocean Continental 1.00000000
    ## 151   Solid          deepocean    Regional 1.00000000
    ## 152   Solid                air      Tropic 1.00000000
    ## 153   Solid               lake    Moderate 1.00000000
    ## 154   Solid                air    Regional 1.00000000
    ## 155   Solid               lake      Arctic 1.00000000
    ## 156   Solid              river      Tropic 1.00000000
    ## 157   Solid         cloudwater    Moderate 1.00000000
    ## 158   Solid freshwatersediment Continental 1.00000000
    ## 159   Solid freshwatersediment      Arctic 1.00000000
    ## 160   Solid         cloudwater      Tropic 1.00000000
    ## 161   Solid        naturalsoil Continental 1.00000000
    ## 162   Solid              river Continental 1.00000000
    ## 163   Solid                sea    Regional 1.00000000
    ## 164   Solid         cloudwater      Arctic 1.00000000
    ## 165   Solid       lakesediment      Tropic 1.00000000
    ## 166   Solid              river    Moderate 1.00000000
    ## 167   Solid                sea Continental 1.00000000
    ## 168   Solid     marinesediment Continental 1.00000000
    ## 169   Solid       lakesediment    Moderate 1.00000000
    ## 170   Solid          othersoil Continental 1.00000000
    ## 171   Solid freshwatersediment    Moderate 1.00000000
    ## 172   Solid freshwatersediment      Tropic 1.00000000
    ## 173   Solid     marinesediment    Regional 1.00000000
    ## 174   Solid                sea    Moderate 1.00000000
    ## 175   Solid        naturalsoil    Regional 1.00000000
    ## 176   Solid        naturalsoil    Moderate 1.00000000
    ## 177   Solid       lakesediment      Arctic 1.00000000
    ## 178   Solid        naturalsoil      Tropic 1.00000000
    ## 179   Solid              river      Arctic 1.00000000
    ## 180   Solid                sea      Tropic 1.00000000
    ## 181 Unbound freshwatersediment      Arctic 0.08838835
    ## 182 Unbound   agriculturalsoil    Regional 0.40612620
    ## 183 Unbound     marinesediment    Regional 0.40612620
    ## 184 Unbound          othersoil      Arctic 0.08838835
    ## 185 Unbound   agriculturalsoil    Moderate 0.40612620
    ## 186 Unbound freshwatersediment      Tropic 1.00000000
    ## 187 Unbound   agriculturalsoil Continental 0.40612620
    ## 188 Unbound        naturalsoil    Moderate 0.40612620
    ## 189 Unbound              river      Arctic 0.08838835
    ## 190 Unbound   agriculturalsoil      Arctic 0.08838835
    ## 191 Unbound   agriculturalsoil      Tropic 1.00000000
    ## 192 Unbound       lakesediment Continental 0.40612620
    ## 193 Unbound                sea      Tropic 1.00000000
    ## 194 Unbound          deepocean Continental 0.40612620
    ## 195 Unbound freshwatersediment Continental 0.40612620
    ## 196 Unbound                air    Regional 0.89974861
    ## 197 Unbound     marinesediment Continental 0.40612620
    ## 198 Unbound          othersoil      Tropic 1.00000000
    ## 199 Unbound               lake      Arctic 0.08838835
    ## 200 Unbound       lakesediment      Arctic 0.08838835
    ## 201 Unbound          deepocean      Tropic 1.00000000
    ## 202 Unbound        naturalsoil      Tropic 1.00000000
    ## 203 Unbound          deepocean      Arctic 0.08838835
    ## 204 Unbound                air Continental 0.89974861
    ## 205 Unbound       lakesediment      Tropic 1.00000000
    ## 206 Unbound     marinesediment    Moderate 0.40612620
    ## 207 Unbound          othersoil    Regional 0.40612620
    ## 208 Unbound              river Continental 0.40612620
    ## 209 Unbound              river    Moderate 0.40612620
    ## 210 Unbound                sea    Regional 0.40612620
    ## 211 Unbound                air      Arctic 0.75245427
    ## 212 Unbound       lakesediment    Moderate 0.40612620
    ## 213 Unbound freshwatersediment    Regional 0.40612620
    ## 214 Unbound        naturalsoil      Arctic 0.08838835
    ## 215 Unbound                sea      Arctic 0.08838835
    ## 216 Unbound          deepocean    Regional 0.40612620
    ## 217 Unbound        naturalsoil    Regional 0.40612620
    ## 218 Unbound          othersoil    Moderate 0.40612620
    ## 219 Unbound     marinesediment      Arctic 0.08838835
    ## 220 Unbound                sea Continental 0.40612620
    ## 221 Unbound               lake Continental 0.40612620
    ## 222 Unbound               lake      Tropic 1.00000000
    ## 223 Unbound       lakesediment    Regional 0.40612620
    ## 224 Unbound                air    Moderate 0.89974861
    ## 225 Unbound                sea    Moderate 0.40612620
    ## 226 Unbound               lake    Regional 0.40612620
    ## 227 Unbound                air      Tropic 1.00000000
    ## 228 Unbound     marinesediment      Tropic 1.00000000
    ## 229 Unbound freshwatersediment    Moderate 0.40612620
    ## 230 Unbound               lake    Moderate 0.40612620
    ## 231 Unbound          deepocean    Moderate 0.40612620
    ## 232 Unbound              river      Tropic 1.00000000
    ## 233 Unbound          othersoil Continental 0.40612620
    ## 234 Unbound              river    Regional 0.40612620
    ## 235 Unbound        naturalsoil Continental 0.40612620

## Partial Mass Transfer Coefficient’s (MTC)

Diffusion governs the Volatisation and desorption processes. These are
modelled following the classic two-film theory \[REF\]. The equilibria
constants between the media are important parameters. Their calculation
is described in the vignette partitioning \[`link`\].

Partial Mass Transfer Coefficients operate like resistors; to calculate
the total MTC we use 1/K = 1/k1 + 1/(kp.k2), with kp the equilibrium
constant. The soil side MTCa,s is related to the degradation of the
substance, for water/air the wind plays a role. The defining functions
are organised by the medium the film is bordering towards, but use the
properties of the medium () of the box) they are defined for, the
departure of the diffusion.

Following is the implementation of 4 MTC’s.

1.  MTC_2a -\> for water side of the water-air interface (from water to
    air) and the soil side of the soil-air interface (from soil to air).

2.  MTC_2w -\> for air side of the air-water interface (from air to
    water) and the sediment side of the sediment-water interface (from
    sediment to water).

3.  MTC_2s -\> for the air side of the air-soil interface (from air to
    soil).

4.  MTC_2sd -\> for the water side of the water-sediment interface (from
    water to sediment).

``` r
# MTCvars <- c("MTC_2a", "MTC_2w", "MTC_2s", "MTC_2sd")
# for (x in MTCvars) {
#   source(paste0("newAlgorithmScripts/v_", x ,".R"))
# }

World$NewCalcVariable("MTC_2a")
World$CalcVar("MTC_2a")
```

    ##           SubCompart       Scale Species       MTC_2a
    ## 9   agriculturalsoil Continental Unbound 4.345550e-09
    ## 10  agriculturalsoil    Regional Unbound 4.345550e-09
    ## 105             lake    Regional Unbound 5.191248e-06
    ## 110             lake Continental Unbound 5.191248e-06
    ## 158      naturalsoil Continental Unbound 4.345550e-09
    ## 162      naturalsoil    Regional Unbound 4.345550e-09
    ## 167      naturalsoil      Arctic Unbound 9.457553e-10
    ## 168      naturalsoil      Tropic Unbound 1.070000e-08
    ## 171      naturalsoil    Moderate Unbound 4.345550e-09
    ## 176        othersoil Continental Unbound 4.345550e-09
    ## 177        othersoil    Regional Unbound 4.345550e-09
    ## 203            river Continental Unbound 5.191248e-06
    ## 206            river    Regional Unbound 5.191248e-06
    ## 226              sea      Arctic Unbound 5.191248e-06
    ## 229              sea      Tropic Unbound 5.191248e-06
    ## 230              sea Continental Unbound 5.191248e-06
    ## 232              sea    Regional Unbound 5.191248e-06
    ## 234              sea    Moderate Unbound 5.191248e-06

``` r
World$NewCalcVariable("MTC_2w")
World$CalcVar("MTC_2w")
```

    ##            SubCompart       Scale       MTC_2w
    ## 6                 air      Arctic 0.0044535619
    ## 7                 air Continental 0.0044535619
    ## 8                 air    Moderate 0.0044535619
    ## 9                 air    Regional 0.0044535619
    ## 10                air      Tropic 0.0044535619
    ## 21 freshwatersediment      Arctic 0.0000000278
    ## 22 freshwatersediment    Moderate 0.0000000278
    ## 23 freshwatersediment      Tropic 0.0000000278
    ## 24 freshwatersediment Continental 0.0000000278
    ## 25 freshwatersediment    Regional 0.0000000278
    ## 31       lakesediment      Tropic 0.0000000278
    ## 32       lakesediment      Arctic 0.0000000278
    ## 33       lakesediment Continental 0.0000000278
    ## 34       lakesediment    Regional 0.0000000278
    ## 35       lakesediment    Moderate 0.0000000278
    ## 36     marinesediment    Moderate 0.0000000278
    ## 37     marinesediment Continental 0.0000000278
    ## 38     marinesediment    Regional 0.0000000278
    ## 39     marinesediment      Tropic 0.0000000278
    ## 40     marinesediment      Arctic 0.0000000278

``` r
World$NewCalcVariable("MTC_2s")
World$CalcVar("MTC_2s")
```

    ##   SubCompart      MTC_2s
    ## 2        air 0.001047758

``` r
World$NewCalcVariable("MTC_2sd")
World$CalcVar("MTC_2sd")
```

    ##    SubCompart  MTC_2sd
    ## 4   deepocean 2.78e-06
    ## 6        lake 2.78e-06
    ## 11      river 2.78e-06
    ## 12        sea 2.78e-06

``` r
World$NewCalcVariable("Kscompw")
World$CalcVar("Kscompw")
```

    ##         Scale       SubCompart old_Kscompw  Kscompw
    ## 1      Arctic      naturalsoil    23.29144 23.29144
    ## 2 Continental agriculturalsoil    23.30411 23.30411
    ## 3 Continental      naturalsoil    23.30411 23.30411
    ## 4 Continental        othersoil    23.30411 23.30411
    ## 5    Moderate      naturalsoil    23.30411 23.30411
    ## 6    Regional agriculturalsoil    23.30411 23.30411
    ## 7    Regional      naturalsoil    23.30411 23.30411
    ## 8    Regional        othersoil    23.30411 23.30411
    ## 9      Tropic      naturalsoil    23.32000 23.32000

## Adsorption

Adsoprtion is implemented to estimate the flux of chemical from air to
soil and water, and from water to sediment. documentation needed

``` r
World$fetchData("kwsd.water")
```

    ## [1] 2.78e-06

``` r
World$fetchData("kwsd.sed")
```

    ## [1] 2.78e-08

``` r
World$fetchData("FRingas")
```

    ##          Scale SubCompart FRingas
    ## 1       Arctic        air       1
    ## 12 Continental        air       1
    ## 23    Moderate        air       1
    ## 34    Regional        air       1
    ## 45      Tropic        air       1

``` r
World$fetchData("FRinw")
```

    ##          Scale       SubCompart       FRinw
    ## 3       Arctic        deepocean 0.999395597
    ## 5       Arctic             lake 0.999741590
    ## 8       Arctic      naturalsoil 0.008586844
    ## 9       Arctic            river 0.998627579
    ## 10      Arctic              sea 0.999395597
    ## 11 Continental agriculturalsoil 0.008582178
    ## 14 Continental        deepocean 0.999395597
    ## 16 Continental             lake 0.999741590
    ## 19 Continental      naturalsoil 0.008582178
    ## 20 Continental        othersoil 0.008582178
    ## 21 Continental            river 0.998627579
    ## 22 Continental              sea 0.999395597
    ## 25    Moderate        deepocean 0.999395597
    ## 27    Moderate             lake 0.999741590
    ## 30    Moderate      naturalsoil 0.008582178
    ## 31    Moderate            river 0.998627579
    ## 32    Moderate              sea 0.999395597
    ## 33    Regional agriculturalsoil 0.008582178
    ## 36    Regional        deepocean 0.999395597
    ## 38    Regional             lake 0.999741590
    ## 41    Regional      naturalsoil 0.008582178
    ## 42    Regional        othersoil 0.008582178
    ## 43    Regional            river 0.998627579
    ## 44    Regional              sea 0.999395597
    ## 47      Tropic        deepocean 0.999395597
    ## 49      Tropic             lake 0.999741590
    ## 52      Tropic      naturalsoil 0.008576330
    ## 53      Tropic            river 0.998627579
    ## 54      Tropic              sea 0.999395597

``` r
World$fetchData("MTC_2sd")
```

    ##    SubCompart  MTC_2sd
    ## 4   deepocean 2.78e-06
    ## 6        lake 2.78e-06
    ## 11      river 2.78e-06
    ## 12        sea 2.78e-06

``` r
World$fetchData("MTC_2w")
```

    ##          Scale         SubCompart       MTC_2w
    ## 1       Arctic                air 0.0044535619
    ## 4       Arctic freshwatersediment 0.0000000278
    ## 6       Arctic       lakesediment 0.0000000278
    ## 7       Arctic     marinesediment 0.0000000278
    ## 12 Continental                air 0.0044535619
    ## 15 Continental freshwatersediment 0.0000000278
    ## 17 Continental       lakesediment 0.0000000278
    ## 18 Continental     marinesediment 0.0000000278
    ## 23    Moderate                air 0.0044535619
    ## 26    Moderate freshwatersediment 0.0000000278
    ## 28    Moderate       lakesediment 0.0000000278
    ## 29    Moderate     marinesediment 0.0000000278
    ## 34    Regional                air 0.0044535619
    ## 37    Regional freshwatersediment 0.0000000278
    ## 39    Regional       lakesediment 0.0000000278
    ## 40    Regional     marinesediment 0.0000000278
    ## 45      Tropic                air 0.0044535619
    ## 48      Tropic freshwatersediment 0.0000000278
    ## 50      Tropic       lakesediment 0.0000000278
    ## 51      Tropic     marinesediment 0.0000000278

``` r
World$fetchData("MTC_2a")
```

    ##           Scale       SubCompart Species       MTC_2a
    ## 35       Arctic      naturalsoil Unbound 9.457553e-10
    ## 47       Arctic              sea Unbound 5.191248e-06
    ## 51  Continental agriculturalsoil Unbound 4.345550e-09
    ## 70  Continental             lake Unbound 5.191248e-06
    ## 82  Continental      naturalsoil Unbound 4.345550e-09
    ## 86  Continental        othersoil Unbound 4.345550e-09
    ## 90  Continental            river Unbound 5.191248e-06
    ## 94  Continental              sea Unbound 5.191248e-06
    ## 129    Moderate      naturalsoil Unbound 4.345550e-09
    ## 141    Moderate              sea Unbound 5.191248e-06
    ## 145    Regional agriculturalsoil Unbound 4.345550e-09
    ## 164    Regional             lake Unbound 5.191248e-06
    ## 176    Regional      naturalsoil Unbound 4.345550e-09
    ## 180    Regional        othersoil Unbound 4.345550e-09
    ## 184    Regional            river Unbound 5.191248e-06
    ## 188    Regional              sea Unbound 5.191248e-06
    ## 223      Tropic      naturalsoil Unbound 1.070000e-08
    ## 235      Tropic              sea Unbound 5.191248e-06

``` r
World$fetchData("MTC_2s")
```

    ##   SubCompart      MTC_2s
    ## 2        air 0.001047758

``` r
World$fetchData("FRorig")
```

    ##            SubCompart FRorig
    ## 1    agriculturalsoil      1
    ## 2                 air      1
    ## 3          cloudwater      1
    ## 4           deepocean      1
    ## 5  freshwatersediment      1
    ## 6                lake      1
    ## 7        lakesediment      1
    ## 8      marinesediment      1
    ## 9         naturalsoil      1
    ## 10          othersoil      1
    ## 11              river      1
    ## 12                sea      1

``` r
World$fetchData("FRorig_spw")
```

    ##          SubCompart FRorig_spw
    ## 1  agriculturalsoil          1
    ## 9       naturalsoil          1
    ## 10        othersoil          1

``` r
World$fetchData("Kacompw")
```

    ##         Scale    Kacompw
    ## 1      Arctic 0.02652817
    ## 2 Continental 0.08985308
    ## 3    Moderate 0.08985308
    ## 4    Regional 0.08985308
    ## 5      Tropic 0.16930287

``` r
World$fetchData("Kscompw")
```

    ##          Scale       SubCompart  Kscompw
    ## 8       Arctic      naturalsoil 23.29144
    ## 11 Continental agriculturalsoil 23.30411
    ## 19 Continental      naturalsoil 23.30411
    ## 20 Continental        othersoil 23.30411
    ## 30    Moderate      naturalsoil 23.30411
    ## 33    Regional agriculturalsoil 23.30411
    ## 41    Regional      naturalsoil 23.30411
    ## 42    Regional        othersoil 23.30411
    ## 52      Tropic      naturalsoil 23.32000

``` r
World$fetchData("Matrix")
```

    ##            SubCompart   Matrix
    ## 1    agriculturalsoil     soil
    ## 2                 air      air
    ## 3          cloudwater    water
    ## 4           deepocean    water
    ## 5  freshwatersediment sediment
    ## 6                lake    water
    ## 7        lakesediment sediment
    ## 8      marinesediment sediment
    ## 9         naturalsoil     soil
    ## 10          othersoil     soil
    ## 11              river    water
    ## 12                sea    water

``` r
World$fetchData("VertDistance")
```

    ##          Scale         SubCompart VertDistance
    ## 1       Arctic                air        1e+03
    ## 2       Arctic         cloudwater        1e+03
    ## 3       Arctic          deepocean        3e+03
    ## 7       Arctic     marinesediment        3e-02
    ## 8       Arctic        naturalsoil        5e-02
    ## 10      Arctic                sea        1e+02
    ## 11 Continental   agriculturalsoil        2e-01
    ## 12 Continental                air        1e+03
    ## 13 Continental         cloudwater        1e+03
    ## 15 Continental freshwatersediment        3e-02
    ## 16 Continental               lake        1e+02
    ## 17 Continental       lakesediment        3e-02
    ## 18 Continental     marinesediment        3e-02
    ## 19 Continental        naturalsoil        5e-02
    ## 20 Continental          othersoil        5e-02
    ## 21 Continental              river        3e+00
    ## 22 Continental                sea        2e+02
    ## 23    Moderate                air        1e+03
    ## 24    Moderate         cloudwater        1e+03
    ## 25    Moderate          deepocean        3e+03
    ## 29    Moderate     marinesediment        3e-02
    ## 30    Moderate        naturalsoil        5e-02
    ## 32    Moderate                sea        1e+02
    ## 33    Regional   agriculturalsoil        2e-01
    ## 34    Regional                air        1e+03
    ## 35    Regional         cloudwater        1e+03
    ## 37    Regional freshwatersediment        3e-02
    ## 38    Regional               lake        1e+02
    ## 39    Regional       lakesediment        3e-02
    ## 40    Regional     marinesediment        3e-02
    ## 41    Regional        naturalsoil        5e-02
    ## 42    Regional          othersoil        5e-02
    ## 43    Regional              river        3e+00
    ## 44    Regional                sea        1e+01
    ## 45      Tropic                air        1e+03
    ## 46      Tropic         cloudwater        1e+03
    ## 47      Tropic          deepocean        3e+03
    ## 51      Tropic     marinesediment        3e-02
    ## 52      Tropic        naturalsoil        5e-02
    ## 54      Tropic                sea        1e+02

``` r
World$fetchData("landFRAC")
```

    ##          Scale       SubCompart landFRAC
    ## 11 Continental agriculturalsoil   0.6000
    ## 16 Continental             lake   0.0025
    ## 19 Continental      naturalsoil   0.2700
    ## 20 Continental        othersoil   0.1000
    ## 21 Continental            river   0.0275
    ## 33    Regional agriculturalsoil   0.6000
    ## 38    Regional             lake   0.0025
    ## 41    Regional      naturalsoil   0.2700
    ## 42    Regional        othersoil   0.1000
    ## 43    Regional            river   0.0275

``` r
World$fetchData("Area")
```

    ##          Scale       SubCompart         Area
    ## 1       Arctic              air 4.250000e+13
    ## 2       Arctic       cloudwater 4.250000e+13
    ## 3       Arctic        deepocean 2.550000e+13
    ## 8       Arctic      naturalsoil 1.700000e+13
    ## 10      Arctic              sea 2.550000e+13
    ## 11 Continental agriculturalsoil 2.091601e+12
    ## 12 Continental              air 7.200000e+12
    ## 13 Continental       cloudwater 7.200000e+12
    ## 16 Continental             lake 8.715005e+09
    ## 19 Continental      naturalsoil 9.412205e+11
    ## 20 Continental        othersoil 3.486002e+11
    ## 21 Continental            river 9.586505e+10
    ## 22 Continental              sea 3.713998e+12
    ## 23    Moderate              air 7.757000e+13
    ## 24    Moderate       cloudwater 7.757000e+13
    ## 25    Moderate        deepocean 3.878500e+13
    ## 30    Moderate      naturalsoil 3.878500e+13
    ## 32    Moderate              sea 3.878500e+13
    ## 33    Regional agriculturalsoil 1.373989e+11
    ## 34    Regional              air 2.300000e+11
    ## 35    Regional       cloudwater 2.300000e+11
    ## 38    Regional             lake 5.724953e+08
    ## 41    Regional      naturalsoil 6.182949e+10
    ## 42    Regional        othersoil 2.289981e+10
    ## 43    Regional            river 6.297448e+09
    ## 44    Regional              sea 1.001873e+09
    ## 45      Tropic              air 1.280000e+14
    ## 46      Tropic       cloudwater 1.280000e+14
    ## 47      Tropic        deepocean 8.960000e+13
    ## 52      Tropic      naturalsoil 3.840000e+13
    ## 54      Tropic              sea 8.960000e+13

``` r
World$fetchData("AreaLand")
```

    ##         Scale     AreaLand
    ## 1      Arctic 1.700000e+13
    ## 2 Continental 3.486002e+12
    ## 3    Moderate 3.878500e+13
    ## 4    Regional 2.289981e+11
    ## 5      Tropic 3.840000e+13

``` r
World$fetchData("AreaSea")
```

    ##         Scale      AreaSea
    ## 1      Arctic 2.550000e+13
    ## 2 Continental 3.713998e+12
    ## 3    Moderate 3.878500e+13
    ## 4    Regional 1.001873e+09
    ## 5      Tropic 8.960000e+13

``` r
World$fetchData("SpeciesName")
```

    ##   Species  SpeciesName
    ## 3   Large     Attached
    ## 4   Small   Aggregated
    ## 5   Solid Nanoparticle
    ## 6 Unbound    Molecular

``` r
World$FromDataAndTo("k_Adsorption")
```

    ##          process fromSubCompart       toSubCompart   fromScale     toScale
    ## 101 k_Adsorption            air   agriculturalsoil      Arctic      Arctic
    ## 102 k_Adsorption            air               lake      Arctic      Arctic
    ## 103 k_Adsorption            air        naturalsoil      Arctic      Arctic
    ## 104 k_Adsorption            air          othersoil      Arctic      Arctic
    ## 105 k_Adsorption            air              river      Arctic      Arctic
    ## 106 k_Adsorption            air                sea      Arctic      Arctic
    ## 107 k_Adsorption      deepocean     marinesediment      Arctic      Arctic
    ## 108 k_Adsorption           lake       lakesediment      Arctic      Arctic
    ## 109 k_Adsorption          river freshwatersediment      Arctic      Arctic
    ## 110 k_Adsorption            sea     marinesediment      Arctic      Arctic
    ## 111 k_Adsorption            air   agriculturalsoil Continental Continental
    ## 112 k_Adsorption            air               lake Continental Continental
    ## 113 k_Adsorption            air        naturalsoil Continental Continental
    ## 114 k_Adsorption            air          othersoil Continental Continental
    ## 115 k_Adsorption            air              river Continental Continental
    ## 116 k_Adsorption            air                sea Continental Continental
    ## 117 k_Adsorption      deepocean     marinesediment Continental Continental
    ## 118 k_Adsorption           lake       lakesediment Continental Continental
    ## 119 k_Adsorption          river freshwatersediment Continental Continental
    ## 120 k_Adsorption            sea     marinesediment Continental Continental
    ## 121 k_Adsorption            air   agriculturalsoil    Moderate    Moderate
    ## 122 k_Adsorption            air               lake    Moderate    Moderate
    ## 123 k_Adsorption            air        naturalsoil    Moderate    Moderate
    ## 124 k_Adsorption            air          othersoil    Moderate    Moderate
    ## 125 k_Adsorption            air              river    Moderate    Moderate
    ## 126 k_Adsorption            air                sea    Moderate    Moderate
    ## 127 k_Adsorption      deepocean     marinesediment    Moderate    Moderate
    ## 128 k_Adsorption           lake       lakesediment    Moderate    Moderate
    ## 129 k_Adsorption          river freshwatersediment    Moderate    Moderate
    ## 130 k_Adsorption            sea     marinesediment    Moderate    Moderate
    ## 131 k_Adsorption            air   agriculturalsoil    Regional    Regional
    ## 132 k_Adsorption            air               lake    Regional    Regional
    ## 133 k_Adsorption            air        naturalsoil    Regional    Regional
    ## 134 k_Adsorption            air          othersoil    Regional    Regional
    ## 135 k_Adsorption            air              river    Regional    Regional
    ## 136 k_Adsorption            air                sea    Regional    Regional
    ## 137 k_Adsorption      deepocean     marinesediment    Regional    Regional
    ## 138 k_Adsorption           lake       lakesediment    Regional    Regional
    ## 139 k_Adsorption          river freshwatersediment    Regional    Regional
    ## 140 k_Adsorption            sea     marinesediment    Regional    Regional
    ## 141 k_Adsorption            air   agriculturalsoil      Tropic      Tropic
    ## 142 k_Adsorption            air               lake      Tropic      Tropic
    ## 143 k_Adsorption            air        naturalsoil      Tropic      Tropic
    ## 144 k_Adsorption            air          othersoil      Tropic      Tropic
    ## 145 k_Adsorption            air              river      Tropic      Tropic
    ## 146 k_Adsorption            air                sea      Tropic      Tropic
    ## 147 k_Adsorption      deepocean     marinesediment      Tropic      Tropic
    ## 148 k_Adsorption           lake       lakesediment      Tropic      Tropic
    ## 149 k_Adsorption          river freshwatersediment      Tropic      Tropic
    ## 150 k_Adsorption            sea     marinesediment      Tropic      Tropic
    ##     fromSpecies toSpecies
    ## 101     Unbound   Unbound
    ## 102     Unbound   Unbound
    ## 103     Unbound   Unbound
    ## 104     Unbound   Unbound
    ## 105     Unbound   Unbound
    ## 106     Unbound   Unbound
    ## 107     Unbound   Unbound
    ## 108     Unbound   Unbound
    ## 109     Unbound   Unbound
    ## 110     Unbound   Unbound
    ## 111     Unbound   Unbound
    ## 112     Unbound   Unbound
    ## 113     Unbound   Unbound
    ## 114     Unbound   Unbound
    ## 115     Unbound   Unbound
    ## 116     Unbound   Unbound
    ## 117     Unbound   Unbound
    ## 118     Unbound   Unbound
    ## 119     Unbound   Unbound
    ## 120     Unbound   Unbound
    ## 121     Unbound   Unbound
    ## 122     Unbound   Unbound
    ## 123     Unbound   Unbound
    ## 124     Unbound   Unbound
    ## 125     Unbound   Unbound
    ## 126     Unbound   Unbound
    ## 127     Unbound   Unbound
    ## 128     Unbound   Unbound
    ## 129     Unbound   Unbound
    ## 130     Unbound   Unbound
    ## 131     Unbound   Unbound
    ## 132     Unbound   Unbound
    ## 133     Unbound   Unbound
    ## 134     Unbound   Unbound
    ## 135     Unbound   Unbound
    ## 136     Unbound   Unbound
    ## 137     Unbound   Unbound
    ## 138     Unbound   Unbound
    ## 139     Unbound   Unbound
    ## 140     Unbound   Unbound
    ## 141     Unbound   Unbound
    ## 142     Unbound   Unbound
    ## 143     Unbound   Unbound
    ## 144     Unbound   Unbound
    ## 145     Unbound   Unbound
    ## 146     Unbound   Unbound
    ## 147     Unbound   Unbound
    ## 148     Unbound   Unbound
    ## 149     Unbound   Unbound
    ## 150     Unbound   Unbound

``` r
testProc <- World$NewProcess("k_Adsorption")
testProc$execute()
```

    ## Warning in private$Execute(debugAt): input data ignored; not all from.FRinw in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all to.MTC_2w in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all from.MTC_2w in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all FRorig in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all to.Matrix in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all Area in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## from.SubCompartName in FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.SubCompartName in FromDataAndTo

    ##         process fromSubCompart       toSubCompart   fromScale     toScale
    ## 3  k_Adsorption            air        naturalsoil      Arctic      Arctic
    ## 6  k_Adsorption            air                sea      Arctic      Arctic
    ## 7  k_Adsorption      deepocean     marinesediment      Arctic      Arctic
    ## 10 k_Adsorption            sea     marinesediment      Arctic      Arctic
    ## 11 k_Adsorption            air   agriculturalsoil Continental Continental
    ## 12 k_Adsorption            air               lake Continental Continental
    ## 13 k_Adsorption            air        naturalsoil Continental Continental
    ## 14 k_Adsorption            air          othersoil Continental Continental
    ## 15 k_Adsorption            air              river Continental Continental
    ## 16 k_Adsorption            air                sea Continental Continental
    ## 18 k_Adsorption           lake       lakesediment Continental Continental
    ## 19 k_Adsorption          river freshwatersediment Continental Continental
    ## 20 k_Adsorption            sea     marinesediment Continental Continental
    ## 23 k_Adsorption            air        naturalsoil    Moderate    Moderate
    ## 26 k_Adsorption            air                sea    Moderate    Moderate
    ## 27 k_Adsorption      deepocean     marinesediment    Moderate    Moderate
    ## 30 k_Adsorption            sea     marinesediment    Moderate    Moderate
    ## 31 k_Adsorption            air   agriculturalsoil    Regional    Regional
    ## 32 k_Adsorption            air               lake    Regional    Regional
    ## 33 k_Adsorption            air        naturalsoil    Regional    Regional
    ## 34 k_Adsorption            air          othersoil    Regional    Regional
    ## 35 k_Adsorption            air              river    Regional    Regional
    ## 36 k_Adsorption            air                sea    Regional    Regional
    ## 38 k_Adsorption           lake       lakesediment    Regional    Regional
    ## 39 k_Adsorption          river freshwatersediment    Regional    Regional
    ## 40 k_Adsorption            sea     marinesediment    Regional    Regional
    ## 43 k_Adsorption            air        naturalsoil      Tropic      Tropic
    ## 46 k_Adsorption            air                sea      Tropic      Tropic
    ## 47 k_Adsorption      deepocean     marinesediment      Tropic      Tropic
    ## 50 k_Adsorption            sea     marinesediment      Tropic      Tropic
    ##    fromSpecies toSpecies            k
    ## 3      Unbound   Unbound 8.297054e-10
    ## 6      Unbound   Unbound 1.874516e-07
    ## 7      Unbound   Unbound 9.169372e-12
    ## 10     Unbound   Unbound 2.750812e-10
    ## 11     Unbound   Unbound 1.125842e-09
    ## 12     Unbound   Unbound 5.703494e-08
    ## 13     Unbound   Unbound 1.125842e-09
    ## 14     Unbound   Unbound 1.125842e-09
    ## 15     Unbound   Unbound 5.703494e-08
    ## 16     Unbound   Unbound 5.703494e-08
    ## 18     Unbound   Unbound 2.751764e-10
    ## 19     Unbound   Unbound 9.162326e-09
    ## 20     Unbound   Unbound 1.375406e-10
    ## 23     Unbound   Unbound 1.125842e-09
    ## 26     Unbound   Unbound 5.703494e-08
    ## 27     Unbound   Unbound 9.169372e-12
    ## 30     Unbound   Unbound 2.750812e-10
    ## 31     Unbound   Unbound 1.125842e-09
    ## 32     Unbound   Unbound 5.703494e-08
    ## 33     Unbound   Unbound 1.125842e-09
    ## 34     Unbound   Unbound 1.125842e-09
    ## 35     Unbound   Unbound 5.703494e-08
    ## 36     Unbound   Unbound 5.703494e-08
    ## 38     Unbound   Unbound 2.751764e-10
    ## 39     Unbound   Unbound 9.162326e-09
    ## 40     Unbound   Unbound 2.750812e-09
    ## 43     Unbound   Unbound 1.471762e-09
    ## 46     Unbound   Unbound 3.045282e-08
    ## 47     Unbound   Unbound 9.169372e-12
    ## 50     Unbound   Unbound 2.750812e-10

``` r
# testProc$execute(debugAt = list(to.SubCompartName = "sea",ScaleName = "Continental"))
```

## Volatilisation and desorption

Volatilisaation is implemented for the flux from soil or water to air
for molecular chemicals in k_Volatilisation. Desorption is implemented
for the flux from sediment to water for molecular chemicals in
k_Desorption.

For Volatilisation and some other processes affecting the soil, a
correction factor is calculated. The correction factor for depth
dependent soil concentration can be obtained from Hollander et
al. (2004). Here this is implemented in a function: r f_CORRsoil.

``` r
World$fetchData("MTC_2sd") 
```

    ##    SubCompart  MTC_2sd
    ## 4   deepocean 2.78e-06
    ## 6        lake 2.78e-06
    ## 11      river 2.78e-06
    ## 12        sea 2.78e-06

``` r
World$fetchData("FRorig_spw") 
```

    ##          SubCompart FRorig_spw
    ## 1  agriculturalsoil          1
    ## 9       naturalsoil          1
    ## 10        othersoil          1

``` r
World$fetchData("MTC_2w") 
```

    ##          Scale         SubCompart       MTC_2w
    ## 1       Arctic                air 0.0044535619
    ## 4       Arctic freshwatersediment 0.0000000278
    ## 6       Arctic       lakesediment 0.0000000278
    ## 7       Arctic     marinesediment 0.0000000278
    ## 12 Continental                air 0.0044535619
    ## 15 Continental freshwatersediment 0.0000000278
    ## 17 Continental       lakesediment 0.0000000278
    ## 18 Continental     marinesediment 0.0000000278
    ## 23    Moderate                air 0.0044535619
    ## 26    Moderate freshwatersediment 0.0000000278
    ## 28    Moderate       lakesediment 0.0000000278
    ## 29    Moderate     marinesediment 0.0000000278
    ## 34    Regional                air 0.0044535619
    ## 37    Regional freshwatersediment 0.0000000278
    ## 39    Regional       lakesediment 0.0000000278
    ## 40    Regional     marinesediment 0.0000000278
    ## 45      Tropic                air 0.0044535619
    ## 48      Tropic freshwatersediment 0.0000000278
    ## 50      Tropic       lakesediment 0.0000000278
    ## 51      Tropic     marinesediment 0.0000000278

``` r
World$fetchData("MTC_2a") 
```

    ##           Scale       SubCompart Species       MTC_2a
    ## 35       Arctic      naturalsoil Unbound 9.457553e-10
    ## 47       Arctic              sea Unbound 5.191248e-06
    ## 51  Continental agriculturalsoil Unbound 4.345550e-09
    ## 70  Continental             lake Unbound 5.191248e-06
    ## 82  Continental      naturalsoil Unbound 4.345550e-09
    ## 86  Continental        othersoil Unbound 4.345550e-09
    ## 90  Continental            river Unbound 5.191248e-06
    ## 94  Continental              sea Unbound 5.191248e-06
    ## 129    Moderate      naturalsoil Unbound 4.345550e-09
    ## 141    Moderate              sea Unbound 5.191248e-06
    ## 145    Regional agriculturalsoil Unbound 4.345550e-09
    ## 164    Regional             lake Unbound 5.191248e-06
    ## 176    Regional      naturalsoil Unbound 4.345550e-09
    ## 180    Regional        othersoil Unbound 4.345550e-09
    ## 184    Regional            river Unbound 5.191248e-06
    ## 188    Regional              sea Unbound 5.191248e-06
    ## 223      Tropic      naturalsoil Unbound 1.070000e-08
    ## 235      Tropic              sea Unbound 5.191248e-06

``` r
World$fetchData("MTC_2s") 
```

    ##   SubCompart      MTC_2s
    ## 2        air 0.001047758

``` r
World$fetchData("FRorig") 
```

    ##            SubCompart FRorig
    ## 1    agriculturalsoil      1
    ## 2                 air      1
    ## 3          cloudwater      1
    ## 4           deepocean      1
    ## 5  freshwatersediment      1
    ## 6                lake      1
    ## 7        lakesediment      1
    ## 8      marinesediment      1
    ## 9         naturalsoil      1
    ## 10          othersoil      1
    ## 11              river      1
    ## 12                sea      1

``` r
World$fetchData("Kacompw") 
```

    ##         Scale    Kacompw
    ## 1      Arctic 0.02652817
    ## 2 Continental 0.08985308
    ## 3    Moderate 0.08985308
    ## 4    Regional 0.08985308
    ## 5      Tropic 0.16930287

``` r
World$fetchData("Kscompw") 
```

    ##          Scale       SubCompart  Kscompw
    ## 8       Arctic      naturalsoil 23.29144
    ## 11 Continental agriculturalsoil 23.30411
    ## 19 Continental      naturalsoil 23.30411
    ## 20 Continental        othersoil 23.30411
    ## 30    Moderate      naturalsoil 23.30411
    ## 33    Regional agriculturalsoil 23.30411
    ## 41    Regional      naturalsoil 23.30411
    ## 42    Regional        othersoil 23.30411
    ## 52      Tropic      naturalsoil 23.32000

``` r
World$fetchData("Matrix") 
```

    ##            SubCompart   Matrix
    ## 1    agriculturalsoil     soil
    ## 2                 air      air
    ## 3          cloudwater    water
    ## 4           deepocean    water
    ## 5  freshwatersediment sediment
    ## 6                lake    water
    ## 7        lakesediment sediment
    ## 8      marinesediment sediment
    ## 9         naturalsoil     soil
    ## 10          othersoil     soil
    ## 11              river    water
    ## 12                sea    water

``` r
World$fetchData("VertDistance") 
```

    ##          Scale         SubCompart VertDistance
    ## 1       Arctic                air        1e+03
    ## 2       Arctic         cloudwater        1e+03
    ## 3       Arctic          deepocean        3e+03
    ## 7       Arctic     marinesediment        3e-02
    ## 8       Arctic        naturalsoil        5e-02
    ## 10      Arctic                sea        1e+02
    ## 11 Continental   agriculturalsoil        2e-01
    ## 12 Continental                air        1e+03
    ## 13 Continental         cloudwater        1e+03
    ## 15 Continental freshwatersediment        3e-02
    ## 16 Continental               lake        1e+02
    ## 17 Continental       lakesediment        3e-02
    ## 18 Continental     marinesediment        3e-02
    ## 19 Continental        naturalsoil        5e-02
    ## 20 Continental          othersoil        5e-02
    ## 21 Continental              river        3e+00
    ## 22 Continental                sea        2e+02
    ## 23    Moderate                air        1e+03
    ## 24    Moderate         cloudwater        1e+03
    ## 25    Moderate          deepocean        3e+03
    ## 29    Moderate     marinesediment        3e-02
    ## 30    Moderate        naturalsoil        5e-02
    ## 32    Moderate                sea        1e+02
    ## 33    Regional   agriculturalsoil        2e-01
    ## 34    Regional                air        1e+03
    ## 35    Regional         cloudwater        1e+03
    ## 37    Regional freshwatersediment        3e-02
    ## 38    Regional               lake        1e+02
    ## 39    Regional       lakesediment        3e-02
    ## 40    Regional     marinesediment        3e-02
    ## 41    Regional        naturalsoil        5e-02
    ## 42    Regional          othersoil        5e-02
    ## 43    Regional              river        3e+00
    ## 44    Regional                sea        1e+01
    ## 45      Tropic                air        1e+03
    ## 46      Tropic         cloudwater        1e+03
    ## 47      Tropic          deepocean        3e+03
    ## 51      Tropic     marinesediment        3e-02
    ## 52      Tropic        naturalsoil        5e-02
    ## 54      Tropic                sea        1e+02

``` r
World$fetchData("landFRAC") 
```

    ##          Scale       SubCompart landFRAC
    ## 11 Continental agriculturalsoil   0.6000
    ## 16 Continental             lake   0.0025
    ## 19 Continental      naturalsoil   0.2700
    ## 20 Continental        othersoil   0.1000
    ## 21 Continental            river   0.0275
    ## 33    Regional agriculturalsoil   0.6000
    ## 38    Regional             lake   0.0025
    ## 41    Regional      naturalsoil   0.2700
    ## 42    Regional        othersoil   0.1000
    ## 43    Regional            river   0.0275

``` r
World$FromDataAndTo("k_Volatilisation")
```

    ##     toSubCompart          process   fromSubCompart   fromScale     toScale
    ## 121          air k_Volatilisation agriculturalsoil      Arctic      Arctic
    ## 123          air k_Volatilisation             lake      Arctic      Arctic
    ## 125          air k_Volatilisation      naturalsoil      Arctic      Arctic
    ## 127          air k_Volatilisation        othersoil      Arctic      Arctic
    ## 129          air k_Volatilisation            river      Arctic      Arctic
    ## 131          air k_Volatilisation              sea      Arctic      Arctic
    ## 133          air k_Volatilisation agriculturalsoil Continental Continental
    ## 135          air k_Volatilisation             lake Continental Continental
    ## 137          air k_Volatilisation      naturalsoil Continental Continental
    ## 139          air k_Volatilisation        othersoil Continental Continental
    ## 141          air k_Volatilisation            river Continental Continental
    ## 143          air k_Volatilisation              sea Continental Continental
    ## 145          air k_Volatilisation agriculturalsoil    Moderate    Moderate
    ## 147          air k_Volatilisation             lake    Moderate    Moderate
    ## 149          air k_Volatilisation      naturalsoil    Moderate    Moderate
    ## 151          air k_Volatilisation        othersoil    Moderate    Moderate
    ## 153          air k_Volatilisation            river    Moderate    Moderate
    ## 155          air k_Volatilisation              sea    Moderate    Moderate
    ## 157          air k_Volatilisation agriculturalsoil    Regional    Regional
    ## 159          air k_Volatilisation             lake    Regional    Regional
    ## 161          air k_Volatilisation      naturalsoil    Regional    Regional
    ## 163          air k_Volatilisation        othersoil    Regional    Regional
    ## 165          air k_Volatilisation            river    Regional    Regional
    ## 167          air k_Volatilisation              sea    Regional    Regional
    ## 169          air k_Volatilisation agriculturalsoil      Tropic      Tropic
    ## 171          air k_Volatilisation             lake      Tropic      Tropic
    ## 173          air k_Volatilisation      naturalsoil      Tropic      Tropic
    ## 175          air k_Volatilisation        othersoil      Tropic      Tropic
    ## 177          air k_Volatilisation            river      Tropic      Tropic
    ## 179          air k_Volatilisation              sea      Tropic      Tropic
    ##     fromSpecies toSpecies
    ## 121     Unbound   Unbound
    ## 123     Unbound   Unbound
    ## 125     Unbound   Unbound
    ## 127     Unbound   Unbound
    ## 129     Unbound   Unbound
    ## 131     Unbound   Unbound
    ## 133     Unbound   Unbound
    ## 135     Unbound   Unbound
    ## 137     Unbound   Unbound
    ## 139     Unbound   Unbound
    ## 141     Unbound   Unbound
    ## 143     Unbound   Unbound
    ## 145     Unbound   Unbound
    ## 147     Unbound   Unbound
    ## 149     Unbound   Unbound
    ## 151     Unbound   Unbound
    ## 153     Unbound   Unbound
    ## 155     Unbound   Unbound
    ## 157     Unbound   Unbound
    ## 159     Unbound   Unbound
    ## 161     Unbound   Unbound
    ## 163     Unbound   Unbound
    ## 165     Unbound   Unbound
    ## 167     Unbound   Unbound
    ## 169     Unbound   Unbound
    ## 171     Unbound   Unbound
    ## 173     Unbound   Unbound
    ## 175     Unbound   Unbound
    ## 177     Unbound   Unbound
    ## 179     Unbound   Unbound

``` r
testProc <- World$NewProcess("k_Volatilisation")
testProc$execute()
```

    ## Warning in private$Execute(debugAt): input data ignored; not all to.MTC_2w in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all FRorig in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all FRinw in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all SpeciesName in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all Matrix in
    ## FromDataAndTo

    ##    toSubCompart          process   fromSubCompart   fromScale     toScale
    ## 3           air k_Volatilisation      naturalsoil      Arctic      Arctic
    ## 6           air k_Volatilisation              sea      Arctic      Arctic
    ## 7           air k_Volatilisation agriculturalsoil Continental Continental
    ## 8           air k_Volatilisation             lake Continental Continental
    ## 9           air k_Volatilisation      naturalsoil Continental Continental
    ## 10          air k_Volatilisation        othersoil Continental Continental
    ## 11          air k_Volatilisation            river Continental Continental
    ## 12          air k_Volatilisation              sea Continental Continental
    ## 15          air k_Volatilisation      naturalsoil    Moderate    Moderate
    ## 18          air k_Volatilisation              sea    Moderate    Moderate
    ## 19          air k_Volatilisation agriculturalsoil    Regional    Regional
    ## 20          air k_Volatilisation             lake    Regional    Regional
    ## 21          air k_Volatilisation      naturalsoil    Regional    Regional
    ## 22          air k_Volatilisation        othersoil    Regional    Regional
    ## 23          air k_Volatilisation            river    Regional    Regional
    ## 24          air k_Volatilisation              sea    Regional    Regional
    ## 27          air k_Volatilisation      naturalsoil      Tropic      Tropic
    ## 30          air k_Volatilisation              sea      Tropic      Tropic
    ##    fromSpecies toSpecies            k
    ## 3      Unbound   Unbound 2.401728e-08
    ## 6      Unbound   Unbound 4.969741e-08
    ## 7      Unbound   Unbound 5.020305e-08
    ## 8      Unbound   Unbound 5.123441e-08
    ## 9      Unbound   Unbound 1.103232e-07
    ## 10     Unbound   Unbound 1.103232e-07
    ## 11     Unbound   Unbound 1.705911e-06
    ## 12     Unbound   Unbound 2.560834e-08
    ## 15     Unbound   Unbound 1.103232e-07
    ## 18     Unbound   Unbound 5.121668e-08
    ## 19     Unbound   Unbound 5.020305e-08
    ## 20     Unbound   Unbound 5.123441e-08
    ## 21     Unbound   Unbound 1.103232e-07
    ## 22     Unbound   Unbound 1.103232e-07
    ## 23     Unbound   Unbound 1.705911e-06
    ## 24     Unbound   Unbound 5.121668e-07
    ## 27     Unbound   Unbound 2.715579e-07
    ## 30     Unbound   Unbound 5.152635e-08

``` r
World$NewCalcVariable("Ksdcompw")
World$CalcVar("Ksdcompw")
```

    ##         Scale         SubCompart old_Ksdcompw Ksdcompw
    ## 1      Arctic     marinesediment     20.03845 20.03845
    ## 2 Continental freshwatersediment     20.03845 20.03845
    ## 3 Continental       lakesediment     20.03845 20.03845
    ## 4 Continental     marinesediment     20.03845 20.03845
    ## 5    Moderate     marinesediment     20.03845 20.03845
    ## 6    Regional freshwatersediment     20.03845 20.03845
    ## 7    Regional       lakesediment     20.03845 20.03845
    ## 8    Regional     marinesediment     20.03845 20.03845
    ## 9      Tropic     marinesediment     20.03845 20.03845

``` r
World$fetchData("Ksdcompw") 
```

    ##          Scale         SubCompart Ksdcompw
    ## 7       Arctic     marinesediment 20.03845
    ## 15 Continental freshwatersediment 20.03845
    ## 17 Continental       lakesediment 20.03845
    ## 18 Continental     marinesediment 20.03845
    ## 29    Moderate     marinesediment 20.03845
    ## 37    Regional freshwatersediment 20.03845
    ## 39    Regional       lakesediment 20.03845
    ## 40    Regional     marinesediment 20.03845
    ## 51      Tropic     marinesediment 20.03845

``` r
World$fetchData("MTC_2w") 
```

    ##          Scale         SubCompart       MTC_2w
    ## 1       Arctic                air 0.0044535619
    ## 4       Arctic freshwatersediment 0.0000000278
    ## 6       Arctic       lakesediment 0.0000000278
    ## 7       Arctic     marinesediment 0.0000000278
    ## 12 Continental                air 0.0044535619
    ## 15 Continental freshwatersediment 0.0000000278
    ## 17 Continental       lakesediment 0.0000000278
    ## 18 Continental     marinesediment 0.0000000278
    ## 23    Moderate                air 0.0044535619
    ## 26    Moderate freshwatersediment 0.0000000278
    ## 28    Moderate       lakesediment 0.0000000278
    ## 29    Moderate     marinesediment 0.0000000278
    ## 34    Regional                air 0.0044535619
    ## 37    Regional freshwatersediment 0.0000000278
    ## 39    Regional       lakesediment 0.0000000278
    ## 40    Regional     marinesediment 0.0000000278
    ## 45      Tropic                air 0.0044535619
    ## 48      Tropic freshwatersediment 0.0000000278
    ## 50      Tropic       lakesediment 0.0000000278
    ## 51      Tropic     marinesediment 0.0000000278

``` r
World$fetchData("MTC_2sd") 
```

    ##    SubCompart  MTC_2sd
    ## 4   deepocean 2.78e-06
    ## 6        lake 2.78e-06
    ## 11      river 2.78e-06
    ## 12        sea 2.78e-06

``` r
World$fetchData("VertDistance") 
```

    ##          Scale         SubCompart VertDistance
    ## 1       Arctic                air        1e+03
    ## 2       Arctic         cloudwater        1e+03
    ## 3       Arctic          deepocean        3e+03
    ## 7       Arctic     marinesediment        3e-02
    ## 8       Arctic        naturalsoil        5e-02
    ## 10      Arctic                sea        1e+02
    ## 11 Continental   agriculturalsoil        2e-01
    ## 12 Continental                air        1e+03
    ## 13 Continental         cloudwater        1e+03
    ## 15 Continental freshwatersediment        3e-02
    ## 16 Continental               lake        1e+02
    ## 17 Continental       lakesediment        3e-02
    ## 18 Continental     marinesediment        3e-02
    ## 19 Continental        naturalsoil        5e-02
    ## 20 Continental          othersoil        5e-02
    ## 21 Continental              river        3e+00
    ## 22 Continental                sea        2e+02
    ## 23    Moderate                air        1e+03
    ## 24    Moderate         cloudwater        1e+03
    ## 25    Moderate          deepocean        3e+03
    ## 29    Moderate     marinesediment        3e-02
    ## 30    Moderate        naturalsoil        5e-02
    ## 32    Moderate                sea        1e+02
    ## 33    Regional   agriculturalsoil        2e-01
    ## 34    Regional                air        1e+03
    ## 35    Regional         cloudwater        1e+03
    ## 37    Regional freshwatersediment        3e-02
    ## 38    Regional               lake        1e+02
    ## 39    Regional       lakesediment        3e-02
    ## 40    Regional     marinesediment        3e-02
    ## 41    Regional        naturalsoil        5e-02
    ## 42    Regional          othersoil        5e-02
    ## 43    Regional              river        3e+00
    ## 44    Regional                sea        1e+01
    ## 45      Tropic                air        1e+03
    ## 46      Tropic         cloudwater        1e+03
    ## 47      Tropic          deepocean        3e+03
    ## 51      Tropic     marinesediment        3e-02
    ## 52      Tropic        naturalsoil        5e-02
    ## 54      Tropic                sea        1e+02

``` r
World$FromDataAndTo("k_Desorption")
```

    ##          process     fromSubCompart toSubCompart   fromScale     toScale
    ## 41  k_Desorption freshwatersediment        river      Arctic      Arctic
    ## 42  k_Desorption       lakesediment         lake      Arctic      Arctic
    ## 43  k_Desorption     marinesediment    deepocean      Arctic      Arctic
    ## 44  k_Desorption     marinesediment          sea      Arctic      Arctic
    ## 45  k_Desorption freshwatersediment        river Continental Continental
    ## 46  k_Desorption       lakesediment         lake Continental Continental
    ## 47  k_Desorption     marinesediment    deepocean Continental Continental
    ## 48  k_Desorption     marinesediment          sea Continental Continental
    ## 49  k_Desorption freshwatersediment        river    Moderate    Moderate
    ## 50  k_Desorption       lakesediment         lake    Moderate    Moderate
    ## 51  k_Desorption     marinesediment    deepocean    Moderate    Moderate
    ## 52  k_Desorption     marinesediment          sea    Moderate    Moderate
    ## 53  k_Desorption freshwatersediment        river    Regional    Regional
    ## 54  k_Desorption       lakesediment         lake    Regional    Regional
    ## 55  k_Desorption     marinesediment    deepocean    Regional    Regional
    ## 56  k_Desorption     marinesediment          sea    Regional    Regional
    ## 57  k_Desorption freshwatersediment        river      Tropic      Tropic
    ## 58  k_Desorption       lakesediment         lake      Tropic      Tropic
    ## 59  k_Desorption     marinesediment    deepocean      Tropic      Tropic
    ## 60  k_Desorption     marinesediment          sea      Tropic      Tropic
    ## 61  k_Desorption freshwatersediment        river      Arctic      Arctic
    ## 62  k_Desorption       lakesediment         lake      Arctic      Arctic
    ## 63  k_Desorption     marinesediment    deepocean      Arctic      Arctic
    ## 64  k_Desorption     marinesediment          sea      Arctic      Arctic
    ## 65  k_Desorption freshwatersediment        river Continental Continental
    ## 66  k_Desorption       lakesediment         lake Continental Continental
    ## 67  k_Desorption     marinesediment    deepocean Continental Continental
    ## 68  k_Desorption     marinesediment          sea Continental Continental
    ## 69  k_Desorption freshwatersediment        river    Moderate    Moderate
    ## 70  k_Desorption       lakesediment         lake    Moderate    Moderate
    ## 71  k_Desorption     marinesediment    deepocean    Moderate    Moderate
    ## 72  k_Desorption     marinesediment          sea    Moderate    Moderate
    ## 73  k_Desorption freshwatersediment        river    Regional    Regional
    ## 74  k_Desorption       lakesediment         lake    Regional    Regional
    ## 75  k_Desorption     marinesediment    deepocean    Regional    Regional
    ## 76  k_Desorption     marinesediment          sea    Regional    Regional
    ## 77  k_Desorption freshwatersediment        river      Tropic      Tropic
    ## 78  k_Desorption       lakesediment         lake      Tropic      Tropic
    ## 79  k_Desorption     marinesediment    deepocean      Tropic      Tropic
    ## 80  k_Desorption     marinesediment          sea      Tropic      Tropic
    ## 81  k_Desorption freshwatersediment        river      Arctic      Arctic
    ## 82  k_Desorption       lakesediment         lake      Arctic      Arctic
    ## 83  k_Desorption     marinesediment    deepocean      Arctic      Arctic
    ## 84  k_Desorption     marinesediment          sea      Arctic      Arctic
    ## 85  k_Desorption freshwatersediment        river Continental Continental
    ## 86  k_Desorption       lakesediment         lake Continental Continental
    ## 87  k_Desorption     marinesediment    deepocean Continental Continental
    ## 88  k_Desorption     marinesediment          sea Continental Continental
    ## 89  k_Desorption freshwatersediment        river    Moderate    Moderate
    ## 90  k_Desorption       lakesediment         lake    Moderate    Moderate
    ## 91  k_Desorption     marinesediment    deepocean    Moderate    Moderate
    ## 92  k_Desorption     marinesediment          sea    Moderate    Moderate
    ## 93  k_Desorption freshwatersediment        river    Regional    Regional
    ## 94  k_Desorption       lakesediment         lake    Regional    Regional
    ## 95  k_Desorption     marinesediment    deepocean    Regional    Regional
    ## 96  k_Desorption     marinesediment          sea    Regional    Regional
    ## 97  k_Desorption freshwatersediment        river      Tropic      Tropic
    ## 98  k_Desorption       lakesediment         lake      Tropic      Tropic
    ## 99  k_Desorption     marinesediment    deepocean      Tropic      Tropic
    ## 100 k_Desorption     marinesediment          sea      Tropic      Tropic
    ## 101 k_Desorption freshwatersediment        river      Arctic      Arctic
    ## 102 k_Desorption       lakesediment         lake      Arctic      Arctic
    ## 103 k_Desorption     marinesediment    deepocean      Arctic      Arctic
    ## 104 k_Desorption     marinesediment          sea      Arctic      Arctic
    ## 105 k_Desorption freshwatersediment        river Continental Continental
    ## 106 k_Desorption       lakesediment         lake Continental Continental
    ## 107 k_Desorption     marinesediment    deepocean Continental Continental
    ## 108 k_Desorption     marinesediment          sea Continental Continental
    ## 109 k_Desorption freshwatersediment        river    Moderate    Moderate
    ## 110 k_Desorption       lakesediment         lake    Moderate    Moderate
    ## 111 k_Desorption     marinesediment    deepocean    Moderate    Moderate
    ## 112 k_Desorption     marinesediment          sea    Moderate    Moderate
    ## 113 k_Desorption freshwatersediment        river    Regional    Regional
    ## 114 k_Desorption       lakesediment         lake    Regional    Regional
    ## 115 k_Desorption     marinesediment    deepocean    Regional    Regional
    ## 116 k_Desorption     marinesediment          sea    Regional    Regional
    ## 117 k_Desorption freshwatersediment        river      Tropic      Tropic
    ## 118 k_Desorption       lakesediment         lake      Tropic      Tropic
    ## 119 k_Desorption     marinesediment    deepocean      Tropic      Tropic
    ## 120 k_Desorption     marinesediment          sea      Tropic      Tropic
    ##     fromSpecies toSpecies
    ## 41        Large     Large
    ## 42        Large     Large
    ## 43        Large     Large
    ## 44        Large     Large
    ## 45        Large     Large
    ## 46        Large     Large
    ## 47        Large     Large
    ## 48        Large     Large
    ## 49        Large     Large
    ## 50        Large     Large
    ## 51        Large     Large
    ## 52        Large     Large
    ## 53        Large     Large
    ## 54        Large     Large
    ## 55        Large     Large
    ## 56        Large     Large
    ## 57        Large     Large
    ## 58        Large     Large
    ## 59        Large     Large
    ## 60        Large     Large
    ## 61        Small     Small
    ## 62        Small     Small
    ## 63        Small     Small
    ## 64        Small     Small
    ## 65        Small     Small
    ## 66        Small     Small
    ## 67        Small     Small
    ## 68        Small     Small
    ## 69        Small     Small
    ## 70        Small     Small
    ## 71        Small     Small
    ## 72        Small     Small
    ## 73        Small     Small
    ## 74        Small     Small
    ## 75        Small     Small
    ## 76        Small     Small
    ## 77        Small     Small
    ## 78        Small     Small
    ## 79        Small     Small
    ## 80        Small     Small
    ## 81        Solid     Solid
    ## 82        Solid     Solid
    ## 83        Solid     Solid
    ## 84        Solid     Solid
    ## 85        Solid     Solid
    ## 86        Solid     Solid
    ## 87        Solid     Solid
    ## 88        Solid     Solid
    ## 89        Solid     Solid
    ## 90        Solid     Solid
    ## 91        Solid     Solid
    ## 92        Solid     Solid
    ## 93        Solid     Solid
    ## 94        Solid     Solid
    ## 95        Solid     Solid
    ## 96        Solid     Solid
    ## 97        Solid     Solid
    ## 98        Solid     Solid
    ## 99        Solid     Solid
    ## 100       Solid     Solid
    ## 101     Unbound   Unbound
    ## 102     Unbound   Unbound
    ## 103     Unbound   Unbound
    ## 104     Unbound   Unbound
    ## 105     Unbound   Unbound
    ## 106     Unbound   Unbound
    ## 107     Unbound   Unbound
    ## 108     Unbound   Unbound
    ## 109     Unbound   Unbound
    ## 110     Unbound   Unbound
    ## 111     Unbound   Unbound
    ## 112     Unbound   Unbound
    ## 113     Unbound   Unbound
    ## 114     Unbound   Unbound
    ## 115     Unbound   Unbound
    ## 116     Unbound   Unbound
    ## 117     Unbound   Unbound
    ## 118     Unbound   Unbound
    ## 119     Unbound   Unbound
    ## 120     Unbound   Unbound

``` r
testProc <- World$NewProcess("k_Desorption")
testProc$execute()
```

    ## Warning in private$Execute(debugAt): input data ignored; not all MTC_2w in
    ## FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all VertDistance
    ## in FromDataAndTo

    ## Warning in private$Execute(debugAt): input data ignored; not all
    ## to.SubCompartName in FromDataAndTo

    ##         process     fromSubCompart toSubCompart   fromScale     toScale
    ## 63 k_Desorption     marinesediment    deepocean      Arctic      Arctic
    ## 64 k_Desorption     marinesediment          sea      Arctic      Arctic
    ## 65 k_Desorption freshwatersediment        river Continental Continental
    ## 66 k_Desorption       lakesediment         lake Continental Continental
    ## 67 k_Desorption     marinesediment    deepocean Continental Continental
    ## 68 k_Desorption     marinesediment          sea Continental Continental
    ## 71 k_Desorption     marinesediment    deepocean    Moderate    Moderate
    ## 72 k_Desorption     marinesediment          sea    Moderate    Moderate
    ## 73 k_Desorption freshwatersediment        river    Regional    Regional
    ## 74 k_Desorption       lakesediment         lake    Regional    Regional
    ## 75 k_Desorption     marinesediment    deepocean    Regional    Regional
    ## 76 k_Desorption     marinesediment          sea    Regional    Regional
    ## 79 k_Desorption     marinesediment    deepocean      Tropic      Tropic
    ## 80 k_Desorption     marinesediment          sea      Tropic      Tropic
    ##    fromSpecies toSpecies            k
    ## 63     Unbound   Unbound 4.578657e-08
    ## 64     Unbound   Unbound 4.578657e-08
    ## 65     Unbound   Unbound 4.578657e-08
    ## 66     Unbound   Unbound 4.578657e-08
    ## 67     Unbound   Unbound 4.578657e-08
    ## 68     Unbound   Unbound 4.578657e-08
    ## 71     Unbound   Unbound 4.578657e-08
    ## 72     Unbound   Unbound 4.578657e-08
    ## 73     Unbound   Unbound 4.578657e-08
    ## 74     Unbound   Unbound 4.578657e-08
    ## 75     Unbound   Unbound 4.578657e-08
    ## 76     Unbound   Unbound 4.578657e-08
    ## 79     Unbound   Unbound 4.578657e-08
    ## 80     Unbound   Unbound 4.578657e-08

``` r
 # testProc$execute(debugAt = list(to.SubCompartName = "sea",ScaleName = "Continental"))
```

## Other relevant intermedia transfer processes

In addition to the processes governed by diffusion, the following
intermedia processes are implemented: - k_Resuspension - k_Erosion -
k_Runoff

## testing

Below some tests for overall documentation of var names in units.csv.
Still needs some work:

``` r
# In the end we need to order csv's and upate unit.csv

# source("baseScripts/ReorderCSV.R")



AllVarnames <- World$fetchData() 
#There should be 1 place (table) for a variable; are there multiple?
table(AllVarnames)[table(AllVarnames)!=1]
```

    ## AllVarnames
    ##              a              b QSAR.ChemClass           Unit        VarName 
    ##              2              2              2              2              2 
    ##              X 
    ##              3

``` r
#Columns of the QSAR table are an exception, can be ignored here...
#Also ignore variable-names starting with k_. The are the exceptions to the described process from-and-to data
#Also ignore variable starting with Abbr, these are for old (excel) variable naming convention
#Also ignore "Waarde", "Dimension", "forWhich" and "unit", other technicalities...
AllVarnames <- AllVarnames[!startsWith(AllVarnames, prefix = "k_") & 
                             !startsWith(AllVarnames, prefix = "Abbr") &
                             !startsWith(AllVarnames, prefix = "outdated")]
AllVarnames <- AllVarnames[!AllVarnames %in% c("VarName", "Waarde", "Dimension", "forWhich", "Unit", "table")] 
#compare to the units table; which has been read into the World by 
UnitTable <- NewstateModule$SB4N.data[["Units"]]

unique(AllVarnames)[!AllVarnames %in% UnitTable$VarName]
```

    ##  [1] "a"                 "AEROresist"        "AreaLand"         
    ##  [4] "AreaSea"           "b"                 "BACTcomp"         
    ##  [7] "BACTtest"          "beta.a"            "Biodeg"           
    ## [10] "C.OHrad.n"         "Corg"              "D"                
    ## [13] "DefaultNETsedrate" "Description"       "Df"               
    ## [16] "dischargeFRAC"     "FRACa"             "FRACcldw"         
    ## [19] "FRingas"           "FRins"             "FRinw"            
    ## [22] "fromScale"         "fromSubCompart"    "FRorig"           
    ## [25] "FRorig_spw"        "gamma.surf"        "H0sol"            
    ## [28] "Kaerw"             "Kaw25"             "kdeg"             
    ## [31] "Kow_default"       "Kp.sed"            "Ksdcompw"         
    ## [34] "Ksw"               "Ksw.alt"           "kwsd.sed"         
    ## [37] "LakeFracRiver"     "landFRAC"          "MaxPvap"          
    ## [40] "MOLMASSAIR"        "MTC_2sd"           "MTC_2w"           
    ## [43] "MW"                "NaturalPart"       "NotInGlobal"      
    ## [46] "NumConcCP"         "RadCOL"            "RadCP"            
    ## [49] "RadNuc"            "Shear"             "Sol25"            
    ## [52] "subFRACs"          "subFRACw"          "T25"              
    ## [55] "toScale"           "TotalArea"         "twet"             
    ## [58] "Udarcy"            NA                  NA                 
    ## [61] NA                  NA

``` r
UnitTable$VarName[!UnitTable$VarName %in% unique(AllVarnames)]
```

    ##  [1] "alpha"      "EF"         "kdeg.air"   "kdeg.sed"   "kdeg.soil" 
    ##  [6] "kdeg.water" "kdis"       "NaturalRad" "NaturalRho" "RhoAcc"

``` r
#The trail of variables is stored when reading it originally; in 
NewUnits <- left_join(UnitTable, NewstateModule$varOrigine)
```

    ## Joining with `by = join_by(VarName, table)`

``` r
AlfOrder <- order(NewUnits$VarName)
# write.csv(NewUnits[AlfOrder,], file = "data/Units.csv")
# source("baseScripts/ReorderCSV.R") not needed because already alphabetic
```
